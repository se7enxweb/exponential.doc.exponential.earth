
<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from doc.ez.no/doc_hidden/Exponential/Upgrading/Direct-upgrading/Direct-upgrading-to-4.7-from-4.1-4.2-4.3-4.4-and-4.5/Direct-upgrading-from-4.2-to-4.7 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 12:50:17 GMT -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" type="text/css" href="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/stylesheets/core.css" /><link rel="stylesheet" type="text/css" href="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/stylesheets/header-footer.css" /><link rel="stylesheet" type="text/css" href="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/stylesheets/header-footer-lookfeel.css" /><link rel="stylesheet" type="text/css" href="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/stylesheets/pagelayout.css" /><link rel="stylesheet" type="text/css" href="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/stylesheets/buttons.css" /><link rel="stylesheet" type="text/css" href="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/stylesheets/960.css" /><link rel="stylesheet" type="text/css" href="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/stylesheets/superfish.css" /><script type="text/javascript" src="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/javascript/jquery-1.6.3.min.js" charset="utf-8"></script><script type="text/javascript" src="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/javascript/superfish.js" charset="utf-8"></script><script type="text/javascript" src="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/javascript/jquery.popmenu.min.js" charset="utf-8"></script>
<style type="text/css">
    @import url(../../../../../extension/ezdoc/design/doc/stylesheets/core.css);
    @import url(../../../../../extension/ezdoc/design/doc/stylesheets/classes.css);
    @import url(../../../../../extension/ezdoc/design/doc/stylesheets/doc.css);
    @import url(../../../../../extension/ezdoc/design/doc/stylesheets/print.css) print;</style>

<link type="text/css" rel="stylesheet" href="../../../../../extension/ezdoc/design/doc/stylesheets/print.css" media="print" />

<!-- IE conditional comments; for bug fixes for different IE versions -->
<!--[if IE 5]>     <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie5.css);    </style>     <![endif]-->
<!--[if lte IE 6]> <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6lte.css); </style>     <![endif]-->
<!--[if lte IE 6]> <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6lte-doc.css); </style> <![endif]-->
<!--[if IE 6]>     <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6.css);    </style>     <![endif]-->

<!-- Load special stylesheet (if necessary) for newer Netscape decendants, Mozilla and Firefox, using the Gecko renderer -->
<script type="text/javascript"><!-- if ((navigator.userAgent.indexOf("Gecko") != -1)&&(navigator.userAgent.indexOf("KHTML") == -1)) document.write("<style type=\"text/css\">@import url(/extension/ezdoc/design/doc/stylesheets/gecko.css);</style>"); --></script>

<script type="text/javascript" src="../../../../../extension/ezdoc/design/doc/javascripts/mainmenu-hover.js"></script>
<script type="text/javascript" src="../../../../../extension/ezdoc/design/doc/javascripts/dropdownmenu.js"></script>
<script type="text/javascript" src="../../../../../extension/ezdoc/design/doc/javascripts/ezno-searchbox.js"></script>
                                              
    <title>Direct upgrading from 4.2 to 4.7 / Direct upgrading to 4.7 from 4.1, 4.2, 4.3, 4.4 and 4.5 / Direct upgrading / Upgrading / Exponential / Documentation - Doc</title>

    
    
    
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

            <meta http-equiv="Content-language" content="en-GB" />

    
                <meta name="author" content="eZ systems" />
                    <meta name="copyright" content="eZ systems" />
                    <meta name="description" content="Exponential Documentation" />
                    <meta name="keywords" content="Exponential, documentation, manual, reference, eZ systems" />
        
    <meta name="generator" content="Exponential" />
    <link rel="Home" href="../../../../../doc_hidden.html" title="Doc front page" />
<link rel="Search" href="../../../../content/advancedsearch.html" title="Search Doc" />
<link rel="Shortcut icon" href="../../../../../extension/ezdoc/design/doc/images/favicon.ico" type="image/x-icon" />

</head>
<body onload="initDocSearch();menuInit();">

<!-- Complete page area: START -->
<div id="page">


    <div class="topmenu-anchor"></div>
    <div id="topmenu-bg">
	    <div id="logo" class="container_12">

    <div class="grid_3">
        <a href="https://exponential.doc.exponential.earth/Exponential/" title="Exponential Platform, CXM &amp; CMS">
            <img src="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/images/exponential.png"
                 alt="" height="45px"/>
        </a>
    </div>

    <div class="grid_9">
                <div class="topmenu-design">
	<!-- Top menu content: START -->
	<div id="topmenu-firstlevel-position">
	<ul id="topmenu-firstlevel" class="sf-menu sf-js-enabled sf-shadow">
		
		
		        </ul>
    </div>
        <!-- Top menu content: END -->
</div>        </div>
</div>    </div>


<div id="page-content-position"><div id="page-content-position-inner"><div id="page-content">

<!-- Path area: START -->
<div id="path">

<div id="page-width4">
<h2 class="hide">Path</h2>

<!-- Path content: START -->
<p> <a href="https://exponential.doc.exponential.earth/">7x</a> /
                        <a href="../../../../../doc_hidden.html">documentation</a>
        
                        /
                            <a href="../../../../Exponential.html">exponential</a>
        
                        /
                            <a href="../../../Upgrading.html">upgrading</a>
        
                        /
                            <a href="../../Direct-upgrading.html">direct upgrading</a>
        
                        /
                            <a href="../Direct-upgrading-to-4.7-from-4.1-4.2-4.3-4.4-and-4.html">direct upgrading to 4.7 fro...</a>
        
                        /
                            direct upgrading from 4.2 t...
        
            </p>
<!-- Path content: END -->

</div>

</div>
<!-- Path area: END -->

<hr class="hide" />

<!-- Main area: START -->
                                    <div id="ezp5disclaimer">
                <p><strong style="color: red">Caution:</strong> This documentation is for <strong>Exponential</strong>, from version 3.x to 6.x.<br/>
                For 5.x documentation covering <em>Platform</em> see <a href="../../../../../display/MAIN/eZ%2bDocumentation%2bCenter.html">eZ Documentation Center</a>, for difference between <em>legacy</em> and <em>Platform</em> see <a href="../../../../../pages/viewpage0139.html?pageId=11403666">5.x Architecture overview</a>.</p>
            </div>
            
<div id="page-width5">
<div id="main" class="float-break">


<div class="template-design area-docmenu-normal">
<div class="template-module">
<div class="template-object">
<div id="contentmenu">
                        <div class="attribute-heading"><h2 class="bullet"><a href="../../Direct-upgrading.html">Table of contents</a></h2></div>
<div class="boxcontent">

<map id="contentstructure">

    

    
</map>

</div>            
</div>
</div>
</div>
</div>
<div class="area-docmain-normal">
<div class="template-design">
<div class="template-module content-view-full">
<div class="template-object">

<div class="attribute-heading">
<h1>Direct upgrading from 4.2 to 4.7</h1>
</div>

<p>This section describes how to upgrade your existing Exponential 4.2 installation&nbsp;directly&nbsp;to version 4.7. Make sure that you have a working backup of the site before you do the actual upgrade, and make sure the installation you are performing&nbsp;the upgrade on is offline.</p><a name="eztoc126933_0_1" id="eztoc126933_0_1"></a><h3>Important upgrade notes:</h3><p>The procedure for upgrading directly from version 4.2 to 4.7 consists of the following steps:</p>
<ul>
<li><div>Upgrade the distribution files to 4.7</div></li><li><div>Upgrade custom extensions
<ul>
<li><div>4.2 to 4.3</div></li><li><div>4.3.to 4.4</div></li><li><div>4.4 to 4.5</div></li><li><div>4.5 to 4.6</div></li><li><div>4.6 to 4.7</div></li>
</ul>
</div></li><li><div>Upgrade the database to 4.7 
<ul>
<li><div>4.2 to 4.3</div></li><li><div>4.3 to 4.4</div></li><li><div>4.4 to 4.5</div></li><li><div>4.5 to 4.6</div></li><li><div>4.6 to 4.7</div></li>
</ul>
</div></li><li><div>Regenerate the autoload array for extensions</div></li><li><div>Run the system upgrade scripts for 4.7 
<ul>
<li><div>4.2 to 4.3</div></li><li><div>4.3 to 4.4</div></li><li><div>4.4 to 4.5</div></li><li><div>4.5 to 4.6</div></li><li><div>4.6 to 4.7</div></li>
</ul>
</div></li><li><div>Additional upgrade step</div></li><li><div>Enable ezjscore</div></li><li><div>Enable admin2-design for back-end</div></li><li><div>Clear the caches</div></li><li><div>Upgrade extensions</div></li>
</ul>
<a name="eztoc126933_1" id="eztoc126933_1"></a><h2>Check for requirements</h2><a name="eztoc126933_1_2" id="eztoc126933_1_2"></a><h3>The eZ Components and PHP requirements</h3><p>The minimum version required of eZ Components with Exponential 4.7 is &quot;ezcomponents-ezp47&quot;, containing a fix to the package. This version is bundled in Exponential 4.7 Enterprise. Exponential 4.7 is compatible with PHP version 5.3 and above, but certified on RHEL 6 and Debian 6, PHP 5.3.x distros. See <a href="../../../Technical-manual/4.7/Installation/Requirements.html" target="_self">Exponential Requirements</a> for more info.</p><a name="eztoc126933_2" id="eztoc126933_2"></a><h2>Step 1: Upgrade the distribution files</h2><p>The easiest way to upgrade the distribution files is to unpack Exponential 4.7 to a separate directory and then copy the directories that contain site-specific files from the existing installation. Make sure that you copy the following directories:</p>
<ul>
<li><div>design/example</div></li><li><div>design/example_admin</div></li><li><div>var</div></li><li><div>settings/siteaccess</div></li><li><div>settings/override</div></li><li><div>
index_cluster.php if running cluster mode<br /><b>&nbsp;</b></div></li>
</ul>
<p><b>Note:&nbsp;if your cluster index file is named this way, copy it under a new, temporary &nbsp;name. Migration of this file is explained later in the procedure.</b></p><p>Replace &quot;example&quot; and &quot;example_admin&quot; with the actual names of your site accesses.</p><p><b>Important note: </b>Because the new directory has replaced the original directory, the directory permissions need to be fixed. <i>You have the choice between Shell commands or Alternative shell commands.</i></p><p>Use the following commands to do this:</p>
<ul>
<li><div><b>Shell commands</b></div></li>
</ul>
<p>These shell commands will give proper permission to the web server:</p><pre class="wordwrap"><span class="line">cd &lt;/path/to/your/eZ/Publish/directory&gt;</span>
<span class="line">chmod -R a+rwx design extension settings var</span>
</pre>
<ul>
<li><div><b>Alternative shell commands</b></div></li>
</ul>
<p>&nbsp;These commands will setup the permission more correctly, but require knowledge about the running web server (change 'nouser' to http server user).</p><pre class="wordwrap"><span class="line">cd &lt;/path/to/your/eZ/Publish/directory&gt;</span>
<span class="line">chmod -R og+rwx design extension settings var</span>
<span class="line">chown -R nouser:nouser design extension settings var</span>
</pre><a name="eztoc126933_3" id="eztoc126933_3"></a><h2>Step 2: Custom extensions</h2><p>If you are using custom extensions, the sub-directories inside the &quot;extension&quot; directory will also have to be copied. However, make sure that you do not overwrite any extensions that are included in Exponential, which currently are eZ Flow (2.x), eZ Online Editor (5.x), eZ OpenOffice Document format (2.x), eZ JSCore (1.x), eZ Image Editor (1.x), eZ Comments (1.x), eZ Multiupload (1.x), eZ MB Password Expiry (1.x), eZ Network (1.x), eZ REST API Provider (1.x), eZ Script Monitor (1.x), eZ SI, eZ Find (2.x). Note that upgrading the distribution files will overwrite the autoload arrays for extensions. You will need to regenerate the autoload arrays for active extensions later.</p><p>See the dedicated upgrade instructions for eZ Flow and Website Interface below.</p><p>The updated versions of eZ Flow and Website Interface will also install the following extensions:</p>
<ul>
<li><div>eZ Website Toolbar</div></li><li><div>eZ Star Rating</div></li><li><div>eZ Google Maps Location</div></li>
</ul>
<p><b>Note:</b> For eZ Online Editor 5.x and eZ JS Core you will need to replace the following rewrite rules when using Virtual Hosts:</p><pre class="wordwrap"><span class="line">RewriteRule ^/var/cache/texttoimage/.* - [L]</span>
<span class="line">RewriteRule ^/var/[^/]+/cache/(texttoimage|public)/.* - [L]</span>
</pre><p>with:</p><pre class="wordwrap"><span class="line">RewriteRule ^/var/([^/]+/)?cache/(texttoimage|public)/.* - [L]</span>
</pre><p>For more detailed instructions, see the dedicated <a href="../../../../Extensions/Exponential-extensions/Online-Editor.html" target="_self">eZ OE</a> and <a href="../../../../Extensions/Exponential-extensions/eZ-JS-Core.html" target="_self">eZ JS Core</a> doc pages.</p><a name="eztoc126933_4" id="eztoc126933_4"></a><h2>Step 3: Upgrade the database</h2><p>The update script for the database is located in the following locations. Skip the ones that don't apply to the version your upgrading from:</p><pre class="wordwrap copytoclipboard"><span class="line">&lt;Exponential root&gt;/update/database/&lt;mysql|postgresql&gt;/4.3/dbupdate-4.2.0-to-4.3.0.sql</span>
<span class="line">&lt;Exponential root&gt;/update/database/&lt;mysql|postgresql&gt;/4.4/dbupdate-4.3.0-to-4.4.0.sql</span>
<span class="line">&lt;Exponential root&gt;/update/database/&lt;mysql|postgresql&gt;/4.5/dbupdate-4.4.0-to-4.5.0.sql</span>
<span class="line">&lt;Exponential root&gt;/update/database/&lt;mysql|postgresql&gt;/4.6/dbupdate-4.4.0-to-4.5.0.sql</span>
<span class="line">&lt;Exponential root&gt;/update/database/&lt;mysql|postgresql&gt;/4.6/dbupdate-4.6.0-to-4.7.0.sql</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '&lt;Exponential root&gt;/update/database/&lt;mysql|postgresql&gt;/4.3/dbupdate-4.2.0-to-4.3.0.sql\r\n&lt;Exponential root&gt;/update/database/&lt;mysql|postgresql&gt;/4.4/dbupdate-4.3.0-to-4.4.0.sql\r\n&lt;Exponential root&gt;/update/database/&lt;mysql|postgresql&gt;/4.5/dbupdate-4.4.0-to-4.5.0.sql\r\n&lt;Exponential root&gt;/update/database/&lt;mysql|postgresql&gt;/4.6/dbupdate-4.4.0-to-4.5.0.sql\r\n&lt;Exponential root&gt;/update/database/&lt;mysql|postgresql&gt;/4.6/dbupdate-4.6.0-to-4.7.0.sql' ); return false;" /></p>
<![endif]--><p>You can run these with the appropriate sql command line tool or application.</p><p>If you are using a DFS&nbsp;cluster, you must run the following query:</p><pre class="wordwrap"><span class="line">ALTER TABLE `ezdfsfile` CHANGE `datatype` `datatype` VARCHAR(255);</span>
</pre><p>and if you are using a DB cluster, you ust run the following query:</p><pre class="wordwrap"><span class="line">ALTER TABLE `ezdbfile` CHANGE `datatype` `datatype` VARCHAR(255);</span>
</pre><a name="eztoc126933_4_2_0_1" id="eztoc126933_4_2_0_1"></a><h5>Schema changes</h5><p><b>Note:</b> The schema changes are only necessary if you have eZ Flow installed and if you are making an upgrade from 4.2 -&gt; 4.7. If so you must run this sql on the mysql client</p><pre class="wordwrap"><span class="line">ALTER TABLE ezm_pool ADD INDEX ezm_pool__block_id__ts_hidden ( block_id, ts_hidden );</span>
</pre><a name="eztoc126933_4_2_1" id="eztoc126933_4_2_1"></a><h4>MySQL</h4><p>The &quot;ezmysql&quot; database driver has been deprecated in 4.5 and it is recommended to use the &quot;ezmysqli&quot; driver instead. This requires that the &quot;mysqli&quot; extension in PHP is enabled and can be archived by changing the driver in your override or siteaccesses &quot;site.ini.append.php&quot; settings to:</p><pre class="wordwrap"><span class="line">[DatabaseSettings]</span>
<span class="line">DatabaseImplementation=ezmysqli</span>
</pre><a name="eztoc126933_4_2_2" id="eztoc126933_4_2_2"></a><h4>Clustering</h4><p>In version 4.7, the way the Exponential cluster is configured has completely changed. Until this version, a custom index_cluster.php file that contained the configuration had to be created, and included the file actually delivering the assets. This method is deprecated. index_cluster.php now exists by default in the distribution, and cluster configuration is done in the custom config.cluster.php file (or config.php).</p><p>Upgrading will be as simple as replicating the configuration variables (up to a dozen) previously defined in index_cluster.php, and put them in config.cluster.php.</p><p>More details about these directives can be found in the&nbsp;<a href="../../../Technical-manual/4.7/Features/Clustering/Setting-it-up-for-an-eZDFSFileHandler.html" target="_self">DFS</a>&nbsp;or&nbsp;<a href="../../../Technical-manual/4.7/Features/Clustering/Setting-it-up-for-an-eZDBFileHandler.html" target="_self">DB</a>&nbsp;clusters configuration instructions, and more in-depth information about the configuration directives can be found in the&nbsp;<a href="../../../Technical-manual/4.7/Features/Clustering/Cluster-Configuration-Settings.html" target="_self">cluster configuration settings documentation</a>.</p><a name="eztoc126933_5" id="eztoc126933_5"></a><h2>Step 4: Regenerate the autoload array for extensions</h2><p>The autoload system also has some changes, for example the autoload array for extensions is now placed in var/autoload of your Exponential installation (along with the class changes in extensions itself).</p><p>To regenerate the autoload array, execute the following script from the root of your Exponential directory:&nbsp;</p><pre class="wordwrap"><span class="line">php bin/php/ezpgenerateautoloads.php --extension</span>
</pre><a name="eztoc126933_6" id="eztoc126933_6"></a><h2>Step 5: Run the system upgrade scripts</h2><a name="eztoc126933_6_2_3" id="eztoc126933_6_2_3"></a><h4>4.2 to 4.3</h4><p>This version includes a script to fix #15478: Node assignment is not removed when removing node from child list:</p><pre class="wordwrap"><span class="line">php update/common/scripts/4.3/updatenodeassignment.php -s $SITE_ACCESS</span>
</pre><a name="eztoc126933_6_2_4" id="eztoc126933_6_2_4"></a><h4>4.3 to 4.4</h4><p>The update script for this version contained a bug and is repeated in 4.4 to 4.5 below, thus is not needed in this instruction.</p><a name="eztoc126933_6_2_5" id="eztoc126933_6_2_5"></a><h4>4.4 to 4.5</h4><p>For Exponential 4.4 which was upgraded from 4.3, run the following command from the root of your Exponential directory:</p><pre class="wordwrap"><span class="line">php update/common/scripts/4.5/updatesectionidentifier.php -s $SITE_ACCESS</span>
</pre><p><b>Note:</b> Skip this step if your 4.4 installation is not an upgrade from 4.3. If you are uncertain, please run the script.</p><a name="eztoc126933_6_2_6" id="eztoc126933_6_2_6"></a><h4>4.5 to 4.6</h4><p>There are two system upgrade scripts that can be run for the Exponential 4.6 upgrade, &quot;<i>removetrashedimages.php</i>&quot; and &quot;<i>updateordernumber.php</i>&quot;.</p><p><b>Script 1:</b> If you want to ensure no trashed images remain on your setup because of image aliases not being restored when restoring object from trash (issue #017781), you must do the following:</p>
<ol>
<li><div>Make sure that no items remains in trash for any users (images from objects in trash would be impossible to restore not doing so)</div></li><li><div>Run the following cleanup script by executing this command:</div></li>
</ol>
<pre class="wordwrap"><span class="line">$ php update/common/scripts/4.6/removetrashedimages.php</span>
</pre><p><b>Note:</b> It is safe to skip this test, this is only to free extra space.</p><p><b>Script 2:</b> You need to run an upgrade script to update webshop order numbers issue (#018233) by running:</p><pre class="wordwrap"><span class="line">$ php update/common/scripts/4.6/updateordernumber.php</span>
</pre><p><b>Note:</b> If you don’t have webshop or you don’t have orders (table &quot;<i>ezorder</i>&quot;) in your Exponential, you don’t have to run this script.</p><a name="eztoc126933_7" id="eztoc126933_7"></a><h2>Step 6: Additional upgrade steps</h2><p><b>Update &quot;override.ini.append.php&quot;</b></p><p>Content panes are not visible on the &quot;User accounts&quot; tab in the back-end. To fix it on an already-installed Exponential, remove the following rules from your &quot;override.ini.append.php&quot; for your admin siteaccess:</p><pre class="wordwrap copytoclipboard"><span class="line">[window_controls]</span>
<span class="line">Source=window_controls.tpl</span>
<span class="line">MatchFile=window_controls_user.tpl</span>
<span class="line">Subdir=templates</span>
<span class="line">Match[navigation_part_identifier]=ezusernavigationpart</span>
<span class="line">&nbsp;</span>
<span class="line">[windows]</span>
<span class="line">Source=windows.tpl</span>
<span class="line">MatchFile=windows_user.tpl</span>
<span class="line">Subdir=templates</span>
<span class="line">Match[navigation_part_identifier]=ezusernavigationpart</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '[window_controls]\r\nSource=window_controls.tpl\r\nMatchFile=window_controls_user.tpl\r\nSubdir=templates\r\nMatch[navigation_part_identifier]=ezusernavigationpart\r\n\r\n[windows]\r\nSource=windows.tpl\r\nMatchFile=windows_user.tpl\r\nSubdir=templates\r\nMatch[navigation_part_identifier]=ezusernavigationpart' ); return false;" /></p>
<![endif]--><p><b>Deprecated function (ezi18n()) in eZ Starrating</b></p><p>There is a deprecated function (ezi18n()) in extension eZ Starrating for Exponential versions 4.2, 4.3, 4.4.</p><p>This will generate an error if you try to clear the cache, when doing a direct upgrade to 4.7.</p><p>You need to manually disable this extension:</p><pre class="wordwrap"><span class="line">edit settings/override/site.ini.append.php and remove or comment the following line</span>
<span class="line">ActiveExtensions[]=ezstarrating</span>
</pre><p>You need to activate the extension again after upgrading the respective packages</p><p>... and clear the cache after disabling it. See separate step below.</p><a name="eztoc126933_8" id="eztoc126933_8"></a><h2>Step 7: Enable admin2 design for back-end</h2><p>To enable admin2 open &quot;site.ini&quot; for your admin site access. For an eZ Flow site this would be, for instance:</p><pre class="wordwrap"><span class="line">settings/siteaccess/ezflow_site_admin/site.ini.append.php</span>
</pre><p>In this file include &quot;AdditionalSiteDesignList[]=admin2&quot; to your [DesignSettings]. It is important that you add the <i>admin2</i> design before the <i>admin</i> design, in order to let extensions that have admin templates to continue to work. On an eZ Flow site, it would mean changing the settings from:</p><pre class="wordwrap copytoclipboard"><span class="line">[DesignSettings]</span>
<span class="line">SiteDesign=ezflow_site_admin</span>
<span class="line">AdditionalSiteDesignList[]=admin</span>
<span class="line">AdditionalSiteDesignList[]=ezflow</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '[DesignSettings]\r\nSiteDesign=ezflow_site_admin\r\nAdditionalSiteDesignList[]=admin\r\nAdditionalSiteDesignList[]=ezflow' ); return false;" /></p>
<![endif]--><p>to</p><pre class="wordwrap copytoclipboard"><span class="line">[DesignSettings]</span>
<span class="line">SiteDesign=ezflow_site_admin</span>
<span class="line">AdditionalSiteDesignList[]=admin2</span>
<span class="line">AdditionalSiteDesignList[]=admin</span>
<span class="line">AdditionalSiteDesignList[]=ezflow</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '[DesignSettings]\r\nSiteDesign=ezflow_site_admin\r\nAdditionalSiteDesignList[]=admin2\r\nAdditionalSiteDesignList[]=admin\r\nAdditionalSiteDesignList[]=ezflow' ); return false;" /></p>
<![endif]--><p>When using a plain or eZ Webin install you should make the same changes. In this case you will of course have a different SiteDesign setting and no AdditionalSiteDesignList[]=ezflow line.</p><p>To enable users to change their Administration Interface preferences (Location and Re-Edit editing preferences), add the following line to the [Toolbar_admin_right] block in settings/siteaccess/&lt;siteaccess_name&gt;/toolbar.ini.append.php:</p><pre class="wordwrap"><span class="line">Tool[]=admin_preferences</span>
</pre><p>So the block will then look like this:</p><pre class="wordwrap copytoclipboard"><span class="line">[Toolbar_admin_right]</span>
<span class="line">Tool[]</span>
<span class="line">Tool[]=admin_current_user</span>
<span class="line">Tool[]=admin_bookmarks</span>
<span class="line">Tool[]=admin_preferences</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '[Toolbar_admin_right]\r\nTool[]\r\nTool[]=admin_current_user\r\nTool[]=admin_bookmarks\r\nTool[]=admin_preferences' ); return false;" /></p>
<![endif]--><a name="eztoc126933_9" id="eztoc126933_9"></a><h2>Step 8: Clear the caches</h2><p>Whenever an Exponential solution is upgraded, all caches must be cleared in a proper way. <b>Note:</b> You should not be a root user when you start the caching process (refer to <a href="http://issues.ez.no/15823" target="_self">http://issues.ez.no/15823</a>). The caching should be done from within a system shell:</p>
<ol>
<li><div>Navigate into the Exponential 4.5 directory.</div></li><li><div>Run the script using the following shell command:</div></li>
</ol>
<pre class="wordwrap"><span class="line">php bin/php/ezcache.php --clear-all --purge</span>
</pre><p>Purging ensures that the caches are physically removed. When the &quot;--purge&quot; parameter is not specified, the caches will be expired but not removed.</p><p>Sometimes the script is unable to clear all cache files because of restrictive file/directory permission settings. Make sure that all cache files have been cleared by inspecting the contents of the various cache sub-directories within the &quot;var&quot; directory (typically the &quot;var/cache/&quot; and &quot;var/&lt;name_of_siteaccess&gt;/cache/&quot; directories). If there are any cache files left, you need to remove them manually.</p><a name="eztoc126933_10" id="eztoc126933_10"></a><h2>Step 9: Upgrade extensions</h2><p>The first thing to do is to change the extensions permissions. An example on how this is done:</p><pre class="wordwrap"><span class="line">$chmod -R a+rwx extension</span>
</pre><a name="eztoc126933_10_3" id="eztoc126933_10_3"></a><h3>Mobile device detection</h3><p>When upgrading from Exponential 4.6 to 4.7 and you are using eZ Flow, you can benefit from the new mobile device detection feature. Put the following settings in your &quot;<i>settings/override/site.ini.append.php</i>&quot; file:</p><pre class="wordwrap copytoclipboard"><span class="line">[SiteAccessSettings]</span>
<span class="line">[...]</span>
<span class="line">DetectMobileDevice=enabled</span>
<span class="line">MobileSiteAccessURL=http://example.com/iphone</span>
<span class="line">MobileSiteAccessList[]</span>
<span class="line">MobileSiteAccessList[]=iphone</span>
<span class="line">[...]</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '[SiteAccessSettings]\r\n[...]\r\nDetectMobileDevice=enabled\r\nMobileSiteAccessURL=http://example.com/iphone\r\nMobileSiteAccessList[]\r\nMobileSiteAccessList[]=iphone\r\n[...]' ); return false;" /></p>
<![endif]--><p>An &quot;iphone&quot; siteaccess is provided out-of-the-box with your eZ Flow installation. Make sure that the MobileSiteAccessURL= points to the &quot;iphone&quot; site access. Note that this is a full URL and needs to include the http:// part.</p><a name="eztoc126933_10_4" id="eztoc126933_10_4"></a><h3>New object edit form in the Administration interface</h3><p>While upgrading eZ Flow to the next release, you will have to replace the following override condition in &quot;settings/siteaccess/&lt;admin siteaccess&gt;/override.ini.append.php&quot;. This is to adjust to the changes in the object edit form in the Administration interface.</p><pre class="wordwrap copytoclipboard"><span class="line">[edit_frontpage]</span>
<span class="line">Source=content/edit.tpl</span>
<span class="line">MatchFile=edit/frontpage.tpl</span>
<span class="line">Subdir=templates</span>
<span class="line">Match[class_identifier]=frontpage</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '[edit_frontpage]\r\nSource=content/edit.tpl\r\nMatchFile=edit/frontpage.tpl\r\nSubdir=templates\r\nMatch[class_identifier]=frontpage' ); return false;" /></p>
<![endif]--><p>with this new one</p><pre class="wordwrap copytoclipboard"><span class="line">[add_to_block_frontpage]</span>
<span class="line">Source=content/parts/add_to_block.tpl</span>
<span class="line">MatchFile=content/parts/add_to_block_frontpage.tpl</span>
<span class="line">Subdir=templates</span>
<span class="line">Match[class_identifier]=frontpage</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '[add_to_block_frontpage]\r\nSource=content/parts/add_to_block.tpl\r\nMatchFile=content/parts/add_to_block_frontpage.tpl\r\nSubdir=templates\r\nMatch[class_identifier]=frontpage\r\n' ); return false;" /></p>
<![endif]--><p>The same operation may have to be done if the same override condition has been added for other class_identifier than &quot;frontpage&quot;.</p><a name="eztoc126933_10_5" id="eztoc126933_10_5"></a><h3>eZ Flow &amp; eZ Webin</h3><p>When using eZ Webin and eZ Flow, these extensions will also need to be updated. Follow the dedicated upgrade instructions, depending on what version you are upgrading from.</p><a name="eztoc126933_10_5_7" id="eztoc126933_10_5_7"></a><h4>4.2 to 4.3</h4><p>
<a href="../../../../Extensions/Exponential-extensions/Website-Interface/Website-interface-4.html" id="vmvc" title="http://ez.no/doc/extensions/website_interface/website_interface_1_7_upgrade" target="_self">eZ Webin</a>&nbsp;1.5 to 1.6<br /><a href="../../../../Extensions/Exponential-extensions/eZ-Flow/Upgrading-eZ-Flow/eZ-Flow-10.html" id="qorj" title="http://ez.no/doc/extensions/ez_flow/ez_flow_2_2_upgrade" target="_self">eZ Flow</a>&nbsp;2.0 to 2.1</p><a name="eztoc126933_10_5_8" id="eztoc126933_10_5_8"></a><h4>4.3 to 4.4</h4><p>
<a href="../../../../Extensions/Exponential-extensions/Website-Interface/Website-interface-3.html" id="vmvc" title="http://ez.no/doc/extensions/website_interface/website_interface_1_7_upgrade" target="_self">eZ Webin</a>&nbsp;1.6 to 1.7<br /><a href="../../../../Extensions/Exponential-extensions/eZ-Flow/Upgrading-eZ-Flow/eZ-Flow-9.html" id="qorj" title="http://ez.no/doc/extensions/ez_flow/ez_flow_2_2_upgrade" target="_self">eZ Flow</a>&nbsp;2.1 to 2.2</p><a name="eztoc126933_10_5_9" id="eztoc126933_10_5_9"></a><h4>4.4 to 4.5</h4><p>
<a href="../../../../Extensions/Exponential-extensions/Website-Interface/Website-interface-2.html" id="vmvc" title="http://ez.no/doc/extensions/website_interface/website_interface_1_7_upgrade" target="_self">eZ Webin</a>&nbsp;1.7 to 1.8<br /><a href="../../../../Extensions/Exponential-extensions/eZ-Flow/Upgrading-eZ-Flow/eZ-Flow-4.html" id="qorj" title="http://ez.no/doc/extensions/ez_flow/ez_flow_2_2_upgrade" target="_self">eZ Flow</a>&nbsp;2.2 to 2.3</p><a name="eztoc126933_10_5_10" id="eztoc126933_10_5_10"></a><h4>4.5 to 4.6</h4><p>
<a href="../../../../Extensions/Exponential-extensions/Website-Interface/Website-interface-2.html" id="vmvc" title="http://ez.no/doc/extensions/website_interface/website_interface_1_7_upgrade" target="_self">eZ Webin</a>&nbsp;1.8 to 1.9<br /><a href="../../../../Extensions/Exponential-extensions/eZ-Flow/Upgrading-eZ-Flow/eZ-Flow-4.html" id="qorj" title="http://ez.no/doc/extensions/ez_flow/ez_flow_2_2_upgrade" target="_self">eZ Flow</a>&nbsp;2.3 to 2.4</p><a name="eztoc126933_10_5_11" id="eztoc126933_10_5_11"></a><h4>4.6 to 4.7</h4><p>
<a href="../../../../Extensions/Exponential-extensions/Website-Interface/Website-interface-10.html" id="vmvc" title="http://ez.no/doc/extensions/website_interface/website_interface_1_7_upgrade" target="_self">eZ Webin</a>&nbsp;1.9 to 2.0<br /><a href="../../../../Extensions/Exponential-extensions/eZ-Flow/Upgrading-eZ-Flow/eZ-Flow-2.html" id="qorj" title="http://ez.no/doc/extensions/ez_flow/ez_flow_2_2_upgrade" target="_self">eZ Flow</a>&nbsp;2.4 to 2.5</p>

<div class="break"></div><div class="pageinfo float-break">
<div class="created">


<p><label>Written by:</label>Geir Arne Waaler&nbsp;(18/01/2012 10:31 am)</p>
</div>
<div class="modified">
<p><label>Last updated by:</label>Andrea Melo&nbsp;(25/06/2012 11:02 am)</p>
</div><div class="authors">
<p><label>Maintainers:</label>Geir Arne Waaler, Bertrand Dunogier, Andrea Melo</p>
</div></div>
<hr class="hide" />

</div>
</div>
</div>

<div id="comments" class="class-comment">
<div class="content-view-children">

<h1>Comments</h1>
<p>There are no comments.</p>
<div class="toolbar">

<form method="post" action="https://doc.ez.no/doc_hidden/content/action">
<input class="button" type="submit" name="NewButton" value="New comment" />
<input type="hidden" name="NodeID" value="26464" />
<input type="hidden" name="RedirectURIAfterPublish" value="Exponential/Upgrading/Direct-upgrading/Direct-upgrading-to-4.7-from-4.1-4.2-4.3-4.4-and-4.5/Direct-upgrading-from-4.2-to-4.7" />
<input type="hidden" name="ClassID" value="17" />
</form>
</div>

</div>
</div>

</div>
<!-- Main area content: END -->

</div>
</div>
<!-- Main area: END -->
<hr class="hide" />

</div></div></div>

        <div id="footer-bg">
        <div id="footer" class="container_12">

            <div class="grid_3">
                <img src="https://exponential.doc.exponential.earth/extension/ezdoc/design/doc/images/exponential.png" alt="exponential" />
                <div id="footer-copyright" class="grid_3 alpha omega">
                                    </div>
            </div>

            <div class="grid_6 middle">
                <div class="grid_6 alpha omega">
                    <div class="grid_3 alpha"><div></div></div>
                    <div class="grid_3 omega"><div></div></div>
                </div>
            </div>

            <div class="grid_3 right">
                <div class="contact-ez">
                        Get the support you need faster! Ask the experts at 7x. <a id="cta-contact" href="https://se7enx.com/contact" title="Contact 7x!" class="btn-green btn--small">Call or Contact 7x Today!</a>
                </div>

                <div class="adress"></div>
            </div>

        </div>
    </div>
<div id="footer-connect-bg">
    <div id="footer" class="container_12">
        <div id="footer-connect-copyright" class="grid_8 alpha omega">
            Copyright © 1998 - 2025 <a href="https://se7enx.com">7x</a> (except where otherwise noted). All rights reserved.
            <br/><br/>
            Powered by <a href="https://se7enx.com/exponential" title="Exponential CMS">The Exponential CMS</a> and the groundbreaking <a href="https://exponential.earth">Exponential</a> <a href="https://share.exponential.earth">Community</a>.<br />
        </div>

        <div id="footer-connect-social" class="grid_4 right"> <b>Find Exponential on Your Favorite Social Network:</b>&nbsp; 
            <a href="https://www.youtube.com/@ExponentialCMSInsights" class="youtube" target="_blank">YouTube</a>,

            <a href="http://www.Linkedin.com/groups?gid=2759&amp;trk=myg_ugrp_ovr" class="Linkedin" target="_blank">Linkedin</a>,
            <a href="https://www.Instagram.com/se7enxweb" class="Instagram" target="_blank">Instagram</a>,
            <a href="http://facebook.exponential.earth" class="Facebook" target="_blank">Facebook</a>,
            <a href="https://bsky.app/profile/exponentialcms.bsky.social" class="BlueSky" target="_blank">BlueSky</a>,
            <a href="https://twitter.com/se7enxweb" class="X" target="_blank">X</a>
        </div>

    </div>
</div>


</div>
<!-- Complete page area: END -->




<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1VMV65H63V"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1VMV65H63V');
</script>






</body>

<!-- Mirrored from doc.ez.no/doc_hidden/Exponential/Upgrading/Direct-upgrading/Direct-upgrading-to-4.7-from-4.1-4.2-4.3-4.4-and-4.5/Direct-upgrading-from-4.2-to-4.7 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 12:50:18 GMT -->
</html>

<!-- th[eZ] 20050804 -->
