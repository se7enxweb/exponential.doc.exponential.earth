

<!DOCTYPE html>
<html lang="en-GB">


<!-- Mirrored from doc.ez.no/doc_hidden/layout/set/full/Exponential/Technical-manual/3.8/Reference/Template-functions/Miscellaneous/cache-block by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 22:26:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>    <link rel="stylesheet" type="text/css" href="../../../../../../../../../../extension/ezdoc/design/doc/stylesheets/core.css" />
<style type="text/css"></style>
                                                          
    <title>cache-block / Miscellaneous / Template functions / Reference / 3.8 / Technical manual / Exponential / Documentation - Doc</title>

    
    
    
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

            <meta http-equiv="Content-language" content="en-GB" />

    
                <meta name="author" content="eZ systems" />
                    <meta name="copyright" content="eZ systems" />
                    <meta name="description" content="Exponential Documentation" />
                    <meta name="keywords" content="Exponential, documentation, manual, reference, eZ systems" />
        
    <meta name="generator" content="Exponential" />
    <link rel="Home" href="../../../../../../../full.html" title="Doc front page" />
<link rel="Search" href="../../../../../../content/advancedsearch.html" title="Search Doc" />
<link rel="Shortcut icon" href="../../../../../../../../../../extension/ezdoc/design/doc/images/favicon.ico" type="image/x-icon" />

</head>

<body>



<div class="attribute-heading">
<h1>cache-block</h1>
</div>
<h3>Summary</h3>
Caches the contents of a template block.<h3>Usage</h3>
<pre>{cache-block [ keys=keys                      ]
             [ expiry=expiry                  ]
             [ ignore_content_expiry          ]
             [ subtree_expiry=subtree_expiry  ]}

...

{/cache-block}
</pre><h3>Parameters</h3><table class="list" cellspacing="0">
<tr><th>Name</th><th>Type</th><th>Description</th><th>Required</th></tr><tr class="bglight">
        <td>keys</td>
        <td>string or array</td>
        <td>Cache key(s) - either as a string or an array of strings.</td>
        <td>No.</td>
    </tr><tr class="bgdark">
        <td>expiry</td>
        <td>integer</td>
        <td>The number of seconds that the cache should be allowed to live.</td>
        <td>No.</td>
    </tr><tr class="bglight">
        <td>ignore_content_expiry</td>
        <td>-</td>
        <td>Disables cache expiry when new content is published.</td>
        <td>No.</td>
    </tr><tr class="bgdark">
        <td>subtree_expiry</td>
        <td>string</td>
        <td>A subtree that expires the cache block.</td>
        <td>No.</td>
    </tr></table><h3>Description</h3>
<p>This solution makes it possible to reduce the processing time of the main template (&quot;pagelayout.tpl&quot;), which often contains a lot of dynamic elements. It can be used to instruct the system to store and reuse cached blocks of template code based on different conditions.</p><p>A typical example of where the &quot;cache-block&quot; mechanism should be used is the main menu of a site. The menu is often dynamically generated by fetching and displaying information about some nodes. It is usually the same for almost every page, therefore it should not be generated from scratch every time Exponential is instructed to render a page. This is where the &quot;cache-block&quot; solution comes in. In this particular scenario, it can be used to cache the contents of the main menu and thus reduce the processing time for each page load.</p><p><b>Note:</b> The cache-block stores it's content as text fragments, and does not execute any of it content again before the cache has been expired.</p><a name="eztoc29449_0_0_1" id="eztoc29449_0_0_1"></a><h4>Cache keys</h4><p>The &quot;keys&quot; parameter can be used to define the uniqueness of a cache block. It must be either a string or an array of strings. By default, Exponential uses the name of the template and the position of the cache block as keys. This means that if the cache block is common for all cases that use the given template (normally &quot;pagelayout.tpl&quot;), there is no need to define any keys. However, the &quot;keys&quot; parameter is quite handy when it comes to relating a cache block to something specific (for example URLs, users, etc.). Please refer to the examples below for a demonstration of how this parameter can be used.</p><a name="eztoc29449_0_0_2" id="eztoc29449_0_0_2"></a><h4>Time based expiration</h4><p>The &quot;expiry&quot; parameter makes it possible to manually specify how long a cache block should live (number of seconds). The default expiration time is two hours (this is hardcoded in the system and can not be configured). If an object is published, all blocks will automatically be expired. A value of zero will produce a cache block that will never expire.</p><a name="eztoc29449_0_0_3" id="eztoc29449_0_0_3"></a><h4>Content expiration</h4><p>By default, all cache blocks will be expired whenever an object is published. If the &quot;ignore_content_expiry&quot; parameter is used, the cache block will not be expired when an object is published. However, it will still expire after two hours unless an alternative time is specified using the &quot;expiry&quot; parameter.</p><a name="eztoc29449_0_0_4" id="eztoc29449_0_0_4"></a><h4>Subtree expiration</h4><p>The &quot;subtree_expiry&quot; parameter can be used to bind the expiration of a cache block to a certain part of the content node tree. When this is done, the block will expire if an object is published below the given subtree instead of the entire tree. In addition, it will also expire after two hours unless an alternative time is specified using the &quot;expiry&quot; parameter.</p><a name="eztoc29449_0_0_5" id="eztoc29449_0_0_5"></a><h4>Tips and tricks</h4><p>Since cache blocks themselves also produce some overhead, too many blocks may lead to longer response times than expected. Because of this, only a few cache blocks should be used; and their keys should be as unique as possible. It is often very efficient to have two large cache blocks. One which caches all header information (title, path, etc.) and one which will take care of the bottom/footer of the page. This solution combined with a nested cache block used for the main menu (or several menus, etc.) often leads to good results. Please note that although the cache block mechanism was designed to minimize the processing of the main template, it may also be used in view templates. For example, it is possible to cache a part of a view - this is typically useful when the viewcache is frequently deleted. Another scenario is when the view cache is turned off and there is a need to create a cache on a per-user basis.</p><h3>Examples</h3>
<a name="eztoc29450_0_0_1" id="eztoc29450_0_0_1"></a><h4>Example 1</h4><pre class="wordwrap copytoclipboard"><span class="line">...</span>
<span class="line">{include uri='design:page_toppath.tpl'}</span>
<span class="line">&nbsp;</span>
<span class="line">{cache-block}</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;{include uri='design:menu.tpl'}</span>
<span class="line">{/cache-block}</span>
<span class="line">&nbsp;</span>
<span class="line">{$module_result.content}</span>
<span class="line">&nbsp;</span>
<span class="line">{include uri='design:page_bottom.tpl'}</span>
<span class="line">...</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '...\r\n{include uri=\'design:page_toppath.tpl\'}\r\n\r\n{cache-block}\r\n    {include uri=\'design:menu.tpl\'}\r\n{/cache-block}\r\n\r\n{$module_result.content}\r\n\r\n{include uri=\'design:page_bottom.tpl\'}\r\n...' ); return false;" /></p>
<![endif]--><p>This example demonstrates how the cache block solution can be used to cache the contents of a menu (which will be the same for all pages) in the pagelayout.</p><a name="eztoc29450_0_0_2" id="eztoc29450_0_0_2"></a><h4>Example 2</h4><pre class="wordwrap"><span class="line">{cache-block expiry=130}</span>
<span class="line">...</span>
<span class="line">{/cache-block}</span>
</pre><p>This example demonstrates how to create a cache block that will expire after 130 seconds.</p><a name="eztoc29450_0_0_3" id="eztoc29450_0_0_3"></a><h4>Example 3</h4><pre class="wordwrap"><span class="line">{cache-block keys=$uri_string}</span>
<span class="line">...</span>
<span class="line">{/cache-block}</span>
</pre><p>This example demonstrates how to create a cache block that will be unique for every URL.</p><a name="eztoc29450_0_0_4" id="eztoc29450_0_0_4"></a><h4>Example 4</h4><pre class="wordwrap"><span class="line">{cache-block keys=array( $uri_string, $current_user.contentobject_id )}</span>
<span class="line">...</span>
<span class="line">{/cache-block}</span>
</pre><p>This example demonstrates how to create a cache block that is unique for each URL and each user.</p><a name="eztoc29450_0_0_5" id="eztoc29450_0_0_5"></a><h4>Example 5</h4><pre class="wordwrap"><span class="line">{cache-block ignore_content_expiry}</span>
<span class="line">...</span>
<span class="line">{/cache-block}</span>
</pre><p>This example demonstrates how to create a cache block that will not expire when new content is published. However, it will expire every second hour unless an alternative &quot;time to live&quot; value is specified using the &quot;expiry&quot; parameter.</p><a name="eztoc29450_0_0_6" id="eztoc29450_0_0_6"></a><h4>Example 6</h4><pre class="wordwrap"><span class="line">{cache-block subtree_expiry='products/'}</span>
<span class="line">...</span>
<span class="line">{/cache-block}</span>
</pre><p>This example demonstrates how to create a cache block that will expire only if something is modified within the &quot;products/&quot; subtree, for example if a product is modified or a new product is published.</p>




<address>
Powered by <a href="http://ez.no/exponential" title="Exponential&trade; CMS Open Source Web Content Management">Exponential&trade; CMS Open Source Web Content Management</a>. Copyright &copy; 1999-2013 <a href="http://ez.no/" title="eZ Systems AS">eZ Systems AS</a> (except where otherwise noted). All rights reserved.
</address>


</body>

<!-- Mirrored from doc.ez.no/doc_hidden/layout/set/full/Exponential/Technical-manual/3.8/Reference/Template-functions/Miscellaneous/cache-block by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 22:26:31 GMT -->
</html>
