

<!DOCTYPE html>
<html lang="en-GB">


<!-- Mirrored from doc.ez.no/doc_hidden/layout/set/full/layout/set/full/layout/set/full/layout/set/full/Extensions/Exponential-extensions/eZ-Find/eZ-Find-LS-5.1.0/Customization/General-Index-Time-Plugin-Mechanism/(language)/eng-GB by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 19:08:11 GMT -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <link rel="stylesheet" type="text/css" href="../../../../../../../../../../../../../../../../../../../../extension/ezdoc/design/doc/stylesheets/core.css" />
<style type="text/css"></style>
                                                    
    <title>General Index Time Plugin Mechanism / Customization / eZ Find LS 5.1.0 / eZ Find / Exponential extensions / Extensions / Documentation - Doc</title>

    
    
    
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

            <meta http-equiv="Content-language" content="en-GB" />

    
                <meta name="author" content="eZ systems" />
                    <meta name="copyright" content="eZ systems" />
                    <meta name="description" content="Exponential Documentation" />
                    <meta name="keywords" content="Exponential, documentation, manual, reference, eZ systems" />
        
    <meta name="generator" content="Exponential" />
    <link rel="Home" href="../../../../../../../../full.html" title="Doc front page" />
<link rel="Search" href="../../../../../../../content/advancedsearch.html" title="Search Doc" />
<link rel="Shortcut icon" href="../../../../../../../../../../../../../../../../../../../../extension/ezdoc/design/doc/images/favicon.ico" type="image/x-icon" />

</head>

<body>



<div class="attribute-heading">
<h1>General Index Time Plugin Mechanism</h1>
</div>

<a name="eztoc135811_0_0_1" id="eztoc135811_0_0_1"></a><h4><b>General Index Time Plugin Mechanism</b></h4><a name="eztoc135811_0_0_1_1" id="eztoc135811_0_0_1_1"></a><h5><b>Audience</b></h5><p>This feature requires deeper understanding of Exponential kernel (object API), experience with eZ Find and PHP programming skills.</p><a name="eztoc135811_0_0_1_2" id="eztoc135811_0_0_1_2"></a><h5><b>Goals and Use Cases</b></h5><p>
In some specific situations, the indexing with custom plugins per datatype is not sufficient or even applicable, hence the need to create a new index time plugin system that is capable of inserting new fields and/or modifying the fields generated by the regular eZ Find index engine.<br />
Use cases are for example: indexing parent node information with an object or coping with a data model implementation where relations are part of the domain model, but do not use related objects or its datatype equivalents. This is typically the case where large amounts of data are imported into Exponential.<br />Another use case is to be able to modify boost factors of individual fields or whole documents based on the values or relations contained within an Exponential content object. For example, boosting articles that reference certain images, or articles that appear inside special eZ Flow blocks.</p><a name="eztoc135811_0_0_1_3" id="eztoc135811_0_0_1_3"></a><h5><b>How it Works</b></h5><p>During indexing, eZ Find can be instructed to call user defined functions from classes which implement a dedicated PHP interface. This is done after the eZ Find indexer has done the bulk of the work indexing the regular data and metadata. The arguments are on one hand the current content object in the indexing process and on the other hand the eZ Solr document object --- consisting of raw fields and its corresponding values --- to be modified by the custom defined function. Not only fields can be modified or added, but also the overall document level and field level boost factors.</p><a name="eztoc135811_0_0_1_4" id="eztoc135811_0_0_1_4"></a><h5><b>How to Use</b></h5><p>The first step is to create your custom class implementing the function <i>'modify</i>' as defined by the interface:</p><pre class="wordwrap copytoclipboard"><span class="line">interface ezfIndexPlugin</span>
<span class="line">{</span>
<span class="line">&nbsp;&nbsp;&nbsp;/**</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;* @var eZContentObject $contentObject</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;* @var array $docList</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;*/</span>
<span class="line">&nbsp;&nbsp;&nbsp;public function modify(eZContentObject $contentObject, &amp;$docList);</span>
<span class="line">}</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '\r\ninterface ezfIndexPlugin\r\n{\r\n   /**\r\n    * @var eZContentObject $contentObject\r\n    * @var array $docList\r\n    */\r\n   public function modify(eZContentObject $contentObject, &amp;$docList);\r\n}\r\n' ); return false;" /></p>
<![endif]--><p>An example is given in the following listing where, for every language version of an object, the main node parent object name is indexed in a new field:</p><pre class="wordwrap copytoclipboard"><span class="line">class ezfIndexParentName implements ezfIndexPlugin</span>
<span class="line">{</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* The modify method gets the current content object AND the list of</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Solr Docs (for each available language version).</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param eZContentObject $contentObect</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param array $docList</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public function modify(eZContentObject $contentObect, &amp;amp;$docList)</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentNode = $contentObect-&amp;gt;attribute('main_node');</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$parentNode = $contentNode-&amp;gt;attribute('parent');</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($parentNode instanceof eZContentObjectTreeNode)</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$parentObject = $parentNode-&amp;gt;attribute('object');</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$parentVersion = $parentObject-&amp;gt;currentVersion();</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$availableLanguages = $parentVersion-&amp;gt;translationList( false, false );</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ($availableLanguages as $languageCode)</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$docList[$languageCode]-&gt;addField('extra_parent_node_name_t', &nbsp;$parentObject-&gt;name( false, $languageCode ) );</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<span class="line">}</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '\r\nclass ezfIndexParentName implements ezfIndexPlugin\r\n{\r\n     /**\r\n      * The modify method gets the current content object AND the list of\r\n      * Solr Docs (for each available language version).\r\n      *\r\n      *\r\n      * @param eZContentObject $contentObect\r\n      * @param array $docList\r\n      */\r\n      public function modify(eZContentObject $contentObect, &amp;amp;$docList)\r\n      {\r\n            $contentNode = $contentObect-&amp;gt;attribute(\'main_node\');\r\n            $parentNode = $contentNode-&amp;gt;attribute(\'parent\');\r\n            if ($parentNode instanceof eZContentObjectTreeNode)\r\n            {\r\n                  $parentObject = $parentNode-&amp;gt;attribute(\'object\');\r\n                  $parentVersion = $parentObject-&amp;gt;currentVersion();\r\n                  $availableLanguages = $parentVersion-&amp;gt;translationList( false, false );\r\n                  foreach ($availableLanguages as $languageCode)\r\n                  {\r\n                          $docList[$languageCode]-&gt;addField(\'extra_parent_node_name_t\',  $parentObject-&gt;name( false, $languageCode ) );\r\n                  }\r\n            }\r\n       }\r\n}\r\n' ); return false;" /></p>
<![endif]--><p>In order to activate your plugin, you need to add your PHP class name to the eZ Find ezfind.ini settings in the IndexPlugins section, for example:</p><pre class="wordwrap copytoclipboard"><span class="line">&nbsp;[IndexPlugins]</span>
<span class="line"># Allow injection of custom fields and manipulation of fields/boost parameters</span>
<span class="line"># at index time</span>
<span class="line"># This can be defined at the class level or general</span>
<span class="line">General[]</span>
<span class="line">#General[]=ezfIndexParentName</span>
<span class="line">#Classhooks will only be called for objects of the specified class</span>
<span class="line">Class[]</span>
<span class="line">Class[myspecialclass]=ezfIndexParentName</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', ' [IndexPlugins]\r\n# Allow injection of custom fields and manipulation of fields/boost parameters\r\n# at index time\r\n# This can be defined at the class level or general\r\nGeneral[]\r\n#General[]=ezfIndexParentName\r\n#Classhooks will only be called for objects of the specified class\r\nClass[]\r\nClass[myspecialclass]=ezfIndexParentName' ); return false;" /></p>
<![endif]--><p>This will enable the PHP class <b>ezfIndexParentName</b> for the <b>myspecialclass</b> Exponential class of objects.</p>




<address>
Powered by <a href="http://ez.no/exponential" title="Exponential&trade; CMS Open Source Web Content Management">Exponential&trade; CMS Open Source Web Content Management</a>. Copyright &copy; 1999-2013 <a href="http://ez.no/" title="eZ Systems AS">eZ Systems AS</a> (except where otherwise noted). All rights reserved.
</address>


</body>

<!-- Mirrored from doc.ez.no/doc_hidden/layout/set/full/layout/set/full/layout/set/full/layout/set/full/Extensions/Exponential-extensions/eZ-Find/eZ-Find-LS-5.1.0/Customization/General-Index-Time-Plugin-Mechanism/(language)/eng-GB by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 19:08:11 GMT -->
</html>
