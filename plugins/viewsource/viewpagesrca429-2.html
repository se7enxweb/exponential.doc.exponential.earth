                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=32870081 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 22:03:04 GMT -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpagea429-2.html?pageId=32870081" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/16/_/styles/colors.css" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <div class="contentLayout2">
<div class="columnLayout two-right-sidebar" data-layout="two-right-sidebar">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<table class="wysiwyg-macro" data-macro-name="info" data-macro-id="1812ff4b-1c60-4bff-9206-b421b3e04aac" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>Field Type identifier: <code>ezimage</code><br />Validators: File size<br />Value object: <code>\eZ\Publish\Core\FieldType\Image\Value</code><span><br />Associated Services: <code><span>exponential.fieldType.ezimage.variation_service</span></code></span></p></td></tr></table><p>The Image Field Type allows you to store an image file.</p><p>A <strong>variation service</strong> handles conversion of the original image into different formats and sizes through a set of preconfigured named variations: large, small, medium, black &amp; white thumbnail, etc.</p><h2>Value object</h2><p>The <code>value</code> property of an Image Field will return an <code>\eZ\Publish\Core\FieldType\Image\Value</code> object with the following properties:</p><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Type</th><th colspan="1" class="confluenceTh">Example</th><th colspan="1" class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><code>id</code></td><td class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><code><span>0/8/4/1/1480-1-eng-GB/image.png</span>  </code></td><td colspan="1" class="confluenceTd"><p>The image's unique identifier. Usually the path, or a part of the path. To get the full path, use <code>URI</code> property.</p></td></tr><tr><td class="confluenceTd"><code>alternativeText</code></td><td class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><code><span>This is a piece of text</span></code></td><td colspan="1" class="confluenceTd">The alternative text, as entered in the Field's properties</td></tr><tr><td class="confluenceTd"><code><span>fileName</span></code></td><td class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><code>image.png</code></td><td colspan="1" class="confluenceTd">The original image's filename, without the path</td></tr><tr><td colspan="1" class="confluenceTd"><code>fileSize</code></td><td colspan="1" class="confluenceTd">int</td><td colspan="1" class="confluenceTd"><code>37931</code></td><td colspan="1" class="confluenceTd">The original image's size, in bytes</td></tr><tr><td colspan="1" class="confluenceTd"><code>uri</code></td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><code><span>var/ezdemo_site/storage/images/0/8/4/1/1480-1-eng-GB/image.png</span></code></td><td colspan="1" class="confluenceTd">The original image's URI</td></tr><tr><td colspan="1" class="confluenceTd"><code>imageId</code></td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><code>240-1480</code></td><td colspan="1" class="confluenceTd">A special image ID, used by REST</td></tr></tbody></table><p>Using the variation Service, variations of the original image can be obtained. Those are <code style="line-height: 1.4285715;">\eZ\Publish\SPI\Variation\Values\ImageVariation</code><span style="line-height: 1.4285715;"> objects with the following properties:</span></p><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Property</th><th class="confluenceTh">Type</th><th class="confluenceTh">Example</th><th class="confluenceTh">Description</th></tr><tr><td colspan="1" class="confluenceTd"><code>width</code></td><td colspan="1" class="confluenceTd">int</td><td colspan="1" class="confluenceTd"><code>640</code></td><td colspan="1" class="confluenceTd">The variation's width in pixels</td></tr><tr><td colspan="1" class="confluenceTd"><code>height</code></td><td colspan="1" class="confluenceTd">int</td><td colspan="1" class="confluenceTd"><code>480</code></td><td colspan="1" class="confluenceTd">The variation's height in pixels</td></tr><tr><td colspan="1" class="confluenceTd"><code>name</code></td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><code>medium</code></td><td colspan="1" class="confluenceTd">The variation's identifier</td></tr><tr><td colspan="1" class="confluenceTd"><code>info</code></td><td colspan="1" class="confluenceTd">mixed</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">Extra info, such as EXIF data</td></tr><tr><td colspan="1" class="confluenceTd"><code>fileSize</code></td><td colspan="1" class="confluenceTd">int</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd"><code>mimeType</code></td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd"><code>fileName</code></td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd"><code>dirPath</code></td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd"><code>uri</code></td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">The variation's uri</td></tr><tr><td colspan="1" class="confluenceTd"><code>lastModified</code></td><td colspan="1" class="confluenceTd">DateTime</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">When the variation was last modified</td></tr></tbody></table><h2>Field Type options</h2><p>The Image Field Type supports one FieldDefinition option: the maximum size for the file.</p><h2>Using an Image Field</h2><h3>In templates</h3><p>When displayed using <code>ez_render_field</code>, an Image Field will output this type of HTML:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="a8d3d997-0a8e-48f7-b97a-f0a3179a04ec" data-macro-parameters="language=xml|linenumbers=true" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd0e8.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfGxpbmVudW1iZXJzPXRydWV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;img src="var/ezdemo_site/storage/images/0/8/4/1/1480-1-eng-GB/image_medium.png" width="844" height="430" alt="Alternative text" /></pre></td></tr></table><p>The template called by <a class="confluence-link" href="../../display/DEVELOPER/Content%2bRendering.html#ContentRendering-ez_render_field" data-anchor="ez_render_field" data-linked-resource-id="31429679" data-linked-resource-version="70" data-linked-resource-type="page" data-linked-resource-default-alias="Content Rendering#ez_render_field" data-base-url="../../index.html">the <strong>ez_render_field()</strong> Twig function</a> while rendering a Image field accepts the following the parameters:</p><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Parameter</th><th colspan="1" class="confluenceTh">Type</th><th class="confluenceTh">Default</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><code>alias</code></td><td colspan="1" class="confluenceTd"><code>string</code></td><td class="confluenceTd"><code><code>&quot;original</code></code><code>&quot;</code></td><td class="confluenceTd">The image variation name, must be defined in your site access <code>image_variations</code> settings. Defaults to &quot;original&quot;, the originally uploaded image.</td></tr><tr><td class="confluenceTd"><code>width</code></td><td colspan="1" class="confluenceTd"><code>int</code></td><td class="confluenceTd"> </td><td class="confluenceTd">Optionally to specify a different width set on the image html tag then then one from image alias.</td></tr><tr><td colspan="1" class="confluenceTd"><code>height</code></td><td colspan="1" class="confluenceTd"><span>int</span></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><span>Optionally to specify a different height set on the image html tag then then one from image alias.</span></td></tr><tr><td colspan="1" class="confluenceTd"><code>class</code></td><td colspan="1" class="confluenceTd"><code>string</code></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><span>Optionally to specify a specific html class for use in custom javascript and/or css.</span></td></tr></tbody></table><p> </p><p>Example: </p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="33b9bb70-a175-4bb8-9559-2584dcf09351" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{{ ez_render_field( content, 'image', { 'parameters':{ 'alias': 'imagelarge', 'width': 400, 'height': 400 } } ) }}</pre></td></tr></table><p>The raw Field can also be used if needed. Image variations for the Field's content can be obtained using the <code>ez_image_alias</code> Twig helper:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="da59dae9-2289-48ab-83a8-06bea0e94d6c" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{% set imageAlias = ez_image_alias( field, versionInfo, 'medium' ) %}</pre></td></tr></table><p><span style="line-height: 1.4285715;">The variation's properties can be used to generate the required output:</span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="97dbc0ab-ce81-48f5-a78d-7a4cbe6a0649" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;img src="{{ asset( imageAlias.uri ) }}" width="{{ imageAlias.width }}" height="{{ imageAlias.height }}" alt="{{ field.value.alternativeText }}" /></pre></td></tr></table><p> </p><h3>With the REST API</h3><p>Image Fields within REST are exposed by the <code>application/vnd.ez.api.Content</code> media-type. An Image Field will look like this:</p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="137bea21-6beb-4548-a49c-ae90718a10a9" data-macro-parameters="title=inputUri " data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading8004.png?definition=e2luZm86dGl0bGU9aW5wdXRVcmkgfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>From 5.2 version, new images must be input using the <code>inputUri</code> property from <code>Image\Value</code>.</p><p><strong>The keys <code>id</code> and <code>path</code> still work, but a deprecation warning will be thrown.</strong></p></td></tr></table><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="e2fe5e65-7406-40a3-8650-b0ad0c3458d4" data-macro-parameters="language=xml|linenumbers=true|title=Version >\= 5.2" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPVZlcnNpb24gPj0gNS4yfGxpbmVudW1iZXJzPXRydWV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;field>
    &lt;id>1480&lt;/id>
    &lt;fieldDefinitionIdentifier>image&lt;/fieldDefinitionIdentifier>
    &lt;languageCode>eng-GB&lt;/languageCode>
    &lt;fieldValue>
        &lt;value key="inputUri">/var/ezdemo_site/storage/images/0/8/4/1/1480-1-eng-GB/kidding.png&lt;/value>
        &lt;value key="alternativeText">&lt;/value>
        &lt;value key="fileName">kidding.png&lt;/value>
        &lt;value key="fileSize">37931&lt;/value>
        &lt;value key="imageId">240-1480&lt;/value>
        &lt;value key="uri">/var/ezdemo_site/storage/images/0/8/4/1/1480-1-eng-GB/kidding.png&lt;/value>
        &lt;value key="variations">
            &lt;value key="articleimage">
                &lt;value key="href">/api/ezp/v2/content/binary/images/240-1480/variations/articleimage&lt;/value>
            &lt;/value>
            &lt;value key="articlethumbnail">
                &lt;value key="href">/api/ezp/v2/content/binary/images/240-1480/variations/articlethumbnail&lt;/value>
            &lt;/value>
        &lt;/value>
    &lt;/fieldValue>
&lt;/field></pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="1ab48188-271e-45f6-b2dd-538f0a04c09d" data-macro-parameters="collapse=true|language=xml|linenumbers=true|title=Before 5.2" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading7a2d.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPUJlZm9yZSA1LjJ8bGluZW51bWJlcnM9dHJ1ZXxjb2xsYXBzZT10cnVlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;field>
    &lt;id>1480&lt;/id>
    &lt;fieldDefinitionIdentifier>image&lt;/fieldDefinitionIdentifier>
    &lt;languageCode>eng-GB&lt;/languageCode>
    &lt;fieldValue>
        &lt;value key="id">var/ezdemo_site/storage/images/0/8/4/1/1480-1-eng-GB/kidding.png&lt;/value>
        &lt;value key="path">/var/ezdemo_site/storage/images/0/8/4/1/1480-1-eng-GB/kidding.png&lt;/value>
        &lt;value key="alternativeText">&lt;/value>
        &lt;value key="fileName">kidding.png&lt;/value>
        &lt;value key="fileSize">37931&lt;/value>
        &lt;value key="imageId">240-1480&lt;/value>
        &lt;value key="uri">/var/ezdemo_site/storage/images/0/8/4/1/1480-1-eng-GB/kidding.png&lt;/value>
        &lt;value key="variations">
            &lt;value key="articleimage">
                &lt;value key="href">/api/ezp/v2/content/binary/images/240-1480/variations/articleimage&lt;/value>
            &lt;/value>
            &lt;value key="articlethumbnail">
                &lt;value key="href">/api/ezp/v2/content/binary/images/240-1480/variations/articlethumbnail&lt;/value>
            &lt;/value>
        &lt;/value&gt;
    &lt;/fieldValue>
&lt;/field></pre></td></tr></table><p> </p><p>Children of the fieldValue node will list the general properties of the Field's original image (fileSize, fileName, inputUri, etc.), as well as variations. For each variation, a uri is provided. Requested through REST, this resource will generate the variation if it doesn't exist yet, and list the variation details:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="72e43812-7608-4a16-a619-c5de9262d8b8" data-macro-parameters="language=xml|linenumbers=true" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd0e8.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfGxpbmVudW1iZXJzPXRydWV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;ContentImageVariation media-type="application/vnd.ez.api.ContentImageVariation+xml" href="/api/ezp/v2/content/binary/images/240-1480/variations/tiny">
  &lt;uri>/var/ezdemo_site/storage/images/0/8/4/1/1480-1-eng-GB/kidding_tiny.png&lt;/uri>
  &lt;contentType>image/png&lt;/contentType>
  &lt;width>30&lt;/width>
  &lt;height>30&lt;/height>
  &lt;fileSize>1361&lt;/fileSize>
&lt;/ContentImageVariation></pre></td></tr></table><h3>From PHP code</h3><h4>Getting an image variation</h4><p>The variation service, <code>exponential.fieldType.ezimage.variation_service</code>, can be used to generate/get variations for a Field. It expects a VersionInfo, the Image Field and the variation name, as a string (<code>large</code>, <code>medium</code>, etc.)</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="8829190e-26fa-4b75-bafa-8a6361c939ff" data-macro-parameters="language=php|linenumbers=true|type=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1390.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHR5cGU9cGhwfGxpbmVudW1iZXJzPXRydWV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$variation = $imageVariationHandler->getVariation(
    $imageField, $versionInfo, 'large'
);

echo $variation->uri;</pre></td></tr></table><h2>Manipulating image content</h2><h3>From PHP</h3><p>As for any Field Type, there are several ways to input content to a Field. For an Image, the quickest is to call <code>setField()</code> on the ContentStruct:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="51d70f22-0341-4969-895c-fd4a7e89f2a5" data-macro-parameters="language=php|linenumbers=true|type=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1390.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHR5cGU9cGhwfGxpbmVudW1iZXJzPXRydWV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$createStruct = $contentService->newContentCreateStruct(
    $contentTypeService->loadContentType( 'image' ),
    'eng-GB'
);

$createStruct->setField( 'image', '/tmp/image.png' );
</pre></td></tr></table><p>In order to customize the Image's alternative texts, you must first get an Image\Value object, and set this property. For that, you can use the <code>Image\Value::fromString()</code> method that accepts the path to a local file:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="c9e2de60-090e-477c-9173-8a9619228812" data-macro-parameters="language=php|linenumbers=true|type=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1390.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHR5cGU9cGhwfGxpbmVudW1iZXJzPXRydWV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$createStruct = $contentService->newContentCreateStruct(
    $contentTypeService->loadContentType( 'image' ),
    'eng-GB'
);

$imageField = \eZ\Publish\Core\FieldType\Image\Value::fromString( '/tmp/image.png' );
$imageField->alternativeText = 'My alternative text';
$createStruct->setField( 'image', $imageField );</pre></td></tr></table><p>You can also provide a hash of <code>Image\Value</code> properties, either to <code>setField()</code>, or to the constructor:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="5366284f-0ab4-4520-bfd5-1a87f446c0bc" data-macro-parameters="language=php|linenumbers=true|type=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1390.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHR5cGU9cGhwfGxpbmVudW1iZXJzPXRydWV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$imageValue = new \eZ\Publish\Core\FieldType\Image\Value(
    array(
        'id' => '/tmp/image.png',
        'fileSize' => 37931,
        'fileName' => 'image.png',
        'alternativeText' => 'My alternative text'
    )
);

$createStruct->setField( 'image', $imageValue );</pre></td></tr></table><h3>From REST</h3><p>The REST API expects Field values to be provided in a hash-like structure. Those keys are identical to those expected by the <code>Image\Value</code> constructor: <code>fileName</code>, <code>alternativeText</code>. In addition, image data can be provided using the <code>data</code> property, with the image's content encoded as base64.</p><h4>Creating an image Field</h4><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="d46131f9-10bd-4225-9a53-6bb0998df7ff" data-macro-parameters="language=xml|linenumbers=true|type=xml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading17a7.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHR5cGU9eG1sfGxpbmVudW1iZXJzPXRydWV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;?xml version="1.0" encoding="UTF-8"?>
&lt;ContentCreate>
    &lt;!-- [...metadata...] -->

    &lt;fields>
        &lt;field>
            &lt;id>247&lt;/id>
            &lt;fieldDefinitionIdentifier>image&lt;/fieldDefinitionIdentifier>
            &lt;languageCode>eng-GB&lt;/languageCode>
            &lt;fieldValue>
                &lt;value key="fileName">rest-rocks.jpg&lt;/value>
                &lt;value key="alternativeText">HTTP&lt;/value>
                &lt;value key="data">&lt;![CDATA[/9j/4AAQSkZJRgABAQEAZABkAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcG
BwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2[...]&lt;/value>
            &lt;/fieldValue>
        &lt;/field>
    &lt;/fields>
&lt;/ContentCreate></pre></td></tr></table><h4>Updating an image Field</h4><p>Updating an Image Field requires that you re-send existing data. This can be done by re-using the Field obtained via REST, <strong>removing the variations key</strong>, and updating <code>alternativeText</code>, <code>fileName</code> or <code>data</code>. If you do not want to change the image itself, do not provide the <code>data</code> key.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="46d88aa6-ec01-4e45-b1a9-7adf3c079fff" data-macro-parameters="language=xml|linenumbers=true|type=xml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading17a7.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHR5cGU9eG1sfGxpbmVudW1iZXJzPXRydWV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;?xml version="1.0" encoding="UTF-8"?>
&lt;VersionUpdate>
    &lt;fields>
        &lt;field>
            &lt;id>247&lt;/id>
            &lt;fieldDefinitionIdentifier>image&lt;/fieldDefinitionIdentifier>
            &lt;languageCode>eng-GB&lt;/languageCode>
            &lt;fieldValue>
                &lt;value key="id">media/images/507-1-eng-GB/Existing-image.png&lt;/value>
                &lt;value key="alternativeText">Updated alternative text&lt;/value>
                &lt;value key="fileName">Updated-filename.png&lt;/value>
			&lt;/fieldValue>
        &lt;/field>
    &lt;/fields>
&lt;/VersionUpdate></pre></td></tr></table><h2>Naming</h2><p>Each storage engine determines how image files are named.</p><h3>Legacy Storage Engine naming</h3><p>Images are stored within the following directory structure:</p><p><code>&lt;varDir&gt;/&lt;StorageDir&gt;/&lt;ImagesStorageDir&gt;/&lt;FieIdId[-1]&gt;/&lt;FieIdId[-2]&gt;/&lt;FieIdId[-3]&gt;/&lt;FieIdId[-4]&gt;/&lt;FieldId&gt;-&lt;VersionNumber&gt;-&lt;LanguageCode&gt;/</code></p><p>With the following values:</p><ul style="list-style-type: square;"><li><code>VarDir</code> = var (default)</li><li><code>StorageDir</code> = <code>storage</code> (default)</li><li><span><code>ImagesStorageDir</code> = <code>images</code> (default)</span></li><li><span><code>FieldId</code> = <code>1480</code></span></li><li><span><code>VersionNumber</code> = <code>1</code></span></li><li><span><code>LanguageCode</code> = <code>eng-GB</code></span></li></ul><p><span>Images will be stored to <code>web/var/ezdemo_site/storage/images/0/8/4/1/1480-1-eng-GB</code>.</span></p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="a0271b63-f856-436d-b317-6d4586f5c524" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>Using the field ID digits <span>in reverse order </span>as the folder structure maximizes sharding of files through multiple folders on the filesystem.</p></td></tr></table><p>Within this folder, images will be named like the uploaded file, suffixed with an underscore and the variation name:</p><ul style="list-style-type: square;"><li>MyImage.png</li><li>MyImage_large.png</li><li>MyImage_rss.png</li></ul><p> </p><p> </p></div>
</div>
<div class="cell aside" data-type="aside">
<div class="innerCell">
<p> </p></div>
</div>
</div>
</div>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=32870081 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 22:03:04 GMT -->
</html>
