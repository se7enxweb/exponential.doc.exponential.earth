                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=30711292 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:59:35 GMT -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage6244.html?pageId=30711292" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/colors82a8.css?spaceKey=TECHDOC" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/custom82a8.css?spaceKey=TECHDOC" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <p><span><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4170.png?definition=e3RvY30&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="683e68be-f175-4685-9c92-aa556a91d587" data-macro-schema-version="1"><br /></span></p><h2><span>Description</span></h2><p><span>A Content item can be translated into several languages. Those languages are configured in the system and exposed in siteaccesses via a prioritized list of languages:</span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="73232a77-be83-491b-be4c-ed3acb0a8567" data-macro-parameters="title=ezplatform.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingfc7c.png?definition=e2NvZGU6dGl0bGU9ZXpwbGF0Zm9ybS55bWx9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>exponential
    system:
        eng:
            languages: [eng-GB]
        # In fre siteaccess, fre-FR is always preferred, and fallback to eng-GB if needed.
        fre:
            languages: [fre-FR, eng-GB]</pre></td></tr></table><p><span><span>When visiting a Content item, it may be useful to let the user switch from one translation to another, more appropriate to them. This is precisely the goal of the language switcher.</span></span></p><p><span><span><span>The language switcher relies on the </span><a class="confluence-link" href="../../display/TECHDOC/Cross-siteaccess%2blinks.html" data-linked-resource-id="30711171" data-linked-resource-version="5" data-linked-resource-type="page" data-linked-resource-default-alias="Cross-siteaccess links" data-base-url="../../index.html">Cross-SiteAccess linking feature</a><span> to generate links to the Content item's translation, and on </span><a class="confluence-link" href="../../display/TECHDOC/RouteReference.html" data-linked-resource-id="30711161" data-linked-resource-version="1" data-linked-resource-type="page" data-linked-resource-default-alias="RouteReference" data-base-url="../../index.html">RouteReference feature</a><span>.<br /><br /></span></span></span></p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="585f88d4-11ca-4a1a-9356-b9f938dcf0da" data-macro-parameters="title=Tip" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading10a5.png?definition=e2luZm86dGl0bGU9VGlwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><span><span><span>If you install the DemoBundle with at least 2 different languages, you will be able to see the Language Switcher and to test it.</span></span></span></p></td></tr></table><p> </p><h2><span><span><span>Usage</span></span></span></h2><h3><span><span><span>Configuration: explicit <em>translation siteaccesses</em></span></span></span></h3><p><span><span><span><span>Configuration is not mandatory, but can help to distinguish which siteaccesses can be considered </span><em>translation siteaccesses</em><span>.</span></span></span></span></p><p> </p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="d1182d67-8ffd-4075-a33b-3717c038d052" data-macro-parameters="title=ezplatform.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingfc7c.png?definition=e2NvZGU6dGl0bGU9ZXpwbGF0Zm9ybS55bWx9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>exponential:
    siteaccess:
        default_siteaccess: eng
        list:
            - ezdemo_site
            - eng
            - fre
            - ezdemo_site_admin

        groups:
            ezdemo_frontend_group:
                - ezdemo_site
                - eng
                - fre

    # ...

    system:
        # Specifying which SiteAccesses are used for translation
        ezdemo_frontend_group:
            translation_siteaccesses: [fre, eng]
        eng:
            languages: [eng-GB]
        fre:
            languages: [fre-FR, eng-GB]
        ezdemo_site:
            languages: [eng-GB]</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="840f73a8-04c8-412d-9afb-ff1bab549d4c" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><strong>Note</strong>: Top prioritized language is always used for as the siteaccess language reference (e.g. <code>fre-FR</code> for <code>fre</code> siteaccess in the example above).</p><p>If several translation siteaccesses share the same language reference, <strong>the first declared siteaccess always wins</strong>.</p></td></tr></table><h3>Configuration: more complex translation setup</h3><p>There are some cases where your siteaccesses share settings (repository, content settings, etc.), but you don't want all of them to share the same <code>translation_siteaccesses</code> setting. This can be the case when you use siteaccesses for mobile.</p><p>Solution is as easy as defining new groups:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="1c00651b-ac1c-40c9-83a8-b1201e6424f7" data-macro-parameters="title=ezplatform.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingfc7c.png?definition=e2NvZGU6dGl0bGU9ZXpwbGF0Zm9ybS55bWx9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>exponential:
    siteaccess:
        default_siteaccess: eng
        list:
            - ezdemo_site
            - eng
            - fre
            - mobile_eng
            - mobile_fre
            - ezdemo_site_admin

        groups:
            # This group can be used for common front settings
            ezdemo_common_group:
                - ezdemo_site
                - eng
                - fre
                - mobile_eng
                - mobile_fre

            ezdemo_frontend_group:
                - ezdemo_site
                - eng
                - fre

            ezdemo_mobile_group
                - mobile_eng
                - mobile_fre

    # ...

    system:
        # Translation SiteAccesses for regular frontend
        ezdemo_frontend_group:
            translation_siteaccesses: [fre, eng]

        # Translation SiteAccesses for mobile frontend
        ezdemo_mobile_group:
            translation_siteaccesses: [mobile_fre, mobile_eng]

        eng:
            languages: [eng-GB]
        fre:
            languages: [fre-FR, eng-GB]
        ezdemo_site:
            languages: [eng-GB]

        mobile_eng:
            languages: [eng-GB]
        mobile_fre:
            languages: [fre-FR, eng-GB]</pre></td></tr></table><h3>Configuration: using implicit <em>related siteaccesses</em></h3><p>If <code>translation_siteaccesses</code> setting is not provided, implicit <em>related siteaccesses</em> will be used instead. Siteaccesses are considered <em>related</em> if they share:</p><ul><li>The same repository</li><li>The same root location Id (see <a class="confluence-link" href="../../display/TECHDOC/Multisite%2busing%2bcontent_root.html" data-linked-resource-id="30711289" data-linked-resource-version="4" data-linked-resource-type="page" data-linked-resource-default-alias="Multisite using content_root" data-base-url="../../index.html">Multisite feature</a>)</li></ul><h3>In a template</h3><p><span>To generate a language switch link, you need to generate the </span><code>RouteReference</code><span>, with the </span><code>language</code><span> parameter. This can easily be done with </span><code>ez_route()</code><span> Twig function:</span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="3d154150-3b49-40e2-a461-32c30b290174" data-macro-parameters="language=xml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingf20b.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{# Given that "location" variable is a valid Location object #}
&lt;a href="{{ url( ez_route( location, {"language": "fre-FR"} ) ) }}">{{ ez_content_name( content ) }}&lt;/a>

{# Generating a link to a declared route instead of Location #}
&lt;a href="{{ url( ez_route( 'my_route', {"language": "fre-FR"} ) ) }}">My link&lt;/a></pre></td></tr></table><p><span><span>You can also omit the route, in this case, the current route will be used (i.e. switch the current page):</span></span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="0d510fce-5862-4528-a1d0-f87802f52a6d" data-macro-parameters="language=xml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingf20b.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{# Using Twig named parameters #}
&lt;a href="{{ url( ez_route( params={"language": "fre-FR"} ) ) }}">My link&lt;/a>

{# Identical to the following, using ordered parameters #}
&lt;a href="{{ url( ez_route( null, {"language": "fre-FR"} ) ) }}">My link&lt;/a></pre></td></tr></table><h3>Using sub-requests</h3><p>When using sub-requests, you lose the context of the master request (e.g. current route, current location, etc.). This is because sub-requests can be displayed separately, with ESI or Hinclude.</p><p>If you want to render language switch links in a sub-request with a correct <code>RouteReference</code>, you must pass it as an argument to your sub-controller from the master request.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="c2b4548b-2c23-4a37-b6f7-6cfca4dc90b6" data-macro-parameters="language=xml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingf20b.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{# Render the language switch links in a sub-controller #}
{{ render( controller( 'AcmeTestBundle:Default:languages', {'routeRef': ez_route()} ) ) }}</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="700a3961-24f9-4d68-82aa-366a2a025935" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>namespace Acme\TestBundle\Controller;

use eZ\Bundle\EzPublishCoreBundle\Controller;
use eZ\Publish\Core\MVC\Symfony\Routing\RouteReference;

class DefaultController extends Controller
{
    public function languagesAction( RouteReference $routeRef )
    {
        return $this->render( 'AcmeTestBundle:Default:languages.html.twig', array( 'routeRef' => $routeRef ) );
    }
}</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="18b1272d-6ae1-4f79-8691-2a1bb511a8c7" data-macro-parameters="language=xml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingf20b.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{# languages.html.twig #}

{# Looping over all available languages to display the links #}
{% for lang in exponential.availableLanguages %}
    {# This time, we alter the "siteaccess" parameter directly. #}
    {# We get the right siteaccess with the help of exponential.translationSiteAccess() helper #}
    {% do routeRef.set( "siteaccess", exponential.translationSiteAccess( lang ) ) %}
    &lt;a href="{{ url( routeRef ) }}">{{ lang }}&lt;/a>&lt;br />
{% endfor %}</pre></td></tr></table><ul><li><code>exponential.translationSiteAccess( language )</code> returns the siteaccess name for provided language (or <code>null</code> if it cannot be found)</li><li><code>exponential.availableLanguages()</code> returns the list of available languages.</li></ul><h3>Using PHP</h3><p><span>You can easily generate language switch links from PHP too, with the </span><code>RouteReferenceGenerator</code><span> service:</span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="901b99b7-f916-41f5-981c-7391bdb0149a" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>// Assuming we're in a controller
/** @var \eZ\Publish\Core\MVC\Symfony\Routing\Generator\RouteReferenceGeneratorInterface $routeRefGenerator */
$routeRefGenerator = $this->get( 'exponential.route_reference.generator' );
$routeRef = $routeRefGenerator->generate( $location, array( 'language' => 'fre-FR' ) );
$link = $this->generateUrl( $routeRef );</pre></td></tr></table><p><span><span><br /></span></span></p><p><span><span>You can also retrieve all available languages with the </span><code>TranslationHelper</code><span>:</span></span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="54f15ddf-dd44-48d9-abfb-c74c43656444" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>/** @var \eZ\Publish\Core\Helper\TranslationHelper $translationHelper */
$translationHelper = $this->get( 'exponential.translation_helper' );
$availableLanguages = $translationHelper->getAvailableLanguages();</pre></td></tr></table><p> </p><p> </p>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=30711292 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:59:35 GMT -->
</html>
