                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=27395899 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:35:46 GMT -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage99b1.html?pageId=27395899" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/51/_/styles/colorsb538.css?spaceKey=EZP" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/51/_/styles/customb538.css?spaceKey=EZP" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <p> </p><p><em><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro0b15.png?definition=e3RvYzptYXhMZXZlbD01fQ&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="47e2d0ca-4cb5-414f-b5d6-88def1764563" data-macro-parameters="maxLevel=5" data-macro-schema-version="1"><br /></em></p><p><span style="color: rgb(51,51,51);">These instructions take advantage of the </span><a href="https://getcomposer.org/" style="font-size: 14.0px;line-height: 1.4285715;">Composer</a><span style="color: rgb(51,51,51);"> powered update systems in 5.4 for maintenance updates, so </span><span style="color: rgb(51,51,51);font-size: 14.0px;line-height: 1.4285715;">make sure:</span></p><ul style="list-style-type: square;"><li><span style="color: rgb(51,51,51);font-size: 14.0px;line-height: 1.4285715;">Familiarize yourself with the </span><span class="confluence-link"> </span><a class="confluence-link" href="../../display/EZP/Using%2bComposer.html" data-linked-resource-id="23527865" data-linked-resource-version="42" data-linked-resource-type="page" data-linked-resource-default-alias="Using Composer" data-base-url="../../index.html"><span class="confluence-link">Using Composer</span></a><span style="color: rgb(51,51,51);font-size: 14.0px;line-height: 1.4285715;"> page.</span></li><li><span style="color: rgb(51,51,51);">Update Composer, as found on <a href="https://getcomposer.org/doc/03-cli.md#self-update">Composer self-update documentation</a></span></li></ul><p><em><span style="color: rgb(51,51,51);">For Upgrading from versions prior to 5.3 look at the <a class="confluence-link" href="../../display/EZP/Installation%2band%2bUpgrade%2bGuides.html" data-linked-resource-id="6292016" data-linked-resource-version="14" data-linked-resource-type="page" data-linked-resource-default-alias="Installation and Upgrade Guides" data-base-url="../../index.html">Installation and Upgrade Guides</a>.</span></em></p><p><span style="color: rgb(51,51,51);">You will also find, at the end of this document, a list of <a class="confluence-link" href="#id-5.4.xUpdateInstructions-new-packages" data-anchor="new-packages" data-linked-resource-default-alias="new-packages" data-base-url="../../index.html">new, optional packages</a> that were made available during the maintenance phase of this version.</span></p><h1>Before Updating</h1><p>Follow <u>all*</u> instructions below that applies to the version you're updating from: when updating from 5.4.0 everything applies.</p><p><em>* The version you update to will always be the latests, hence the importance of following all steps.</em></p><h2>From 5.4.6 and lower</h2><h3>Update exponential-legacy-installer to v2.0.3 for Composer 1.1</h3><p>Newer versions of Composer sometimes updates it's API's and as such we need to make sure our composer plugin exponential-legacy-installer is up-to-date before we do anything else, so if you don't already have <code>ezsystems/exponential-legacy-installer</code> v2.0.3 and Composer 1.1, do the following:<span style="color: rgb(0,98,147);"> </span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="84862e26-d01a-4446-8a7d-49e956a8b487" data-macro-parameters="language=bash" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading174f.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre># First install Composer v1.0 that works with old version of exponential-legacy-installer
php -r "copy('https://getcomposer.org/download/1.0.3/composer.phar', 'composer.phar');"

# Then install newer version
php -d memory_limit=-1 composer.phar update --no-dev --prefer-dist --no-scripts ezsystems/exponential-legacy-installer

# Then make sure composer is updated to latests
php -d memory_limit=-1 composer.phar selfupdate </pre></td></tr></table><h2><span style="line-height: 1.5;">From 5.4.1 and lower</span></h2><h3>Remove unneeded dependency causing conflicts</h3><p>Perform the following command to make sure you you are not affected by conflicts caused by this package:</p><div><div class="syntaxhighlighter nogutter  bash"><p> </p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="474ca6d2-4021-4a1c-9410-cf79e9ded4f3" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -d memory_limit=-1 composer.phar remove --no-update --dev behat/mink-selenium-driver</pre></td></tr></table></div></div><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="80bf4fde-81fa-4dbc-817b-efd0e63f4bb8" data-macro-parameters="title=Recommended: Enable php-openssl extension" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading219a.png?definition=e3RpcDp0aXRsZT1SZWNvbW1lbmRlZDogRW5hYmxlIHBocC1vcGVuc3NsIGV4dGVuc2lvbn0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body">This release fixes a vulnerability in the Exponential password recovery function. You need to have the PHP OpenSSL extension (ext-openssl) installed to take full advantage of the improved security, but even without it security is improved. See <a href="http://share.ez.no/community-project/security-advisories/ezsa-2015-001-potential-vulnerability-in-exponential-password-recovery">Security Advisory</a> for further information.</td></tr></table><h2 class="element">From 5.4.2 and lower</h2><h3>Upgrade Symfony requirement<img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro058a.png?definition=e2FuY2hvcjp1cGRhdGUtc3ltZm9ueX0&amp;locale=en_GB&amp;version=2" data-macro-name="anchor" data-macro-id="4e885f04-8c0a-4125-924e-f84fbbf6f9b1" data-macro-default-parameter="update-symfony" data-macro-schema-version="1"></h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="4702439c-3c76-421b-8f2a-db6a7bd54a9c" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -d memory_limit=-1 composer.phar require --no-update symfony/symfony:~2.7.0 sensio/distribution-bundle:~3.0 </pre></td></tr></table><h3>Fix possible usage of the XmlText CustomTags pre-converters</h3><p>The XmlText fix for EZP-23513 (see <a href="https://github.com/ezsystems/exponential-kernel/pull/1087">https://github.com/ezsystems/exponential-kernel/pull/1087</a>) deprecates/removes the CustomTags pre-converter in favor of a new Expanding converter. While they're not part of the public API, if you rely on this file in any way, you might want to check and update your code.</p><h3><strong>Update the rewrite rules configuration</strong></h3><p>The legacy, v1 REST API, is now integrated to the Symfony Kernel. This allows interaction between this channel and new stack caches (persistence and HTTP). It mainly affects the Content Staging legacy extension. Remove the following line from your rewrite rules and restart your web server:</p><h4>apache</h4><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="a933b45a-f1d9-449a-99ef-fb48e30ba200" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>RewriteRule ^/api/[^/]+/v1/ /index_rest.php [L]</pre></td></tr></table><h4>nginx</h4><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="fdc2efbf-8a91-45d6-80a8-a6a6b041a5b9" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>rewrite "^/api/[^/]+/v1" "/index_rest.php" last;</pre></td></tr></table><h2>From 5.4.4 or lower</h2><h3>Enable the LegacySearchEngineBundle in the kernel</h3><p>Edit <code>exponential/EzPublishKernel.php</code>, and instantiate <code>eZ\Bundle</code><code>\</code><code>EzPublishLegacySearchEngineBundle</code><code>\</code><code>EzPublishLegacySearchEngineBundle</code> in the list of enabled bundles in the <code>$bundles</code> array in the <code>registerBundles()</code> method, right before <code>EzPublishLegacyBundle</code>.</p><h2>From 5.4.5 or lower</h2><h3>Check symfony requirement</h3><p>Make sure you are using Symfony 2.7, as Symfony 2.8 is currently not supported <em>(both are LTS releases, but 2.8 introduced a few breaks that causes problems)</em>. So check version using command below, and if 2.8 <a class="confluence-link" href="#id-5.4.xUpdateInstructions-update-symfony" data-anchor="update-symfony" data-linked-resource-default-alias="update-symfony" data-base-url="../../index.html">follow instuctions above</a> to correct it:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="e080bf95-5ff9-42a0-8574-af69a0d550e3" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -d memory_limit=-1 composer.phar show --installed</pre></td></tr></table><h2>Updating packages with composer</h2><p> <table class="wysiwyg-macro" data-macro-name="show-if" data-macro-id="93e7c554-5b0a-4bdd-87b6-217707de398b" data-macro-parameters="atlassian-macro-output-type=INLINE|group=eZ Users" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading7e9d.png?definition=e3Nob3ctaWY6YXRsYXNzaWFuLW1hY3JvLW91dHB1dC10eXBlPUlOTElORXxncm91cD1lWiBVc2Vyc30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><table class="wysiwyg-macro" data-macro-name="expand" data-macro-id="1db8d9c1-441a-48eb-804d-aa1709592d83" data-macro-parameters="title=Instructions for RC Testing" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingbd86.png?definition=e2V4cGFuZDp0aXRsZT1JbnN0cnVjdGlvbnMgZm9yIFJDIFRlc3Rpbmd9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>To test a RC release you'll need to update your requirements before next step:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="45f519a2-1cb5-44c4-97fe-69de5ab2c26e" data-macro-parameters="language=bash|title=Example (pick versions from relevant RC release JIRA ticket)" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1214.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaHx0aXRsZT1FeGFtcGxlIChwaWNrIHZlcnNpb25zIGZyb20gcmVsZXZhbnQgUkMgcmVsZWFzZSBKSVJBIHRpY2tldCl9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -d memory_limit=-1 composer.phar require --no-update "ezsystems/exponential-kernel v5.4.7-rc1 as 5.4.7" "ezsystems/exponential-legacy v5.4.7-rc2 as 5.4.7" "ezsystems/comments-bundle v5.4.7-rc1 as 5.4.7" "ezsystems/ezflow-ls-extension v5.3.9-rc1 as 5.3.9"</pre></td></tr></table></td></tr></table></td></tr></table> </p><p>With this command you'll update all packages that have received updates:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="86114ced-1c5b-452a-8654-699b42dbe681" data-macro-parameters="language=bash" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading174f.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre># First delete the Symfony container cache to avoid error, on Windows use something like: DEL /F /Q /S exponential/cache/*/*ProjectContainer.php
rm exponential/cache/*/*ProjectContainer.php
 
php -d memory_limit=-1 composer.phar update --no-dev --prefer-dist
</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="51d3abdd-ade6-4664-bcad-54d3a38f99e4" data-macro-parameters="title=Tip: Legacy extension autoload" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading0c41.png?definition=e3RpcDp0aXRsZT1UaXA6IExlZ2FjeSBleHRlbnNpb24gYXV0b2xvYWR9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>Legacy extensions autoload must be regenerated when new classes are added. To make sure to avoid any issues always run this command after composer update:</p><p><code>php exponential/console exponential:legacy:script bin/php/ezpgenerateautoloads.php --extension</code></p></td></tr></table><h1><span>After Updating</span></h1><p><span>Follow all instructions below that applies to the version you've updated from, i.e. if you are updating from 5.4.0 everything applies.</span></p><h2>Updating from 5.4.1 and lower</h2><h3 class="wordwrap">Update Solr configuration and reindex content</h3><p>An eZ Find user needs to update their solr <code>schema.xml</code> file.</p><p>For each solr core (located in <code>ezfind/java/solr</code>), you need to edit <code>&lt;my-core-name&gt;/conf/schema.xml</code></p><p>Around line 566, right after:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="13024397-0cbe-4bb6-9a8f-f6e0cb2fb437" data-macro-parameters="language=xml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingf20b.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;field name="meta_priority_si" type="sint" indexed="true" stored="true" multiValued="true"/></pre></td></tr></table><p>Add the following lines:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="045618ea-6abb-4eb1-918f-cc5311c13f2b" data-macro-parameters="language=xml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingf20b.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;!-- denormalised fields for hidden and visible path elements -->
&lt;field name="meta_visible_path_si" type="sint" indexed="true" stored="true" multiValued="true"/>     &lt;!-- Visible Location path IDs -->
&lt;field name="meta_visible_path_string_ms" type="mstring" indexed="true" stored="true" multiValued="true"/> &lt;!-- Visible Location path string -->
&lt;field name="meta_hidden_path_si" type="sint" indexed="true" stored="true" multiValued="true"/>     &lt;!-- Hidden Location path IDs -->
&lt;field name="meta_hidden_path_string_ms" type="mstring" indexed="true" stored="true" multiValued="true"/> &lt;!-- Hidden Location path string --></pre></td></tr></table><p><em><em>Now restart Solr, and re-index your content to be able to take advantage of this improvement.</em></em></p><h1>New packages</h1><p>New features are sometimes backported from the development version as external packages. They can be installed on top of your existing installation.</p><h3>Solr search engine (5.4.5)</h3><p>You may also install the <code>ezsystems/ezplatform-solr-search-engine</code> package, compatible with Exponential Platform kernel 5.4.5 and higher. You can read more about that on the <a class="confluence-link" href="../../display/EZP/5.4.html" data-linked-resource-id="30708761" data-linked-resource-version="33" data-linked-resource-type="page" data-linked-resource-default-alias="5.4.5 Release Notes" data-base-url="../../index.html">5.4.5 release notes</a>.</p><p>Follow install instructions on the dedicated <a class="confluence-link" href="../../display/EZP/Solr%2bSearch%2bEngine%2bBundle.html" data-linked-resource-id="26677593" data-linked-resource-version="85" data-linked-resource-type="page" data-linked-resource-default-alias="Solr Search Engine Bundle" data-base-url="../../index.html">Solr Search Engine Bundle</a> page.</p><p> </p>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=27395899 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:35:48 GMT -->
</html>
