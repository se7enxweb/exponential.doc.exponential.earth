                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31431588 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:26:22 GMT -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage8e52.html?pageId=31431588" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/colors74cd.css?spaceKey=DEVELOPER" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/custom74cd.css?spaceKey=DEVELOPER" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <div class="contentLayout2">
<div class="columnLayout two-right-sidebar" data-layout="two-right-sidebar">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p>Keeping your system up-to-date is important to make sure it is running optimally and securely. The update mechanism in eZ software is using the <em style="line-height: 1.42857;">de facto</em> standard PHP packaging system called <a href="https://getcomposer.org/" style="line-height: 1.42857;">Composer</a>. </p><p>This makes it easy to adapt package installs and updates to your workflow, allowing you to test new/updated packages in a development environment, place the changes in your version control system (git, Subversion, Mercurial, etc.), pull in those changes to a staging environment and, when approved, put them in production.</p><p> </p><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4170.png?definition=e3RvY30&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="12ac574d-ccf5-4253-af0d-4f09fe033a79" data-macro-schema-version="1"></p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="cf3f87ff-1789-46e9-8e2c-60250d07b3a6" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><a class="external-link" href="https://getcomposer.org/" rel="nofollow">Composer</a> is an opensource PHP packaging system to manage dependencies.</p><p>This makes it easy to adapt package installs and updates to your workflow, allowing you to test new/updated packages in a development environment, put the changes in your version control system (git, Subversion, Mercurial, etc.), pull in those changes on a staging environment and, when approved, put it in production.</p></td></tr></table><h1>Installing Composer</h1><p>Composer is a command-line tool, so the main way to install it is via command line from inside the root directory of the (eZ) software:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="facb0659-cb09-431c-8344-7c2e2954badf" data-macro-parameters="language=bash|title=Composer download in current folder:" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading82f4.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaHx0aXRsZT1Db21wb3NlciBkb3dubG9hZCBpbiBjdXJyZW50IGZvbGRlcjp9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -r "readfile('https://getcomposer.org/installer');" | php</pre></td></tr></table><p>By doing it this way you will need to execute further Composer commands using <code>php composer.phar</code>. If you'd rather prefer to install Composer globally on your machine instead of inside each and every project that uses it, then follow <a href="https://getcomposer.org/doc/00-intro.md#globally">these instructions in online Composer documentation</a>.</p><h1>Prerequisite to using composer with eZ Enterprise software</h1><table class="wysiwyg-macro" data-macro-name="panel" data-macro-id="cc9a0312-8421-451e-92de-365bd733df3c" data-macro-parameters="bgColor=#f58220|titleBGColor=#f0f0f0" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdbfd.png?definition=e3BhbmVsOmJnQ29sb3I9I2Y1ODIyMHx0aXRsZUJHQ29sb3I9I2YwZjBmMH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><strong>This section describes features available only in eZ Enterprise.</strong></p></td></tr></table><h3>Setting up Authentication tokens for access to commercial updates</h3><p>Out of the box Composer uses a packaging repository called <a href="https://packagist.org/">packagist.org</a> to find all open-source packages and their updates. Additional commercial packages are available for eZ Enterprise subscribers at <a href="https://updates.ez.no/bul/">updates.ez.no/bul/</a> <em>(which is password-protected, you will need to set up authentication tokens as described below to get access)</em>.</p><p>To get access to these updates log in to your service portal on <a href="https://support.ez.no/">support.ez.no</a> and look for the following on the <em>&quot;Maintenance and Support agreement details&quot;</em> screen:</p><p><img class="confluence-embedded-image" height="164" width="946" confluence-query-params="effects=drop-shadow" src="../../download/attachments/31431588/Screen%20Shot%202014-06-02%20at%2012.54.06%205a15.jpg?version=1&amp;modificationDate=1462367661000&amp;api=v2&amp;effects=drop-shadow" data-image-src="/download/attachments/31431588/Screen%20Shot%202014-06-02%20at%2012.54.06%20.png?version=1&amp;modificationDate=1462367661000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="31431587" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen Shot 2014-06-02 at 12.54.06 .png" data-base-url="https://doc.ez.no" data-linked-resource-content-type="image/png" data-linked-resource-container-id="31431588" data-linked-resource-container-version="7" title="Developer > Using Composer > Screen Shot 2014-06-02 at 12.54.06 .png" data-location="Developer > Using Composer > Screen Shot 2014-06-02 at 12.54.06 .png" data-image-height="164" data-image-width="946"></p><ol><li>Click &quot;Create token&quot; (This requires the &quot;Portal administrator&quot; access level.)</li><li>Fill in a label describing the use of the token. This will allow you to revoke access later.<br /><ul><li>Example, if you need to provide access to updates to a third party, a good example would be &quot;53-upgrade-project-by-partner-x&quot;</li></ul></li><li>Copy the password, <strong>you will not get access to it again</strong>!</li></ol><p>After this, when running Composer to get updates as described below, you will be asked for a Username and Password. Use:</p><ul><li>as Username – your <span>Installation key found above on the <em>&quot;Maintenance and Support agreement details&quot;</em> page in the service portal</span></li><li><span>as Password – the token password you retrieved in step 3.</span></li></ul><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="59c17a60-28bd-4255-8d65-5aa58415cf31" data-macro-parameters="title=Support agreement expiry" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingad6c.png?definition=e2luZm86dGl0bGU9U3VwcG9ydCBhZ3JlZW1lbnQgZXhwaXJ5fQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>If your Support agreement expires, your authentication token(s) will no longer work. They will become active again if the agreement is renewed, but this process may take up to 24 hours. (If the agreement is renewed before the expiry date, there will be no disruption of service.)</p></td></tr></table><p><span><br /></span></p><h4>Optional: Save authentication information in auth.json to avoid repeatedly typing it</h4><p>Composer will ask to do this for you on updates, however if it is disabled, you can create an <code>auth.json</code> file manually in one of the following ways:</p><p><em>Option A: </em>Store your credentials in the project directory:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="a7913b1d-e762-4b2f-955b-8c29e37e56f3" data-macro-parameters="language=bash" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading174f.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>composer config http-basic.updates.ez.no &lt;installation-key> &lt;token-password></pre></td></tr></table><p><em>Option B:</em> If you'd rather want to install it globally in <a href="https://getcomposer.org/doc/03-cli.md#composer-home">COMPOSER_HOME</a> directory for machine-wide use:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="976464c6-c60e-4030-98a7-46a099af1dd1" data-macro-parameters="language=bash" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading174f.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>composer config --global http-basic.updates.ez.no &lt;installation-key> &lt;token-password></pre></td></tr></table><h1>Update workflow Using Composer</h1><p>This section describes the best practice for using Composer, essentially it suggests treating updates like other code/configuration/* changes on your project, tackling them on a development machine before staging them for rollout on staging/production.  </p><h3>1. Running composer update and version changes in development</h3><p>Updating eZ software via Composer is nothing different then <a href="https://getcomposer.org/doc/03-cli.md#update">updating other projects via Composer</a>, but for illustration here is how you update your project locally:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="3d85e2b6-fcd7-47ab-9822-f1a1db9e9a30" data-macro-parameters="language=bash|title=composer update" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingfe05.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaHx0aXRsZT1jb21wb3NlciB1cGRhdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -d memory_limit=-1 composer.phar update --no-dev --prefer-dist</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="53219a93-c439-4177-9ece-58815bb06fb6" data-macro-parameters="title=Tip" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading6668.png?definition=e3RpcDp0aXRsZT1UaXB9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>This will load in all updated packages, from eZ as well as third-party libraries, both used by eZ and other you may have added. When updating like this it is recommended to take note of what was updated so you have an idea of what you should test before putting the updates into production.</p></td></tr></table><p>At this stage you might need to manually clear Symfony's <code>prod</code> environment class cache (cached interfaces and lazy services) in case the classes/interfaces in it have changed. This can be done in the following way:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="c89e30ed-2368-4678-8a11-37a5985a23a8" data-macro-parameters="language=bash|title=Optional prod class cache clearing" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading24c2.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaHx0aXRsZT1PcHRpb25hbCBwcm9kIGNsYXNzIGNhY2hlIGNsZWFyaW5nfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>rm -f app/cache/prod/*.php</pre></td></tr></table><p>When the update has completed and local install is verified to work, make sure to version changes done to the <code>composer.lock</code> file (if you use a version control system like <em>git</em>). This file contains <strong>all details of which versions are currently used</strong> and makes sure the same version is used among all developers, staging and eventually production when current changes are approved for production (assuming you have a workflow for this).</p><p> </p><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="8550c749-ae78-4e15-9965-6f0d1db218f5" data-macro-parameters="title=Tip" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading6668.png?definition=e3RpcDp0aXRsZT1UaXB9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>In large development teams make sure people don't blindly update and install third party components. This might easily lead to version conflicts on <code>composer.lock</code> and can be tiring to fix up if happening frequently. A workflow involving composer install and unit test execution on proposed changes can help avoid most of this, like the Pull Request workflow available via Github/Bitbucket.</p></td></tr></table><h3>2. Installing versioned updates on other development machines and/or staging -&gt; production</h3><p>Installing eZ software packages via Composer is nothing different then <a href="https://getcomposer.org/doc/03-cli.md#install">installing vanilla packages via Composer</a>, and for illustration here is how you install versioned updates:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="7369a54b-5ab6-404c-a47f-f31c80bf87df" data-macro-parameters="title=composer install (package installation)" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading5efd.png?definition=e2NvZGU6dGl0bGU9Y29tcG9zZXIgaW5zdGFsbCAocGFja2FnZSBpbnN0YWxsYXRpb24pfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -d memory_limit=-1 composer.phar install --no-dev --prefer-dist</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="c5b77d1e-8a33-4cea-a78b-fd5d385965c5" data-macro-parameters="title=Tip" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading6668.png?definition=e3RpcDp0aXRsZT1UaXB9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body">Here the importance of <code>composer.lock</code> comes in, as this command will tell Composer to install packages in exactly the same version as defined in this file. If you don't keep track of <code>composer.lock</code>, it will instead just install always the latest version of a package and won't allow you to stage updates before moving towards production.</td></tr></table><h1>General notes on use of Composer</h1><h2>Installing additional packages via Composer</h2><p>Requiring eZ software packages via Composer is also done in same way as <a href="https://getcomposer.org/doc/03-cli.md#require">requiring vanilla packages via Composer</a>, and for illustration here is how you install the community-developed <a href="https://github.com/ezcommunity/EzPriceBundle">EzPriceBundle</a>:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="eda9265d-3a3f-40e3-b934-d56453870b00" data-macro-parameters="title=composer install (package installation)" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading5efd.png?definition=e2NvZGU6dGl0bGU9Y29tcG9zZXIgaW5zdGFsbCAocGFja2FnZSBpbnN0YWxsYXRpb24pfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php -d memory_limit=-1 composer.phar require --prefer-dist ezcommunity/ez-price-bundle:~1.0.0@beta</pre></td></tr></table><h2>Dumping autoload for better performance</h2><p>For PHP 5.6 and up you'll get a notable performance improvement by making composer dump optimized autoload array, this can be done on composer install and update, but also using:</p><p><code>php -d memory_limit=-1 composer.phar dump-autoload --optimize</code></p><h2>Best practice for Bundles</h2><p>Best practice for Bundles is described in Symfony documentation under <a href="http://symfony.com/doc/current/cookbook/bundles/best_practices.html">Best Practices for Reusable Bundles</a>, with eZ bundles there is some notable exceptions:</p><h5>Documentation</h5><ul><li>You may write your documentation using markdown (.md) if you prefer, however .rst is recommended if you plan to use <a href="http://writethedocs.org/">writethedocs.org</a>, as heavily used by many open source projects.</li></ul><h5>Git repository naming</h5><ul><li>You may omit vendor name in repository naming, assuming vendor name is reflected in organization / user account it is attached to.</li><li>You may also choose to follow composer package naming on repository name which is more relevant when trying to find a given package later.</li></ul><h5>Composer Metadata</h5><ul><li style="list-style-type: none;">For defining <code>&quot;type&quot;</code>, the following are at the moment known valid values:<ul><li><span style="color: rgb(0,128,0);"><code>ezplatform-bundle</code><span style="color: rgb(128,128,128);"> | Symfony bundles that uses eZ Platform features</span></span></li><li><code><span style="color: rgb(0,128,0);">ezstudio-bundle</span></code><span><span style="color: rgb(128,128,128);"> | </span><span><span style="color: rgb(128,128,128);">Symfony bundles that uses eZ Platform Enterprise Edition features<em> <br /></em></span></span></span></li><li><span style="color: rgb(0,128,0);"><code>symfony-bundle</code><span style="color: rgb(128,128,128);"> | Standard symfony bundles as described in Symfony doc.</span></span></li></ul></li><li>For Exponential (legacy) and Exponential Platform there where also:<ul><li><span style="color: rgb(0,128,0);"><code>exponential-legacy-extension</code><span style="color: rgb(128,128,128);"> | For standalone 4.x (legacy) extensions, to be used with <a href="https://github.com/ezsystems/exponential-legacy-installer">exponential-legacy-installer</a></span></span></li><li><code><span style="color: rgb(0,128,0);">exponential-bundle<span style="color: rgb(128,128,128);"> | For Exponential Platform 5.x bundles, may optionally be a <a class="confluence-link" href="../../display/EZP/Legacy%2bcode%2band%2bfeatures.html" data-linked-resource-id="8323433" data-linked-resource-version="38" data-linked-resource-type="page" data-linked-resource-default-alias="Legacy code and features" data-base-url="../../index.html">&quot;legacy bundle&quot;</a>.</span></span></code></li></ul></li></ul></div>
</div>
<div class="cell aside" data-type="aside">
<div class="innerCell">
<p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4170.png?definition=e3RvY30&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="0f9753b3-5073-4f5a-a6bd-20f104faad33" data-macro-schema-version="1"></p></div>
</div>
</div>
</div>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31431588 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:26:22 GMT -->
</html>
