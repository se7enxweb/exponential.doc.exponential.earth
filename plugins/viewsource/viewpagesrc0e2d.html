                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=12125307 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 13:28:39 GMT -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage0e2d.html?pageId=12125307" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/16/_/styles/colors556c.css?spaceKey=EZP51" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/16/_/styles/custom556c.css?spaceKey=EZP51" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <table class="wysiwyg-macro" data-macro-name="note" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The following does not apply to siteaccesses configured with <code>legacy_mode: true</code></p></td></tr></table><p> </p><p>When the standard view provider is not able to select an appropriate template for a given content, <strong>the system fallbacks to the legacy kernel and delegates the view selection to it</strong>. <span style="font-size: 10.0pt;line-height: 13.0pt;">This ensures that a content is always displayed and hence eases project migration from Exponential v4.x to v5.x</span></p><p><span style="font-size: 10.0pt;line-height: 13.0pt;"><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4170.png?definition=e3RvY30&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-schema-version="1"><br /></span></p><h2>Pagelayout and main block</h2><p>When falling back to the legacy kernel, <strong>the old <code>content/view</code> module is run</strong> to return the appropriate view for the given content. However, the pagelayout is not rendered as it needs to be still rendered by Twig in the Symfony part, for consistency. In this regard, the system uses the <strong>Decorator design pattern</strong> to include the generated view in your layout.</p><p>For this to work, you need to configure 2 things :</p><ol><li>Which template you want to use as a base template for legacy fallback</li><li>The name of the block to use in your layout</li></ol><h3>Base layout for legacy fallback</h3><p>You can configure this by setting the <code><strong>exponential_legacy.&lt;siteaccess_or_siteaccess_group&gt;.view_default_layout</strong></code> config key.</p><p><strong>Example:</strong></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=exponential/config/exponential.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingee5e.png?definition=e2NvZGU6dGl0bGU9ZXpwdWJsaXNoL2NvbmZpZy9lenB1Ymxpc2gueW1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>parameters:
    # Exponential 5.1+ only
    exponential_legacy.my_siteaccess.view_default_layout: AcmeDemoBundle::my_layout.html.twig</pre></td></tr></table><h3>Block name</h3><p>Internally when rendering the view coming from the legacy kernel, a Twig template is created on the fly. This template extends the pagelayout you configured and includes the content inside a block. The name of this block is configurable as well (default is <code><strong>content</strong></code>).</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=exponential/config/exponential.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingee5e.png?definition=e2NvZGU6dGl0bGU9ZXpwdWJsaXNoL2NvbmZpZy9lenB1Ymxpc2gueW1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>parameters:
    exponential_legacy.&lt;siteaccess_or_siteaccess_group>.view_default_layout: AcmeDemoBundle::my_layout.html.twig
    exponential.content_view.content_block_name: content</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=my_layout.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd617.png?definition=e2NvZGU6dGl0bGU9bXlfbGF5b3V0Lmh0bWwudHdpZ30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;!DOCTYPE html>
&lt;html>
&lt;head>
    &lt;!-- ... -->
&lt;/head>
&lt;body>
    {% block content %}{# Content will be inserted here #}{% endblock %}
&lt;/body>
&lt;/html></pre></td></tr></table><p> </p><h3>Module layout</h3><table class="wysiwyg-macro" data-macro-name="info" data-macro-parameters="title=Version compatibility" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading02d5.png?definition=e2luZm86dGl0bGU9VmVyc2lvbiBjb21wYXRpYmlsaXR5fQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The module layout setting is available from Exponential 5.1.</p></td></tr></table><p><span style="font-size: 10.0pt;line-height: 13.0pt;">The module layout can also be defined the same way as the base layout, by setting the </span><code style="font-size: 10.0pt;line-height: 13.0pt;"><strong>exponential_legacy.&lt;scope&gt;.module_default_layout</strong></code><span style="font-size: 10.0pt;line-height: 13.0pt;"> config key. This layout is used to handle &quot;non content&quot; related legacy requests.</span></p><h4>Displaying legacy module result</h4><p>This makes your base layout reusable. However, content generated by legacy modules (i.e. <code>/ezinfo/about</code>) will not be automatically inserted as your layout will be rendered as a regular template, receiving <code>module_result</code> variable coming from the legacy kernel. The solution is to use 2 different templates, one for the global layout, and another for legacy module rendering:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=AcmeDemoBundle::layout.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading5b26.png?definition=e2NvZGU6dGl0bGU9QWNtZURlbW9CdW5kbGU6OmxheW91dC5odG1sLnR3aWd9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;!DOCTYPE html>
&lt;html>
&lt;head>
    &lt;!-- Insert everything you need here that is common -->
&lt;/head>
&lt;body>
    {% block content %}{# Regular content will be inserted here #}{% endblock %}
&lt;/body>
&lt;/html></pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=AcmeDemoBundle::layout_legacy.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingaa33.png?definition=e2NvZGU6dGl0bGU9QWNtZURlbW9CdW5kbGU6OmxheW91dF9sZWdhY3kuaHRtbC50d2lnfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{% extends "AcmeDemoBundle::layout.html.twig" %}
 
{% block content %}
    {# module_result variable is received from the legacy controller. #}
    {# It holds the legacy module result #}
    {{ module_result.content|raw }}
{% endblock %}</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=exponential/config/exponential.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingee5e.png?definition=e2NvZGU6dGl0bGU9ZXpwdWJsaXNoL2NvbmZpZy9lenB1Ymxpc2gueW1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>parameters:
    exponential_legacy.my_siteaccess.module_default_layout: AcmeDemoBundle::layout_legacy.html.twig
    exponential_legacy.my_siteaccess.view_default_layout: AcmeDemoBundle::layout.html.twig</pre></td></tr></table><p> </p><h2>Persistent variable</h2><p>The persistent variable is a special variable in legacy templates that you can set in order to pass values from the content template to the pagelayout. This variable, among others, is accessible from the configured Twig pagelayout thanks to the helper <code><strong>exponential.legacy</strong></code>.</p><p>Actually, all data <a href="../../Exponential/Technical-manual/4.x/Templates/The-pagelayout/Variables-in-pagelayout.html#module_result">contained in <code>$module_result</code> in the legacy kernel</a> is exposed.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=Access to the persistent variable" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading2723.png?definition=e2NvZGU6dGl0bGU9QWNjZXNzIHRvIHRoZSBwZXJzaXN0ZW50IHZhcmlhYmxlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;!DOCTYPE html>
&lt;html>
&lt;head>
    &lt;!-- ... -->
    {% if exponential.legacy.has( 'content_info' ) %}
        {% set persistent_variable = exponential.legacy.get( 'content_info' )['persistent_variable'] %}
    {% endif %}
&lt;/head>
&lt;body>
    {% block content %}{# Content will be inserted here #}{% endblock %}
&lt;/body>
&lt;/html></pre></td></tr></table><h2>Assets</h2><p>Like the persistent variable, it is possible to require css and/or javascripts assets from a content template through the legacy <code>ezscript_require()</code> and <code>ezcss_require()</code> template operators.</p><p>You can easily retrieve those requested assets from the legacy template in the Twig pagelayout with the <code><strong>exponential.legacy</strong></code> helper.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=Getting assets requested from a legacy template" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingc804.png?definition=e2NvZGU6dGl0bGU9R2V0dGluZyBhc3NldHMgcmVxdWVzdGVkIGZyb20gYSBsZWdhY3kgdGVtcGxhdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;!DOCTYPE html>
&lt;html>
&lt;head>
    &lt;!-- ... -->
    {% set requested_css_files = exponential.legacy.get( 'css_files' ) %}
    {% set requested_js_files = exponential.legacy.get( 'js_files' ) %}
 
    {# "configured" assets are the ones defined in design.ini (FrontendCSSFileList/FrontendJavaScriptList) #}
    {% set configured_js_files = exponential.legacy.get( 'js_files_configured' ) %}
    {% set configured_css_files = exponential.legacy.get( 'css_files_configured' ) %}
&lt;/head>
&lt;body>
    {% block content %}{# Content will be inserted here #}{% endblock %}
&lt;/body>
&lt;/html></pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="note" data-macro-parameters="title=Assetic incompatibility" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingb749.png?definition=e25vdGU6dGl0bGU9QXNzZXRpYyBpbmNvbXBhdGliaWxpdHl9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><strong>Warning:</strong> If you use Assetic to combine and/or compress your assets, please note that <a href="http://symfony.com/doc/current/cookbook/assetic/asset_management.html#assets"><code>javascripts</code> and <code>stylesheets</code> Twig tags</a> currently don't support variable file lists, so you won't be able to use them with the example above.</p></td></tr></table>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=12125307 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 13:28:40 GMT -->
</html>
