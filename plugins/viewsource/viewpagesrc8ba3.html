                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=12780448 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 19:28:16 GMT -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage8ba3.html?pageId=12780448" />
        <link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch934e.css?media=print" media="print">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 8]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+8" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1f2a9c4c7f2593422cc9b02d1a652a22/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/26ac2724af3c6ece1051365650d982fa/_/download/contextbatch/css/editor-content/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-hig/com.atlassian.confluence.plugins.confluence-highlight-ac" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/12/_/styles/colors.css" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4170.png?definition=e3RvY30&amp;locale=en_GB&amp;version=2" data-macro-name="toc"></p><h2>Description</h2><p><span>With the Page FieldType, editors define a <strong>layout</strong> with <strong>multiple zones</strong> within a single front page. </span></p><p><span>Within each zone, editors create <strong>blocks</strong> that contain particular content categories. Specific content can be added to these blocks, they are called <strong>block items</strong>.</span></p><p>This is particularly useful for managing homepages/landing pages.</p><table class="wysiwyg-macro" data-macro-name="note" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The Page FieldType is currently <strong>read-only</strong> with the Public API.<br />It's however still possible to edit content with it through the admin interface (which runs through the legacy stack). </p></td></tr></table><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Internal name</th><th colspan="1" class="confluenceTh">Expected input</th><th colspan="1" class="confluenceTh">Output</th></tr><tr><td class="confluenceTd"><code>Page</code></td><td class="confluenceTd"><code>ezpage</code></td><td colspan="1" class="confluenceTd"><code>N/A</code></td><td colspan="1" class="confluenceTd"><code><span>eZ\Publish\Core\FieldType\Page\Parts\Page</span> </code></td></tr></tbody></table><h2>Configuration</h2><h3>Defining a zone layout</h3><p><span>A layout is a combination of zones that are placed on a page. The placement of the zones is defined in a template that is specified as part of the layout configuration. You can define as many layouts as you need.</span></p><p>You can define a new layout in your main YAML configuration:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=exponential.yml" style="background-image: url(../servlet/confluence/placeholder/macro-heading8bc7.png?definition=e2NvZGU6dGl0bGU9ZXpwdWJsaXNoLnltbH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>exponential:
    system:
        my_siteaccess:
            layouts:
                ezpage:
                    myLayoutIdentifier:
                        name: My über cool layout
                        template: AcmeDemoBundle:page/zonelayouts/my_template.html.twig</pre></td></tr></table><p>Then, when rendering a Page FieldType using myLayoutIdentifier, <code>page/zonelayouts/my_template.html.twig</code> from AcmeDemoBundle will be used.</p><table class="wysiwyg-macro" data-macro-name="warning" data-macro-parameters="title=Warning" style="background-image: url(../servlet/confluence/placeholder/macro-heading340d.png?definition=e3dhcm5pbmc6dGl0bGU9V2FybmluZ30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>You still need to define your available layouts in the legacy part to get them available in the admin interface. Please refer to <a href="../../Extensions/Exponential-extensions/eZ-Flow/eZ-Flow-2.5/Configuration/Configuring-the-eZ-Flow-block-system/Defining-the-eZ-Flow-blocks/Defining-page-layouts.html">Exponential legacy documentation</a> to learn how to do so.</p></td></tr></table><table class="wysiwyg-macro" data-macro-name="tip" data-macro-parameters="title=Tip" style="background-image: url(../servlet/confluence/placeholder/macro-heading6668.png?definition=e3RpcDp0aXRsZT1UaXB9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>You can specify a legacy template in your layout definition.</p><table class="wysiwyg-macro" data-macro-name="code" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>exponential:
    system:
        my_siteaccess:
            ezpage:
                myLegacyLayout:
                    name: My legacy layout
                    template: "design:zone/my_legacy_template.tpl"</pre></td></tr></table><p><span style="font-size: 10.0pt;line-height: 13.0pt;">However, doing so will defer block display to the legacy templates as well.</span></p></td></tr></table><p><span style="color: rgb(0,0,0);font-size: 1.4em;font-weight: bold;line-height: normal;">Block template selection</span></p><p>Like you are able to <a class="confluence-link" href="../../display/EZP51/View%2bprovider%2bconfiguration.html" data-linked-resource-id="12125305" data-linked-resource-type="page" data-linked-resource-default-alias="View provider configuration" data-base-url="../../index.html">define template selection rules when displaying Location and Content objects</a>, you can also define rules for blocks, with dedicated matchers.</p><h2>Displaying the Page content</h2><h3>Layout template</h3><p>Goal of a <strong>layout</strong> template is to display <strong>zones</strong> for the given layout, depending on your layout configuration.</p><h4>Variables passed to the layout template</h4><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Variable name</th><th class="confluenceTh">Description</th><th class="confluenceTh">Type</th></tr><tr><td class="confluenceTd"><code>zones</code></td><td class="confluenceTd">Zone objects for this Page field</td><td class="confluenceTd">Array of <code>eZ\Publish\Core\FieldType\Page\Parts\Zone</code> objects</td></tr><tr><td colspan="1" class="confluenceTd"><code>zone_layout</code></td><td colspan="1" class="confluenceTd">The layout identifier (e.g. &quot;2ZonesLayout1&quot;)</td><td colspan="1" class="confluenceTd"><code>string</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>pageService</code></td><td colspan="1" class="confluenceTd"><p>The PageService object (read more below). </p></td><td colspan="1" class="confluenceTd"><code>eZ\Bundle\EzPublishCoreBundle\FieldType\Page</code></td></tr></tbody></table><h3>Rendering blocks</h3><p>TODO</p><table class="wysiwyg-macro" data-macro-name="tip" data-macro-parameters="title=Tip" style="background-image: url(../servlet/confluence/placeholder/macro-heading6668.png?definition=e3RpcDp0aXRsZT1UaXB9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>You can use a custom controller to display a block</p></td></tr></table><p> </p><h3>Example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=html/xml|title=2zoneslayout1.html.twig" style="background-image: url(../servlet/confluence/placeholder/macro-headingf83c.png?definition=e2NvZGU6dGl0bGU9MnpvbmVzbGF5b3V0MS5odG1sLnR3aWd8bGFuZ3VhZ2U9aHRtbC94bWx9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;h2>TWIG Template for 2zoneslayout1 zone&lt;/h2>
&lt;div class="zone-layout-{{ zone_layout|lower }} row">
    &lt;div class="span8">
        &lt;section class="content-view-block">
        {% if zones[0].blocks %}
            {# Rendering blocks with default PageController #}
            {% for block in zones[0].blocks %}
                {{ render( controller( "ez_page:viewBlock", {'block': block} ) ) }}
            {% endfor %}
            &lt;div class="block-separator">&lt;/div>
        {% endif %}
        &lt;/section>
    &lt;/div>
    &lt;div class="span4">
        &lt;aside>
            &lt;section class="content-view-block content-view-aside">
            {% if zones[1].blocks %}
                {# Still rendering with default PageController, but passing specific cache value (TTL of 100 seconds) and using ESI #}
                {% for block in zones[1].blocks %}
                    {{ render_esi( controller( "ez_page:viewBlock", {'block': block, 'cacheSettings': {'smax-age': 100}} ) ) }}
                {% endfor %}
                &lt;div class="block-separator">&lt;/div>
            {% endif %}
            &lt;/section>
        &lt;/aside>
    &lt;/div>
&lt;/div></pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=html/xml|title=campaign_block.html.twig" style="background-image: url(../servlet/confluence/placeholder/macro-heading3e44.png?definition=e2NvZGU6dGl0bGU9Y2FtcGFpZ25fYmxvY2suaHRtbC50d2lnfGxhbmd1YWdlPWh0bWwveG1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;h3>TWIG Template for Campaign block type&lt;/h3>
{% set validContentInfoItems = pageService.getValidBlockItemsAsContentInfo( block ) %}
{% set validItems = pageService.getValidBlockItems( block ) %}
&lt;!-- BLOCK: START -->
&lt;div class="block-type-campaign">
    &lt;div class="campaign">
        &lt;a href="#" class="navig prev" style="opacity:0;">&lt;span class="hide">&amp;lt;&lt;/span>&lt;/a>
        &lt;a href="#" class="navig next">&lt;span class="hide">&amp;gt;&lt;/span>&lt;/a>
        &lt;ul class="indicator">
            {% for contentInfo in validContentInfoItems %}
                &lt;li>&lt;span>{{ contentInfo.name }} (#{{ contentInfo.id }})&lt;/span>&lt;/li>
            {% endfor %}
        &lt;/ul>
        &lt;ul class="images">
        {# Rendering valid items with regular view controller, with "block_item_campaign" view type #}
        {# Also passing an "image_class" parameter which will be available in sub-template. #}
        {% for item in validItems %}
            {{ render(
                controller(
                    'ez_content:viewLocation',
                    {
                        'locationId': item.locationId,
                        'viewType': 'block_item_campaign',
                        'params': {'image_class': 'campaign'}
                    }
                )
            ) }}
        {% endfor %}
        &lt;/ul>
    &lt;/div>
&lt;/div>
&lt;!-- BLOCK: END --></pre></td></tr></table><p> </p><h2>The PageService object</h2><p>The PageService object (<code>eZ\Bundle\EzPublishCoreBundle\FieldType\Page\PageService</code>) is a helper giving the possibility to get current zone/block definitions and to retrieve block items.</p><h3>Main methods</h3><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Method name</th><th class="confluenceTh">Description</th><th class="confluenceTh">Return type</th></tr><tr><td class="confluenceTd"><code>getZoneDefinition()</code></td><td class="confluenceTd">Returns zone definition (all defined zones for the current siteaccess) as an array</td><td class="confluenceTd"><code>array</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getZoneDefinitionByLayout()</code></td><td colspan="1" class="confluenceTd">Returns a zone definition for a given layout. It consists of a configuration array for the given layout.</td><td colspan="1" class="confluenceTd"><code>array</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getBlockDefinition()</code></td><td colspan="1" class="confluenceTd">Returns block definition as an array</td><td colspan="1" class="confluenceTd"><code>array</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getBlockDefinitionByIdentifier()</code></td><td colspan="1" class="confluenceTd">Returns a block definition for a given block identifier.</td><td colspan="1" class="confluenceTd"><code>array</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getValidBlockItems()</code></td><td colspan="1" class="confluenceTd">Returns valid items (that are to be displayed), for a given block.</td><td colspan="1" class="confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Item[]</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getLastValidBlockItem()</code></td><td colspan="1" class="confluenceTd">Returns the last valid item, for a given block.</td><td colspan="1" class="confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Item|null</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getWaitingBlockItems()</code></td><td colspan="1" class="confluenceTd">Returns queued items (the next to be displayed), for a given block.</td><td colspan="1" class="confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Item[]</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getArchivedBlockItems()</code></td><td colspan="1" class="confluenceTd">Returns archived items (that were previously displayed), for a given block.</td><td colspan="1" class="confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Item[]</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getValidBlockItemsAsContentInfo()</code></td><td colspan="1" class="confluenceTd">Returns valid block items as content objects</td><td colspan="1" class="confluenceTd"><code>eZ\Publish\API\Repository\Values\Content\ContentInfo[]</code></td></tr></tbody></table><p> </p><p> </p>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=12780448 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 19:28:16 GMT -->
</html>
