<!DOCTYPE html>
<html>

<!-- Mirrored from doc.ez.no/pages/diffpagesbyversion.action?pageId=2719880&originalVersion=22&revisedVersion=38 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 18:34:59 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <title>Page Comparison - Field Type API and best practices (v.22 vs v.38) - Exponential Platform 5.x - eZ Documentation</title>

        

                        
    
                        
    
                        
    

    <meta http-equiv="X-UA-Compatible" content="IE=EDGE,chrome=IE7">
<meta charset="UTF-8">
<meta id="confluence-context-path" name="confluence-context-path" content="">
<meta id="confluence-base-url" name="confluence-base-url" content="../index.html">

<meta id="atlassian-token" name="atlassian-token" content="494111f00e28ced96046bfb6fbe8f75e18d44b71">

<meta id="confluence-space-key" name="confluence-space-key" content="EZP">
<script type="text/javascript">
        var contextPath = '';
</script>

    

<!-- include system css resources -->


    <link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch934e.css?media=print" media="print">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 8]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+8" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/f10c36425b731f08af1bde9c7e745307/_/download/contextbatch/css/pagediffs/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/f10c36425b731f08af1bde9c7e745307/_/download/contextbatch/css/pagediffs/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/0530abbfd1f6123e0fbc7e3ab0d2fc5c/_/download/contextbatch/css/atl.confluence.plugins.pagetree-desktop%2cmain/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/e6a8343e61db195b04f1598119e4df48/_/download/contextbatch/css/atl.general/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/47016f6b93087cd2003bf867318254ee/_/download/contextbatch/css/theme.doc/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-hig/com.atlassian.confluence.plugins.confluence-highlight-ac" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/5.3.3-m6/_/download/batch/confluence.extra.jira_web-resources-adg/confluence.extra.jira_web-resources-adg.css" media="all">
<link type="text/css" rel="stylesheet" href="../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/51/_/styles/colorsb538.css?spaceKey=EZP" media="all">
<link type="text/css" rel="stylesheet" href="../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/51/_/styles/customb538.css?spaceKey=EZP" media="all">

<!-- end system css resources -->

    <meta name="robots" content="noindex,nofollow">
    <meta name="robots" content="noarchive">
    <meta name="confluence-request-time" content="1413915069827">
        
    
        
            <meta name="ajs-is-confluence-admin" content="false">
            <meta name="ajs-connection-timeout" content="10000">
            <meta name="ajs-use-keyboard-shortcuts" content="true">
            <meta name="ajs-keyboardshortcut-hash" content="ec556f85a7b4fc86b37ab7a78ce3d8b0">
            <meta id="team-calendars-has-jira-link" content="true">
            <meta name="ajs-team-calendars-display-time-format" content="displayTimeFormat12">
            <meta id="team-calendars-user-timezone" content="UTC">
            <script type="text/x-template" id="team-calendars-messages" title="team-calendars-messages">
    <fieldset class="i18n hidden">
                    <input type="hidden" name="calendar3.month.short.april" value="Apr">
                    <input type="hidden" name="calendar3.month.short.november" value="Nov">
                    <input type="hidden" name="calendar3.month.long.november" value="November">
                    <input type="hidden" name="calendar3.day.short.friday" value="Fri">
                    <input type="hidden" name="calendar3.month.long.february" value="February">
                    <input type="hidden" name="calendar3.month.short.february" value="Feb">
                    <input type="hidden" name="calendar3.day.long.wednesday" value="Wednesday">
                    <input type="hidden" name="calendar3.month.long.december" value="December">
                    <input type="hidden" name="calendar3.day.short.sunday" value="Sun">
                    <input type="hidden" name="calendar3.month.long.april" value="April">
                    <input type="hidden" name="calendar3.month.long.july" value="July">
                    <input type="hidden" name="calendar3.month.long.september" value="September">
                    <input type="hidden" name="calendar3.month.short.august" value="Aug">
                    <input type="hidden" name="calendar3.month.short.june" value="Jun">
                    <input type="hidden" name="calendar3.month.short.may" value="May">
                    <input type="hidden" name="calendar3.day.short.tuesday" value="Tue">
                    <input type="hidden" name="calendar3.day.short.wednesday" value="Wed">
                    <input type="hidden" name="calendar3.day.long.thursday" value="Thursday">
                    <input type="hidden" name="calendar3.month.long.march" value="March">
                    <input type="hidden" name="calendar3.month.long.october" value="October">
                    <input type="hidden" name="calendar3.day.short.saturday" value="Sat">
                    <input type="hidden" name="calendar3.month.short.january" value="Jan">
                    <input type="hidden" name="calendar3.month.long.may" value="May">
                    <input type="hidden" name="calendar3.month.long.january" value="January">
                    <input type="hidden" name="calendar3.month.short.october" value="Oct">
                    <input type="hidden" name="calendar3.day.short.thursday" value="Thu">
                    <input type="hidden" name="calendar3.day.long.friday" value="Friday">
                    <input type="hidden" name="calendar3.day.long.sunday" value="Sunday">
                    <input type="hidden" name="calendar3.month.long.june" value="June">
                    <input type="hidden" name="calendar3.month.long.august" value="August">
                    <input type="hidden" name="calendar3.day.long.tuesday" value="Tuesday">
                    <input type="hidden" name="calendar3.day.long.saturday" value="Saturday">
                    <input type="hidden" name="calendar3.month.short.september" value="Sep">
                    <input type="hidden" name="calendar3.day.long.monday" value="Monday">
                    <input type="hidden" name="calendar3.month.short.july" value="Jul">
                    <input type="hidden" name="calendar3.month.short.march" value="Mar">
                    <input type="hidden" name="calendar3.day.short.monday" value="Mon">
                    <input type="hidden" name="calendar3.month.short.december" value="Dec">
            </fieldset>
</script>

            

    
            
    
    
            <meta name="ajs-page-id" content="2719880">
            <meta name="ajs-content-type" content="page">
            <meta name="ajs-page-title" content="Field Type API and best practices">
            <meta name="ajs-parent-page-title" content="Extending Exponential 5">
            <meta name="ajs-parent-page-id" content="1736733">
            <meta name="ajs-space-key" content="EZP">
            <meta name="ajs-space-name" content="Exponential Platform 5.x">
            <meta name="ajs-from-page-title" content="">
            <meta name="ajs-can-remove-page" content="false">
            <meta name="ajs-context-path" content="">
            <meta name="ajs-base-url" content="https://doc.ez.no">
            <meta name="ajs-version-number" content="5.4.4">
            <meta name="ajs-build-number" content="4733">
            <meta name="ajs-remote-user" content="">
            <meta name="ajs-current-user-fullname" content="">
            <meta name="ajs-current-user-avatar-url" content="">
            <meta name="ajs-static-resource-url-prefix" content="/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_">
            <meta name="ajs-global-settings-attachment-max-size" content="10485760">
            <meta name="ajs-user-locale" content="en_GB">
            <meta name="ajs-enabled-dark-features" content="sync.event">
            <meta name="ajs-atl-token" content="494111f00e28ced96046bfb6fbe8f75e18d44b71">
            <meta name="ajs-confluence-flavour" content="VANILLA">
            <meta name="ajs-editor.loader.resources" content="&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=https://doc.ez.no/pages/"/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/ff74d20045a1ee5a81efff6a44eea98b/_/download/contextbatch/css/editor,macro-browser,fullpage-editor,-atl.general/batch.css" media=&quot;all&quot;&gt;
&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=https://doc.ez.no/pages/"/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/ff74d20045a1ee5a81efff6a44eea98b/_/download/contextbatch/css/editor,macro-browser,fullpage-editor,-atl.general/batch.css?media=%28max-width%3A+1450px%29%22 media=&quot;(max-width: 1450px)&quot;&gt;
&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=https://doc.ez.no/pages/"/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/ff74d20045a1ee5a81efff6a44eea98b/_/download/contextbatch/css/editor,macro-browser,fullpage-editor,-atl.general/batch.css?media=print%22 media=&quot;print&quot;&gt;
&lt;!--[if lt IE 9]&gt;
&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=https://doc.ez.no/pages/"/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/ff74d20045a1ee5a81efff6a44eea98b/_/download/contextbatch/css/editor,macro-browser,fullpage-editor,-atl.general/batch.css?conditionalComment=lt+IE+9%22 media=&quot;all&quot;&gt;
&lt;![endif]--&gt;
&lt;!--[if IE]&gt;
&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=https://doc.ez.no/pages/"/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/ff74d20045a1ee5a81efff6a44eea98b/_/download/contextbatch/css/editor,macro-browser,fullpage-editor,-atl.general/batch.css?ieonly=true%22 media=&quot;all&quot;&gt;
&lt;![endif]--&gt;
&lt;script type=&quot;text/javascript&quot; src=https://doc.ez.no/pages/"/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/ff74d20045a1ee5a81efff6a44eea98b/_/download/contextbatch/js/editor,macro-browser,fullpage-editor,-atl.general/batch.js" &gt;&lt;/script&gt;
">
            <meta name="ajs-date.format" content="MMM dd, yyyy">
    
    <link rel="shortcut icon" href="https://doc.ez.no/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://doc.ez.no/favicon.ico">

<link rel="search" type="application/opensearchdescription+xml" href="https://doc.ez.no/opensearch/osd.action" title="eZ Documentation"/>

    <!-- include system javascript resources -->
    <script type="text/javascript" src="https://doc.ez.no/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/js/batch.js" ></script>
<!--[if lte IE 8]>
<script type="text/javascript" src="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/js/batch.js?conditionalComment=lte+IE+8" ></script>
<![endif]-->
<script type="text/javascript" src="https://doc.ez.no/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/f10c36425b731f08af1bde9c7e745307/_/download/contextbatch/js/pagediffs/batch.js" ></script>
<script type="text/javascript" src="https://doc.ez.no/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/0530abbfd1f6123e0fbc7e3ab0d2fc5c/_/download/contextbatch/js/atl.confluence.plugins.pagetree-desktop,main/batch.js" ></script>
<script type="text/javascript" src="https://doc.ez.no/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/js/page/batch.js" ></script>
<script type="text/javascript" src="https://doc.ez.no/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/e6a8343e61db195b04f1598119e4df48/_/download/contextbatch/js/atl.general/batch.js" ></script>
<script type="text/javascript" src="https://doc.ez.no/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources.js" ></script>
<script type="text/javascript" src="https://doc.ez.no/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.mywork.mywork-confluence-host-plugin:mw-header-anchor/com.atlassian.mywork.mywork-confluence-host-plugin:mw-header-anchor.js" ></script>

    

        
    <!-- end system javascript resources -->

        
        

    
                <link rel="canonical" href="https://doc.ez.no/display/EZP/Field+Type+API+and+best+practices">
        <link rel="shortlink" href="https://doc.ez.no/x/iIAp">
    <meta name="wikilink" content="[EZP:Field Type API and best practices]">
    <meta name="page-version" content="38">

</head>

<body             onload="placeFocus()"
     id="com-atlassian-confluence" class="theme-documentation  aui-theme-default aui-layout">

        
    <div id="full-height-container">
    <div id="header-precursor">
        
                    </div>






<header id="header" role="banner">
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation"><div class="aui-header-inner"><div class="aui-header-before"><a class="aui-dropdown2-trigger app-switcher-trigger" aria-owns="app-switcher" aria-haspopup="true" tabindex="0"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a><div id="app-switcher" class="aui-dropdown2 aui-style-default"><div class="app-switcher-loading">Loading&hellip;</div></div><script>
            (function (NL) {
                var initialise = function () {
                    // For some milestones of AUI, the atlassian soy namespace was renamed to aui. Handle that here by ensuring that window.atlassian is defined.
                    window.atlassian = window.atlassian || window.aui;
                    new NL.AppSwitcher({
                        dropdownContents: '#app-switcher'
                    });
                };
                if (NL.AppSwitcher) {
                    initialise();
                } else {
                    NL.onInit = initialise;
                }
            }(window.NL = (window.NL || {})));
            window.NL.isUserAdmin = false</script></div><div class="aui-header-primary"><h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://doc.ez.no/"><img src="https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/images/logo/confluence-logo.png" alt="eZ Documentation" /></a></h1><ul class="aui-nav">
                            <li>
            
        
        
<a  id="space-directory-link" href="https://doc.ez.no/spacedirectory/view.action"  class=" aui-nav-imagelink"   title="Spaces">
            <span>Spaces</span>
    </a>
        </li>
                            <li id="browseMenu" role="menu">
            
    
        <a id="browse-menu-link" class="aui-nav-link aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-owns="browse-menu-link-content" title="Browse">
        <span class="browse">Browse</span>
    </a>
    <nav id="browse-menu-link-content" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                    <div class="aui-dropdown2-section">
                <ul  id="browse-menu-link-leading" class="aui-list-truncate section-leading first">
                                            <li>
    
            
<a  id="space-pages-link" href="https://doc.ez.no/pages/listpages.action?key=EZP" class="    "      title="Browse pages in The Exponential CMS 5.x space" >
        Pages
</a>
</li>
                                            <li>
    
            
<a  id="space-blogposts-link" href="https://doc.ez.no/pages/viewrecentblogposts.action?key=EZP" class="    "      title="Browse blogs in The Exponential CMS 5.x space" >
        Blog
</a>
</li>
                                            <li>
    
            
<a  id="space-labels-link" href="https://doc.ez.no/labels/listlabels-heatmap.action?key=EZP" class="    "      title="Browse labels in The Exponential CMS 5.x space" >
        Labels
</a>
</li>
                                            <li>
    
            
<a  id="space-advanced-link" href="https://doc.ez.no/spaces/viewspacesummary.action?key=EZP" class="    "      title="Browse additional space functions in The Exponential CMS 5.x space" >
        Space Operations
</a>
</li>
                                    </ul>
            </div>
            </nav>
    
        </li>
        </ul>
</div><div class="aui-header-secondary"><ul class="aui-nav">
                <li>
<form id="quick-search" class="aui-quicksearch dont-default-focus header-quicksearch" action="https://doc.ez.no/dosearchsite.action" method="get">
    <fieldset>
                    <input type='hidden' name='where' value='EZP'/>
                            <input type="hidden" name="spaceSearch" value="true"/>
                <label for="quick-search-query" class="assistive">Quick Search</label>
        <input id="quick-search-query" class="text app-search search quick-search-query" type="text"
               accessKey="q" autocomplete="off" name="queryString" title="Quick Search"  placeholder="Search space" />
        <input id="quick-search-submit" class="quick-search-submit" type="submit" value="Search"/>

        <div class="aui-dd-parent quick-nav-drop-down"></div>
    </fieldset>
    <div class="hidden parameters">
                    <!-- putMetadata failed to add value for key "quick-nav-enabled" so rendering metadata inline - see server debug log for details -->
        <meta name="ajs-quick-nav-enabled" content="true">
                </div>
</form>
</li>
    <li>    
        <a id="help-menu-link" class="aui-nav-link aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-owns="help-menu-link-content" title="Help">
        <span class="aui-icon aui-icon-small aui-iconfont-help">Help</span>
    </a>
    <nav id="help-menu-link-content" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                    <div class="aui-dropdown2-section">
                <ul  id="help-menu-link-leading" class="aui-list-truncate section-leading first">
                                            <li>
    
            
<a  id="confluence-help-link" href="http://docs.atlassian.com/confluence/docs-54/Getting+Help+And+Support" class="    "      title="Visit the Confluence documentation home"  target="_blank"
>
        Online Help
</a>
</li>
                                            <li>
    
                
<a  id="keyboard-shortcuts-link" href="#" class="    "      title="View available keyboard shortcuts" >
        Keyboard Shortcuts
</a>
</li>
                                            <li>
    
            
<a  id="feed-builder-link" href="https://doc.ez.no/dashboard/configurerssfeed.action" class="    "      title="Create your custom RSS feed." >
        Feed Builder
</a>
</li>
                                            <li>
    
            
<a  id="whats-new-menu-link" href="http://docs.atlassian.com/confluence/docs-54/whatsnew/iframe" class="    "      title="" >
        What’s new
</a>
</li>
                                            <li>
    
                
<a  id="gadget-directory-link" href="#" class="   user-item administration-link "      title="Browse gadgets provided by Confluence" >
        Available Gadgets
</a>
</li>
                                            <li>
    
            
<a  id="confluence-about-link" href="https://doc.ez.no/aboutconfluencepage.action" class="    "      title="Get more information about Confluence" >
        About Confluence
</a>
</li>
                                    </ul>
            </div>
            </nav>
    </li>
    <li>    
    </li>
                <li>                                    <li>
    
            
<a  id="login-link" href="https://doc.ez.no/login.action?os_destination=%2Fpages%2Fdiffpagesbyversion.action%3FpageId%3D2719880%26originalVersion%3D22%26revisedVersion%3D38" class="   user-item login-link "      title="" >
        Log in
</a>
</li>
                        </li>
</ul>
</div></div><!-- .aui-header-inner--></nav><!-- .aui-header -->
    <br class="clear">
</header>

    <div id="splitter">
    <div id="splitter-sidebar"  class="padding-div" >
        
        <p>&nbsp;<br/>
<strong>Navigation</strong><br/>
&bull; <a href="https://confluence.ez.no/display/MAIN" class="external-link" rel="nofollow">eZ Documentation Center</a><br/>
&nbsp;</p>
    

                    
    


<div class="plugin_pagetree">

        
        
    <ul class="plugin_pagetree_children_list plugin_pagetree_children_list_noleftspace">
        <div class="plugin_pagetree_children">
        </div>
    </ul>

    <fieldset class="hidden">
        <input type="hidden" name="treeId" value="">
        <input type="hidden" name="treeRequestId" value="/plugins/pagetree/naturalchildren.action?decorator=none&amp;excerpt=false&amp;sort=position&amp;reverse=false&amp;disableLinks=false&amp;expandCurrent=false">
        <input type="hidden" name="treePageId" value="2719880">

        <input type="hidden" name="noRoot" value="false">
        <input type="hidden" name="rootPageId" value="1114149">

        <input type="hidden" name="rootPage" value="">
        <input type="hidden" name="startDepth" value="0">
        <input type="hidden" name="spaceKey" value="EZP" >

        <input type="hidden" name="i18n-pagetree.loading" value="Loading...">
        <input type="hidden" name="i18n-pagetree.error.permission" value="Unable to load page tree. It seems that you do not have permission to view the root page.">
        <input type="hidden" name="i18n-pagetree.eeror.general" value="There was a problem retrieving the page tree. Please check the server log file for more information.">
        <input type="hidden" name="loginUrl" value="/login.action?os_destination=%2Fpages%2Fdiffpagesbyversion.action%3FpageId%3D2719880%26originalVersion%3D22%26revisedVersion%3D38">
        <input type="hidden" name="mobile" value="false">

                <fieldset class="hidden">
                                                <input type="hidden" name="ancestorId" value="1736733">
                                    <input type="hidden" name="ancestorId" value="2720528">
                                    <input type="hidden" name="ancestorId" value="6291674">
                                    <input type="hidden" name="ancestorId" value="1114149">
                                    </fieldset>
    </fieldset>
</div>



            </div>
    <div id="splitter-content">

                    <script type="text/javascript" src="https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/5.4.4/_/download/resources/com.atlassian.confluence.plugins.doctheme:resources/doc-theme.js"></script>
    
                        
        <div id="theme-header">
            <div class="sectionColumnWrapper"><div class="sectionMacro">
<div class="sectionMacroRow"><div class="columnMacro"></div>
<div class="columnMacro">
<div class="panel" style="background-color: #ecf0f1;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #ecf0f1;">
<p>This documentation is for <strong>Exponential Platform 5.x</strong> "Platform stack". For documentation on "legacy" <a href="https://doc.ez.no/Exponential/" class="external-link" rel="nofollow">go here</a>, for explanation on difference see <a href="https://doc.ez.no/pages/viewpage.action?pageId=11403666" class="external-link" rel="nofollow">5.x Architecture overview</a></p>
</div></div></div>
<div class="columnMacro"></div></div></div></div>
        </div>
    
            
<div id="main"  class="aui-page-panel" >
    <div id="main-header">
        
        
    <div id="navigation" class="content-navigation view-information">
                    <ul class="ajs-menu-bar">
                            <li class="ajs-button normal">

    
        
                            
    
    
    <a  id="viewPageLink" href="https://doc.ez.no/display/EZP/Field+Type+API+and+best+practices" rel="nofollow"  class="view"   title="">
                <span>View Page</span>    </a>
</li>
                        
                    
        <li class="normal ajs-menu-item">
        <a id="action-menu-link" class="action ajs-menu-title aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-owns="action-menu" data-container="#navigation"><span><span>Tools</span></span></a>         <div id="action-menu" class="aui-dropdown2 aui-style-default">
                            <ul  id="action-menu-primary"                     class="section-primary first aui-dropdown2-section">
                                            <li>

    
        
                            
    
    
    <a  id="view-attachments-link" href="https://doc.ez.no/pages/viewpageattachments.action?pageId=2719880" rel="nofollow"  class="action-view-attachments"  accessKey="t"  title="View Attachments">
                <span>A<u>t</u>tachments (3)</span>    </a>
</li>
                                        <li>

    
        
                            
    
    
    <a  id="action-view-history-link" href="https://doc.ez.no/pages/viewpreviousversions.action?pageId=2719880" rel="nofollow"  class="action-view-history"   title="">
                <span>Page History</span>    </a>
</li>
                                        <li>

    
        
                            
    
    
    <a  id="action-page-permissions-link" href="https://doc.ez.no/pages/viewinfo.action?pageId=2719880" rel="nofollow"  class="action-page-permissions"   title="Edit restrictions">
                <span>Restrictions</span>    </a>
</li>
                                </ul>
                            <ul  id="action-menu-secondary"                     class="section-secondary aui-dropdown2-section">
                                            <li>

    
        
                            
    
    
    <a  id="view-page-info-link" href="https://doc.ez.no/pages/viewinfo.action?pageId=2719880" rel="nofollow"  class="action-view-info"   title="">
                <span>Page Information</span>    </a>
</li>
                                        <li>

    
        
                            
    
    
    <a  id="link-to-page-link" href="https://doc.ez.no/pages/viewinfo.action?pageId=2719880" rel="nofollow"  class=""   title="Link to this Page">
                <span>Link to this Page…</span>    </a>
</li>
                                        <li>

    
        
                            
    
    
    <a  id="view-in-hierarchy-link" href="https://doc.ez.no/pages/listpages-dirview.action?key=EZP&amp;openId=2719880#selectedPageInHierarchy" rel="nofollow"  class=""   title="">
                <span>View in Hierarchy</span>    </a>
</li>
                                        <li>

    
        
                            
    
    
    <a  id="action-view-source-link" href="https://doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=2719880" rel="nofollow"  class="action-view-source popup-link"   title="">
                <span>View Source</span>    </a>
</li>
                                        <li>

    
        
                            
    
    
    <a  id="action-export-pdf-link" href="https://doc.ez.no/spaces/flyingpdf/pdfpageexport.action?pageId=2719880" rel="nofollow"  class=""   title="">
                <span>Export to PDF</span>    </a>
</li>
                                        <li>

    
        
                            
    
    
    <a  id="action-export-word-link" href="https://doc.ez.no/exportword?pageId=2719880" rel="nofollow"  class="action-export-word"   title="">
                <span>Export to Word</span>    </a>
</li>
                                </ul>
                    </div>
    </li>
            </ul>
    </div>

        
                <div id="title-heading" class="pagetitle with-breadcrumbs">
        
                            <div class="space-logo " data-key="EZP" data-name="Exponential Platform 5.x" data-entity-type="confluence.space">
            <a><img class="logo space custom" src="https://doc.ez.no/download/attachments/1736738/EZP?version=4&amp;modificationDate=1405688262000&amp;api=v2" alt=""></a>
        </div>            
                            <div id="breadcrumb-section">
                    
    
    
    <ol id="breadcrumbs">
                    
                
        <li class="first" >
                

                    <span class=""><a href="https://doc.ez.no/display/EZP">Exponential Platform 5.x</a></span>
                                                <li id="ellipsis" title="Show all breadcrumbs"><span><strong>&#8230;</strong></span></li>
                                    
                
        <li class="hidden-crumb" >
                

                    <span class=""><a href="https://doc.ez.no/display/EZP/eZ+Publish+Platform+Documentation">Exponential Platform Documentation</a></span>
                                        
                
        <li class="hidden-crumb" >
                

                    <span class=""><a href="https://doc.ez.no/pages/viewpage.action?pageId=6291674">Development &amp; Administration Guides</a></span>
                                        
                
        <li class="hidden-crumb" >
                

                    <span class=""><a href="https://doc.ez.no/display/EZP/Developing+with+eZ+Publish+5">Developing with Exponential 5</a></span>
                                        
                
        <li class="hidden-crumb" >
                

                    <span class=""><a href="https://doc.ez.no/display/EZP/Extending+eZ+Publish+5">Extending Exponential 5</a></span>
                            
                
        <li>
                

                    <span class=""><a href="https://doc.ez.no/display/EZP/Field+Type+API+and+best+practices">Field Type API and best practices</a></span>
                </ol>


                </div>
            
            <h1 id="title-text" class="with-breadcrumbs">
                            Page History
                        </h1>
        </div>
    </div>

    

    
    
    
    
    

    

    
                
    
        




        




    

    

    







    
    
        
    
    
                    
    

    


<div id="content" class="page view-information">
    

<div id="action-messages">
                        </div>



        <script type="text/x-template" title="searchResultsGrid">
    <table class="aui">
        <thead>
            <tr class="header">
                <th class="search-result-title">Page Title</th>
                <th class="search-result-space">Space</th>
                <th class="search-result-date">Updated</th>
            </tr>
        </thead>
    </table>
</script>
<script type="text/x-template" title="searchResultsGridCount">
    <p class="search-result-count">{0}</p>
</script>
<script type="text/x-template" title="searchResultsGridRow">
    <tr class="search-result">
        <td class="search-result-title"><a href="{1}" class="content-type-{2}"><span>{0}</span></a></td>
        <td class="search-result-space"><a class="space" href="/display/{4}/" title="{3}">{3}</a></td>
        <td class="search-result-date"><span class="date" title="{6}">{5}</span></td>
    </tr>
</script>
        
    
    
                            
    
                        
                    <div class="diff-menu">
                <h2 class="diff-title">Versions Compared</h2>

                <div class="page-navigation section">
                                <div class="old page-version article">
                <h3 class="version-title">
                    <a class="page version-navigation" href="https://doc.ez.no/pages/viewpage.action?pageId=3506225">
                        <span class="assistive">Old Version</span>
                        <span class="version"> 22 </span>
                    </a>
                </h3>
                <p class="metadata author"><span class="assistive">changes.mady.by.user </span>    <a href="https://doc.ez.no/display/~andre.romcke@ez.no"
                       class="url fn"
                            >André Rømcke</a></p>
                <p class="metadata modified"><span class="assistive">Saved on </span><time datetime="2012-09-10 17:10:20.0">Sep 10, 2012</time></p>
            </div>
        
                    <span class="assistive">compared with</span>

                                <div class="new page-version article">
                <h3 class="version-title">
                    <a class="page version-navigation" href="https://doc.ez.no/pages/viewpage.action?pageId=2719880">
                        <span class="assistive">New Version</span>
                        <span class="version"> Current </span>
                    </a>
                </h3>
                <p class="metadata author"><span class="assistive">changes.mady.by.user </span>    <a href="https://doc.ez.no/display/~bertrand.dunogier@ez.no"
                       class="url fn"
                            >Bertrand Dunogier</a></p>
                <p class="metadata modified"><span class="assistive">Saved on </span><time datetime="2013-08-29 09:12:05.0">Aug 29, 2013</time></p>
            </div>
        
                    <div class="diff-navigation nav">
                        <ul>
                                                    <li><a class="previous version-navigation" href="https://doc.ez.no/pages/diffpages.action?originalId=2720532&amp;pageId=3506225">
                                <span>Previous Change: Difference between versions 21 and 22</span>
                            </a></li>
                                                                           <li><a class="all version-navigation" href="https://doc.ez.no/pages/viewpreviousversions.action?pageId=2719880">
                                <span>View Page History</span>
                           </a></li>
                        </ul>
                    </div>
                </div>

                        <div class="legend">
            <h2 class="legend-title">Key</h2>
            <ul>
                <li><span class="diff-html-added">This line was added.</span></li>
                <li><span class="diff-html-removed">This line was removed.</span></li>
                <li><span class="diff-html-changed">Formatting was changed.</span></li>
            </ul>
        </div>
    
                            <div id="version-comment" class="noteMacro">
        <strong>Comment:</strong>
        Migrated to Confluence 5.3<br />
    </div>
                </div>
                                                                
    
<div id="page-diffs" class="wiki-content">
            <p class="diff-block-context"><table class="diff-macro bodyless"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/images/icons/macrobrowser/dropdown/toc.png);"> </span>Table of Contents</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>outline</th><td>true</td></tr></tbody></table></td></tr></tbody></table></p><p class="diff-block-target diff-block-context"><strong><span class="diff-html-added" id="added-diff-0">Related documentation:</span></strong></p><p class="diff-block-target diff-block-context"><table class="diff-macro bodyless diff-html-added"><thead><tr><th class="diff-macro-title"><span class="diff-html-added"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/images/icons/macrobrowser/dropdown/children.png);"> </span>Children Display</span></th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th><span class="diff-html-added">all</span></th><td><span class="diff-html-added">true</span></td></tr></tbody></table></td></tr></tbody></table></p><h1 id="FieldTypeAPIandbestpractices-FieldTypeAPI&amp;bestpractices" class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-0">Field Type API &amp; best practices</span></h1><p class="diff-block-target diff-block-context">The Exponential CMS can support arbitrary data to be stored in the fields of a content object. In order to support custom data, <span class="diff-html-removed" id="removed-diff-0">beside </span><span class="diff-html-added" id="added-diff-1">besides </span>the standard data types, a developer needs to create a custom <strong>FieldType</strong>.</p><p class="diff-block-target">The implementation of a custom FieldType is <span class="diff-html-removed" id="removed-diff-1">realized </span><span class="diff-html-added" id="added-diff-2">done based </span>on <span class="diff-html-removed" id="removed-diff-2">basis of </span>the FieldType SPI and its interfaces. These can be found under <code>eZ\Publish\SPI\FieldType</code>.</p><p class="diff-block-context">In order to provide custom functionality for a FieldType, the SPI interacts with multiple layers of the Exponential architecture, as shown in the following diagram:</p><p class="diff-block-target diff-block-context"> <span class="diff-html-removed diff-html-image-container" id="removed-diff-3"><img class="confluence-embedded-image" src="https://doc.ez.no/plugins/servlet/confluence/placeholder/unknown-attachment?locale=en_GB&amp;version=2" title="field_type_overview.png" /><span class="diff-image-overlay diff-removed-image">Image Removed</span></span><span class="diff-html-added diff-html-image-container" id="added-diff-3"><img class="confluence-embedded-image" src="https://doc.ez.no/download/attachments/2719880/field_type_overview.png?version=1&amp;modificationDate=1343120665000&amp;api=v2" data-image-src="/download/attachments/2719880/field_type_overview.png?version=1&amp;modificationDate=1343120665000&amp;api=v2" /><span class="diff-image-overlay diff-added-image">Image Added</span></span></p><p class="diff-block-target diff-block-context">On the top <span class="diff-html-removed" id="removed-diff-4">most </span>layer, the FieldType needs to provide conversion from and to a simple PHP hash value to support the REST API. The generated hash value may only consist of scalar values and hashes. It must <span class="diff-html-removed" id="removed-diff-5">neither </span><span class="diff-html-added" id="added-diff-4">not </span>contain objects <span class="diff-html-removed" id="removed-diff-6">, nor </span><span class="diff-html-added" id="added-diff-5">or </span>arrays with numerical indexes that aren't sequential and/or don't start with zero.</p><p class="diff-block-target">Below that, the FieldType must support the Public API implementation (aka Business Layer)<span class="diff-html-removed"> </span><span class="diff-html-removed" id="removed-diff-7">in respect to</span><span class="diff-html-added" id="added-diff-6">, regarding</span>:</p><ul class="diff-block-context"><li>Settings definition for FieldDefinitions</li><li>Value creation and validation</li><li>Communication with the Persistence SPI</li></ul><p class="diff-block-target">On the bottom level, a FieldType can additionally hook into the Persistence SPI, in order to store data from a FieldValue in an external service. Note <span class="diff-html-removed" id="removed-diff-8">, </span>that all non-standard Exponential database tables (e.g. <code>ezurl</code>) are also considered "external storage" from now on.</p><p class="diff-block-context">The following sequence diagram visualizes the process of creating a new <code>Content</code> across all layers, especially focused on the interaction with a <code>FieldType</code>.</p><p class="diff-block-target diff-block-context"><span class="diff-html-removed diff-html-image-container" id="removed-diff-9"><img class="confluence-embedded-image" src="https://doc.ez.no/plugins/servlet/confluence/placeholder/unknown-attachment?locale=en_GB&amp;version=2" title="create_content_sequence.png" /><span class="diff-image-overlay diff-removed-image">Image Removed</span></span><span class="diff-html-added diff-html-image-container" id="added-diff-7"><img class="confluence-embedded-image" src="https://doc.ez.no/download/attachments/2719880/create_content_sequence.png?version=2&amp;modificationDate=1345030668000&amp;api=v2" data-image-src="/download/attachments/2719880/create_content_sequence.png?version=2&amp;modificationDate=1345030668000&amp;api=v2" /><span class="diff-image-overlay diff-added-image">Image Added</span></span><br /> </p><p class="diff-block-target diff-block-context">In <span class="diff-html-removed" id="removed-diff-10">following</span><span class="diff-html-added" id="added-diff-8">the next lines/pages</span>, this document explains how to implement a custom FieldType <span class="diff-html-added" id="added-diff-9">based </span>on <span class="diff-html-removed" id="removed-diff-11">basis of </span>the SPI and what is expected from <span class="diff-html-removed" id="removed-diff-12">the FieldType</span><span class="diff-html-added" id="added-diff-10">it</span>. As a code example, please refer to the Url FieldType, which has been implemented as a reference.</p><h2 id="FieldTypeAPIandbestpractices-PublicAPIinteraction" class="diff-block-target"><span class="diff-html-changed" id="changed-diff-1">Public API interaction</span></h2><p class="diff-block-target diff-block-context">The interaction with the Public API is <span class="diff-html-removed" id="removed-diff-13">realized </span><span class="diff-html-added" id="added-diff-11">done </span>through the interface <code>eZ\Publish\SPI\FieldType\FieldType</code>. A custom FieldType must provide an implementation of this interface. In addition, it is considered best practice to provide a value object class for storing the custom field value provided by the FieldType.</p><h3 id="FieldTypeAPIandbestpractices-FieldDefinitionhandling" class="diff-block-target"><span class="diff-html-changed" id="changed-diff-2">FieldDefinition handling</span></h3><p class="diff-block-context">In order to make use of a custom FieldType, the user must apply it in a <code>eZ\Publish\API\Repository\Values\ContentType\FieldDefinition</code> of a custom ContentType. The user may in addition provide settings for the FieldType and a validator configuration.  Since the Public API cannot know anything about these, their handling is delegated to the FieldType itself through the following methods:</p><p class="diff-context-placeholder">...</p><p style="margin-left: 30.0px;" class="diff-block-target">In addition to normal settings, the FieldType should provide a schema settings <span class="diff-html-removed" id="removed-diff-14">for for it</span><span class="diff-html-added" id="added-diff-12">for it</span>'s validation process. The schema describes, what kind of validation can be performed by the FieldType and which settings the user can specify to these validation methods. For example, the <code>ezstring</code> type can validate minimum and maximum length of the string. It therefore provides a schema to indicate to the user that he might specify the corresponding restrictions, when creating a <code>FieldDefinition</code> with this type. Again, the schema does not underly any regulations, except for that it must be serializable.</p><p class="diff-context-placeholder">...</p><p class="diff-block-target">It is important to note that while the schema definitions of the <code>FieldType</code> maybe both be of arbitrary, serializable format, it is highly recommended to use a simple hash structure. It is highly recommended to follow the <span class="diff-html-removed" id="removed-diff-15">`Best practices`_ </span><a href="#FieldTypeAPIandbestpractices-Bestpractices"><span class="diff-html-added" id="added-diff-13">Best practices</span></a><span class="diff-html-added"> </span>in order to create future proof schemas.</p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/images/icons/macrobrowser/dropdown/info.png);"> </span>Info</th></tr></thead><tbody><tr><td class="diff-macro-body"><p><strong>Note:</strong> Since it is not possible to enforce a schema format, the code using a specific <code>FieldType</code> must basically know all <code>FieldType</code>s it deals with.</p><p>This will also apply to all user interfaces and the REST API, which therefore must provide extension points to register handling code for custom <code>FieldType</code>. These extensions are not defined, yet.</p></td></tr></tbody></table><h3 id="FieldTypeAPIandbestpractices-Valuehandling" class="diff-block-target"><span class="diff-html-changed" id="changed-diff-3">Value handling</span></h3><p class="diff-block-context">A field type needs to deal with the custom value format provided by it. In order for the public API to work properly, it delegates working with such custom field values to the corresponding FieldType. The <code>SPI\FieldType\FieldType</code> interface therefore provides the following methods:</p><p class="diff-context-placeholder">...</p><p style="margin-left: 30.0px;" class="diff-block-context">In contrast to <code>acceptValue()</code> this method validates the plausibility of the given value, based on the <code>FieldType</code> settings and validator configuration, stored in the corresponding <code>FieldDefinition</code>.</p><div class="section diff-block-target diff-block-context"><h3 id="FieldTypeAPI&amp;bestpractices-Eventhandling"><span class="diff-html-removed" id="removed-diff-16">Event handling</span></h3><p><code><span class="diff-html-removed">FieldType</span></code><span class="diff-html-removed">s can react to various events that occur on content objects that contain a field of their type. The </span><code><span class="diff-html-removed">FieldType</span></code><span class="diff-html-removed"> is informed about an event by the method </span><code><span class="diff-html-removed">handleEvent()</span></code><span class="diff-html-removed">, which receives an event object of one of the following classes:</span></p><p><code><span class="diff-html-removed">PreCreateEvent</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-removed">Issued right before a </span><code><span class="diff-html-removed">Field</span></code><span class="diff-html-removed"> of </span><code><span class="diff-html-removed">FieldType</span></code><span class="diff-html-removed"> is created.</span></p><p><code><span class="diff-html-removed">PostCreateEvent</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-removed">Issued right after a </span><code><span class="diff-html-removed">Field</span></code><span class="diff-html-removed"> of </span><code><span class="diff-html-removed">FieldType</span></code><span class="diff-html-removed"> has been created.</span></p><p><code><span class="diff-html-removed">PrePublishEvent</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-removed">Issued right before the </span><code><span class="diff-html-removed">Content</span></code><span class="diff-html-removed"> is published.</span></p><p><code><span class="diff-html-removed">PostPublishEvent</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-removed">Issued right after the </span><code><span class="diff-html-removed">Content</span></code><span class="diff-html-removed"> has been published.</span></p><p><span class="diff-html-removed">Each of the events carries context data with it, which can be used to perform the desired event reactions.</span></p><div class="note"><p><span class="diff-html-removed"> </span></p><table class="diff-macro diff-html-removed"><thead><tr><th class="diff-macro-title"><span class="diff-html-removed"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/images/icons/macrobrowser/dropdown/info.png);"> </span>Info</span></th></tr></thead><tbody><tr><td class="diff-macro-body"><strong><span class="diff-html-removed">Note:</span></strong><span class="diff-html-removed"> It may occur that additional events are added to the SPI in future. You should therefore make sure that you check for the desired events using the instanceof operator.</span></td></tr></tbody></table><p><span class="diff-html-removed"> </span></p></div></div><div class="section diff-block-target diff-block-context"><h3 id="FieldTypeAPIandbestpractices-Storageconversion"><span style="font-size: 1.4em;"><span class="diff-html-changed" id="changed-diff-4">Storage conversion</span></span></h3></div><div class="section diff-block-target diff-block-context"><p>As said above, the value format of a <code>FieldType</code> is free form. However, in order to make Exponential store the value in it's database, it must comply to certain rules at storage time. To not restrict the value itself, a <code>FieldValue</code> must be converted to the storage specific format used by the Persistence SPI: <code>eZ\Publish\SPI\Persistence\Content\FieldValue</code>. After restoring a Field of <code>FieldType</code>, the conversion must be undone. The following methods of the <code>FieldType</code> are responsible for that:</p><p><code>toPersistenceValue()</code></p><p style="margin-left: 30.0px;">This method receives the value of a <code>Field</code> of <code>FieldType</code> and must return an SPI <code>FieldValue</code>, which can be stored.</p><p><code>fromPersistenceValue()</code></p><p style="margin-left: 30.0px;">As the counterpart, this method receives an SPI <code>FieldValue</code> and must reconstruct the original value of the <code>Field</code> from it.</p><p>The SPI FieldValue struct has several properties, which might be used by the FieldType as follows:</p><p><code>$data</code></p><p style="margin-left: 30.0px;">The data to be stored in the Exponential database. This may either be a scalar value, a hash map or a simple, serializable object.</p><p><code>$externalData</code></p><p style="margin-left: 30.0px;">The arbitrary data stored in this field will not be touched by any of the Exponential components directly, but will be hold available for <span class="diff-html-removed" id="removed-diff-17">`Storing </span><a href="#FieldTypeAPIandbestpractices-Storingexternaldata"><span class="diff-html-added" id="added-diff-14">Storing </span><span class="diff-html-changed" id="changed-diff-6">external </span></a><span class="diff-html-removed"> </span><span class="diff-html-removed" id="removed-diff-18">data`_</span><a href="#FieldTypeAPIandbestpractices-Storingexternaldata"><span class="diff-html-added" id="added-diff-15">data</span></a>.</p><p><code>$sortKey</code></p><p style="margin-left: 30.0px;">An value which can be used to sort <code>Content</code> by the field.</p><div class="note"><p class="last" style="margin-left: 30.0px;"><em>Note: TBD: Where will you register the Indexable implementations?</em></p></div></div><div class="section diff-block-target diff-block-context"><h2 id="FieldTypeAPIandbestpractices-Searching"><span class="diff-html-changed" id="changed-diff-7">Searching</span></h2><p>Fields, or a custom field type, might contain or maintain data which is relevant for user searches. To make the search engine aware of the data in your field type you need to implement an additional interface and register the implementation.</p><p>If your field type does not maintain any data, which should be available to search engines, feel free to just ignore this section.</p><p>The<code> eZ\Publish\SPI\FieldType\Indexable</code> defines two methods, which are required to be implemented, if the field type provides data relevant to search engines. The interface defines two methods for this:</p><p><code>getIndexData( Field $field )</code></p><p style="margin-left: 30.0px;">This method is supposed to return the actual index data for the provided <code>eZ\Publish\SPI\Persistence\Content\Field</code>. The index data consists of an array of <code>eZ\Publish\SPI\Persistence\Content\Search\Field</code> instances. They are described below in further detail.</p><p><code>getIndexDefinition()</code></p><p style="margin-left: 30.0px;">To be able to query data properly an indexable field type also is required to return search specification. You must return a hash map of <code>eZ\Publish\SPI\Persistence\Content\Search\FieldType</code> instances from this method, which could look like:</p><table class="diff-macro"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>array(
    'url'  =&gt; new Search\FieldType\StringField(),
    'text' =&gt; new Search\FieldType\StringField(),
)</pre></td></tr></tbody></table><p style="margin-left: 30.0px;"> This example from the <code>Url</code> field type shows that the field type will always return two indexable values, both strings. They have the names <code>url</code> and <code>text</code> respectively.</p><div class="section"><h3 id="FieldTypeAPIandbestpractices-SearchFieldValues"><span class="diff-html-changed" id="changed-diff-8">Search Field Values</span></h3><p>The search field values, returned by the <code>getIndexData</code> method are simple value objects consisting of the following properties:</p><p><code>$name</code></p><p style="margin-left: 30.0px;">The name of the field</p><p><code>$value</code></p><p style="margin-left: 30.0px;">The value of the field</p><p><code>$type</code></p><p style="margin-left: 30.0px;">An <code>eZ\Publish\SPI\Persistence\Content\Search\FieldType</code> instance, describing the type information of the field.</p></div><div class="section"><h3 id="FieldTypeAPIandbestpractices-SearchFieldTypes"><span class="diff-html-changed" id="changed-diff-9">Search Field Types</span></h3><p>There are bunch of available search field types, which are automagically handled by our Search backend configuration. When using those there is no requirement to adapt , for example, the Solr configuration in any way. You can always use custom field types, though, but these might require re-configuration of the search backend. For Solr this would mean adapting the schema.xml.</p><p>The default available search field types are:</p><p><code>StringField.php</code></p><p style="margin-left: 30.0px;">Standard string values. Will also be queries by full text searches.</p><p><code>TextField.php</code></p><p style="margin-left: 30.0px;">Standard text values. Will be queried by full text searches. Configured text normalizations in the search backend apply.</p><p><code>BooleanField.php</code></p><p style="margin-left: 30.0px;">Boolean values.</p><p><code>DateField.php</code></p><p style="margin-left: 30.0px;">Date field. Can be used for date range queries.</p><p><code>FloatField.php</code></p><p style="margin-left: 30.0px;">Field for floating point numbers.</p><p><code>IntegerField.php</code></p><p style="margin-left: 30.0px;">Field for integer numbers.</p><p><code>PriceField.php</code></p><p style="margin-left: 30.0px;">Field for price values. Currency conversion might be applied by the search backends. Might require careful configuration.</p><p><code>IdentifierField.php</code></p><p style="margin-left: 30.0px;">Field used for IDs. Basically acts like the string field, but will not be queried by fulltext searches</p><p><code>CustomField.php</code></p><p style="margin-left: 30.0px;">Custom field, for custom search data types. Will probably require additional configuration in the search backend.</p></div><div class="section"><h3 id="FieldTypeAPIandbestpractices-ConfiguringSolr"><span class="diff-html-changed" id="changed-diff-10">Configuring Solr</span></h3><p>As mentioned before, if you are using the standard type definitions <strong>there is no need to configure the search backend in any way</strong>. Everything will work fine. The field definitions are handled using <code>dynamicField</code> definitions in Solr, for example.</p><p>If you want to configure the handling of your field, you can always add a special field definition the Solr <code>schema.xml</code>. The field type names, which are used by the Solr search backend look like this for fields: <code><span class="pre">&lt;content_type_identifier&gt;/&lt;field_identifier&gt;/&lt;search_field_name&gt;_&lt;type&gt;</span></code>. You can, of course define custom <code>dynamicField</code> definitions to match, for example, on your custom <code>_&lt;type&gt;</code> definition.</p><p>You could also define a custom field definition dedicatedly for certain fields, like for the name field in an article:</p><table class="diff-macro"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>html/xml</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>&lt;field name="article/name/value_s" type="string" indexed="true" stored="true" required="false"/&gt;</pre></td></tr></tbody></table><p>If you want to learn more about the Solr implementation and detailed information about configuring it, check out the <a class="confluence-link unresolved" href="#">Solr Search Service Implementation Notes</a>.</p></div><div class="section"><h3 id="FieldTypeAPI&amp;bestpractices-RegisteraFieldType"><span class="diff-html-removed" id="removed-diff-19">Register a FieldType</span></h3><p><span class="diff-html-removed">To register a FieldType, see </span><a class="confluence-link unresolved" href="#"><span class="diff-html-removed">Register FieldType</span></a><span class="diff-html-removed">.</span></p><p><span class="diff-html-removed">To be integrated in unit and integration tests, FieldTypes need to be registered through the service.ini in eZ/Publish/Core/settings.</span></p></div></div><div class="section diff-block-target diff-block-context"><h2 id="FieldTypeAPIandbestpractices-Storingexternaldata"><span class="diff-html-changed" id="changed-diff-11">Storing external data</span></h2><p>A <code>FieldType</code> may store arbitrary data in external data sources and is in fact encouraged to do so. External storages can be e.g. a web service, a file in the file system, another database or even the Exponential database itself (in form of a non-standard table). In order to perform this task, the <code>FieldType</code> will interact with the Persistence SPI, which can be found in <code>eZ\Publish\SPI\Persistence</code>, through the <code>eZ\Publish\SPI\FieldType\FieldStorage</code> interface.</p><p>Whenever the internal storage of a Content that includes a Field of the <code>FieldType</code> is accessed, one of the following methods is called to also access the external data:</p><p><code>hasFieldData()</code></p><p style="margin-left: 30.0px;">Returns if the <code>FieldType</code> stores extrnal data at all.</p><p><code>storeFieldData()</code></p><p style="margin-left: 30.0px;">Called right before a <code>Field</code> of <code>FieldType</code> is stored. The method should perform the storing of <code>$externalData</code>. The method must return <code>true</code>, if the call manipulated <strong>internal data</strong> of the given <code>Field</code>, so that it is updated in the internal database.</p><p><code>getFieldData()</code></p><p style="margin-left: 30.0px;">Is called after a <code>Field</code> has been restored from the database in order to restore <code>$externalData</code>.</p><p><code>deleteFieldData()</code></p><p style="margin-left: 30.0px;">Must delete external data for the given <code>Field</code>, if exists.</p><p><code>getIndexData()</code></p><p style="margin-left: 30.0px;">See search service</p><p>Each of the above methods receive a $context array, which contains information on the underlying storage and the environment. This context can be used to store data in the Exponential data storage, but outside of the normal structures (e.g. a custom table in an SQL database). Note that the FieldType must take care on it's own for being compliant to different data sources and that 3rd parties can extend the data source support easily. For more information about this, take a look at the <a href="#FieldTypeAPIandbestpractices-Bestpractices"><span class="diff-html-changed" id="changed-diff-12">Best practices</span></a><a class="reference internal" rel="nofollow" /> section.</p></div><div class="section diff-block-target diff-block-context"><h2 id="FieldTypeAPIandbestpractices-LegacyStorageconversion"><span class="diff-html-changed" id="changed-diff-13">Legacy Storage conversion</span></h2><p>The <code>FieldType</code> system is designed for future storage back ends of Exponential. However, the old database schema (<em>Legacy Storage</em>) must still be supported. Since this database cannot store arbitrary value information as provided by a <code>FieldType</code>, another conversion step must take place if the Legacy Storage is used.</p><p>The conversion takes place through the interface <code>eZ\Publish\Core\Persistence\Legacy\Content\FieldValue\Converter</code>, which you must provide an implementation of with your <code>FieldType</code>. The following methods are contained in the interface:</p><p><code>toStorageValue()</code></p><p style="margin-left: 30.0px;">Converts a Persistence <code>Value</code> into a legacy storage specific value.</p><p><code>fromStorageValue()</code></p><p style="margin-left: 30.0px;">Converts the other way around.</p><p><code>toStorageFieldDefinition()</code></p><p style="margin-left: 30.0px;">Converts a Persistence <code>FieldDefinition</code> to a storage specific one.</p><p><code>fromStorageFieldDefinition</code></p><p style="margin-left: 30.0px;">Converts the other way around.</p><p><code>getIndexColumn()</code></p><p style="margin-left: 30.0px;">Returns the storage column which is used for indexing.</p><div class="section"><h3 id="FieldTypeAPIandbestpractices-Registeringaconverter"><span class="diff-html-changed" id="changed-diff-14">Registering a converter</span></h3><p>The registration of a <code>Converter</code> currently works through the <code>$config</code> parameter of <code>eZ\Publish\Core\Persistence\Legacy\Handler</code>. See the class documentation for further details.</p><div class="note"><p> </p><table class="diff-macro"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/images/icons/macrobrowser/dropdown/info.png);"> </span>Info</th></tr></thead><tbody><tr><td class="diff-macro-body">For global service container integration, see <a class="confluence-link unresolved" href="#">Register FieldType</a>.</td></tr></tbody></table><p><span class="diff-html-removed" id="removed-diff-20"> </span></p><h2 id="FieldTypeAPIandbestpractices-RESTAPIinteraction"><span class="diff-html-added" id="added-diff-16">REST API interaction</span></h2><p><span class="diff-html-added">When REST API is used, conversion needs to be done for </span><code><span class="diff-html-added">FieldType</span></code><span class="diff-html-added"> values, settings and validator configurations. These are converted to and from a simple hash format that can be encoded in REST payload (typically XML or JSON). As conversion needs to be done both when transmitting and receiving data through REST, </span><code><span class="diff-html-added">FieldType</span></code><span class="diff-html-added"> implements following pairs of methods:</span></p><p><code><span class="diff-html-added">toHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Converts FieldType Value into a plain hash format.</span></p><p><code><span class="diff-html-added">fromHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Converts the other way around.</span></p><p><code><span class="diff-html-added">fieldSettingsToHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Converts FieldType settings to a simple hash format.</span></p><p><code><span class="diff-html-added">fieldSettingsFromHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Converts the other way around.</span></p><p><code><span class="diff-html-added">validatorConfigurationToHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Converts FieldType validator configuration to a simple hash format.</span></p><p><code><span class="diff-html-added">validatorConfigurationFromHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Converts the other way around.</span></p><h3 id="FieldTypeAPIandbestpractices-Extensionpoints"><span class="diff-html-added">Extension points</span></h3><p><span class="diff-html-added">Some </span><code><span class="diff-html-added">FieldTypes</span></code><span class="diff-html-added"> will require additional processing, for example a </span><code><span class="diff-html-added">FieldType</span></code><span class="diff-html-added"> storing a binary file, or one having more complex settings or validator configuration. For this purpose specific implementations of an abstract class </span><code><span class="diff-html-added">eZ\Publish\Core\REST\Common\FieldTypeProcessor</span></code><span class="diff-html-added"> are used. This class provides following methods:</span></p><p><code><span class="diff-html-added">preProcessValueHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Performs manipulations on a received value hash, so that it conforms to the format expected by the </span><code><span class="diff-html-added">fromHash()</span></code><span class="diff-html-added"> method described above.</span></p><p><code><span class="diff-html-added">postProcessValueHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Performs manipulations on a outgoing value hash, previously generated by the </span><code><span class="diff-html-added">toHash()</span></code><span class="diff-html-added"> method described above.</span></p><p><code><span class="diff-html-added">preProcessFieldSettingsHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Performs manipulations on a received settings hash, so that it conforms to the format expected by the </span><code><span class="diff-html-added">fieldSettingsFromHash()</span></code><span class="diff-html-added"> method described above.</span></p><p><code><span class="diff-html-added">postProcessFieldSettingsHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Performs manipulations on a outgoing settings hash, previously generated by the </span><code><span class="diff-html-added">fieldSettingsToHash()</span></code><span class="diff-html-added"> method described above.</span></p><p><code><span class="diff-html-added">preProcessValidatorConfigurationHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Performs manipulations on a received validator configuration hash, so that it conforms to the format expected by the </span><code><span class="diff-html-added">validatorConfigurationFromHash()</span></code><span class="diff-html-added"> method described above.</span></p><p><code><span class="diff-html-added">postProcessValidatorConfigurationHash()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-added">Performs manipulations on a outgoing validator configuration hash, previously generated by the </span><code><span class="diff-html-added">validatorConfigurationToHash()</span></code><span class="diff-html-added"> method described above.</span></p><p><span class="diff-html-added">Base implementations of these methods simply return the given hash, so you can implement only the methods your </span><code><span class="diff-html-added">FieldType</span></code><span class="diff-html-added"> requires. Some </span><code><span class="diff-html-added">FieldTypes</span></code><span class="diff-html-added"> coming with the Exponential installation already implement processors and you are encouraged to take a look at them.</span></p><p><span class="diff-html-added">For details on registering a </span><code><span class="diff-html-added">FieldType</span></code><span class="diff-html-added"> processor, see Register FieldType page.</span></p></div></div></div><div class="section diff-block-target diff-block-context"><h2 id="FieldTypeAPIandbestpractices-Bestpractices"><span class="diff-html-changed" id="changed-diff-15">Best practices</span></h2><p>In this chapter, best practices for implementing a custom <cite>FieldType</cite> are collected. We highly encourage following these practices to be future proof.</p><div class="section"><h3 id="FieldTypeAPIandbestpractices-GatewaybasedStorage"><span class="diff-html-changed" id="changed-diff-16">Gateway based Storage</span></h3><p>In order to allow the usage of a <code>FieldType</code> that uses external data with different data storages, it is recommended to implement a gateway infrastructure and a registry for the gateways. In order to ease this action, the Core implementation of <code>FieldType</code> s provides corresponding interfaces and base classes. These can also be used for custom field types.</p><p>The interface <code>eZ\Publish\Core\FieldType\StorageGateway</code> is implemented by gateways, in order to be handled correctly by the registry. It has only a single method:</p><p><code>setConnection()</code></p><p style="margin-left: 30.0px;">The registry mechanism uses this method to set the SPI storage connection (e.g. the database connection to the Legacy Storage database) into the gateway, which might be used to store external data. The connection is retrieved from the <code>$context</code> array  automatically by the registry.</p><p>Note that the Gateway implementation itself must take care about validating that it received a usable connection. If it did not, it should throw a <code>RuntimeException</code>.</p><p>The registry mechanism is realized as a base class for <code>FieldStorage</code> implementations: <code>eZ\Publish\Core\FieldType\GatewayBasedStorage</code>. For managing <code>StorageGateway</code> s, the following methods are already implemented in the base class:</p><p><code>addGateway()</code></p><p style="margin-left: 30.0px;">Allows the registration of additional <code>StorageGateway</code>s from the outside. Furthermore, a hash map of <code>StorageGateway</code>s can be given to the constructor for basic initialization. This array should orginate from the Dependency Injection mechanism.</p><p><code>getGateway()</code></p><p style="margin-left: 30.0px;">This protected method is used by the implementation to retrieve the correct <code>StorageGateway</code> for the current context.</p><p><code><span class="diff-html-removed" id="removed-diff-21">getPersistenceHandler()</span></code></p><p style="margin-left: 30.0px;"><span class="diff-html-removed">In addition to the initial set of </span><code><span class="diff-html-removed">StorageGateway</span></code><span class="diff-html-removed"> s, the constructor of the base class receives the SPI Persistence </span><code><span class="diff-html-removed">Handler</span></code><span class="diff-html-removed">. It is highly encouraged to use this </span><code><span class="diff-html-removed">Handler</span></code><span class="diff-html-removed"> in order to load Exponential internal objects, instead of loading them manually through the context connection, to allow caching.</span></p><p>As a reference for the usage of these infrastructure, the Keyword, Url and User types can be examined.</p></div><div class="section"><h3 id="FieldTypeAPIandbestpractices-Settingsschema"><span class="diff-html-changed" id="changed-diff-17">Settings schema</span></h3><p>It is recommended to use a simple hash map format for the settings schema retured by <span class="pre">eZ\Publish\SPI\FieldType\FieldType::getSettingsSchema()</span>, which follows these rules:</p><ul class="simple"><li>The key of the hash map identifies a setting (e.g. <code>default</code>)</li><li>Its value is a hash map (2nd level) describing the setting using<br /><ul><li><code>type</code> to identify the setting type (e.g. <code>int</code> or <code>string</code>)</li><li><code>default</code> containing the default setting value</li></ul></li></ul><p>An example schema could look like this:</p><table class="diff-macro"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>array(
    'backupData' =&gt; array(
        'type' =&gt; 'bool',
        'default' =&gt; false
    ),
    'defaultValue' =&gt; array(
        'type' =&gt; 'string',
        'default' =&gt; 'Sindelfingen'
    )
);</pre></td></tr></tbody></table><p> </p></div><div class="section"><h3 id="FieldTypeAPIandbestpractices-Validatorschema"><span class="diff-html-changed" id="changed-diff-18">Validator schema</span></h3><p>The schema for validator configuration should have a similar format than the settings schema has, except it has an additional level, to group settings for a certain validation mechanism:</p><ul class="simple"><li>The key on the 1st level is a string, identifying a validator</li><li>Assigned to that is a hash map (2nd level) of settings</li><li>This hash map has a string key for each setting of the validator</li><li>It is assigned to a 3rd level hashmap, the setting description</li><li>This hash map should have the same format as for normal settings</li></ul><p>For example, for the <code>ezstring</code> type, the validator schema could be:</p><table class="diff-macro"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>array(
    'stringLength' =&gt; array(
        'minStringLength' =&gt; array(
            'type'    =&gt; 'int',
            'default' =&gt; 0,
        ),
        'maxStringLength' =&gt; array(
            'type'    =&gt; 'int'
            'default' =&gt; null,
        )
    ),
);</pre></td></tr></tbody></table><p><span class="diff-html-removed" id="removed-diff-22"> </span></p><h2 id="FieldTypeAPIandbestpractices-RegisteringaFieldType"><span class="diff-html-added" id="added-diff-17">Registering a FieldType</span></h2><p><span class="diff-html-added">To register a FieldType, see </span><a class="confluence-link unresolved" href="#"><span class="diff-html-added">Register FieldType</span></a><span class="diff-html-added">.</span></p><p><span class="diff-html-added">To be integrated in unit and integration tests, FieldTypes need to be registered through the </span><code><span class="diff-html-added">service.ini</span></code><span class="diff-html-added"> in </span><code><span class="diff-html-added">eZ/Publish/Core/settings</span></code><span class="diff-html-added">.</span></p><h2 id="FieldTypeAPIandbestpractices-Templating"><span class="diff-html-added">Templating</span></h2><p><span class="diff-html-added">A FieldType always need a piece of template to be correctly displayed. See </span><a class="confluence-link unresolved" href="#"><span class="diff-html-added">FieldType template</span></a><span class="diff-html-added">.</span></p></div></div><h2 id="FieldTypeAPIandbestpractices-Testing" class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-19">Testing</span></h2><p class="diff-block-context"><code>FieldType</code> s should be integration tested on 1 different levels:</p><p class="diff-context-placeholder">...</p><p class="diff-block-context">For both test environments, infrastructure is already in place, so that you can easily implement the required tests for your custom <code>FieldType</code></p><div class="section diff-block-target diff-block-context"><h3 id="FieldTypeAPIandbestpractices-PersistenceSPI"><span class="diff-html-changed" id="changed-diff-20">Persistence SPI</span></h3><p>This type of integration test ensures, that a FieldType stores its data properly on basis of different Persistence SPI implementations.</p><div class="note"><p> </p><table class="diff-macro"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/images/icons/macrobrowser/dropdown/info.png);"> </span>Info</th></tr></thead><tbody><tr><td class="diff-macro-body"><strong>Note:</strong> By now, only the Legacy Storage implementation exists.</td></tr></tbody></table><p> </p></div><p>The integration tests with the Persistence SPI can be found in <code>eZ\Publish\SPI\Tests\FieldType</code>. In order to implement a test for your custom <code>FieldType</code>, you need to extend the common base class <code>eZ\Publish\SPI\Tests\FieldType\BaseIntegrationTest</code> and implement it's abstract methods. As a reference the <code>KeywordIntegrationTest</code>, <code>UrlIntegrationTest</code> and <code>UserIntegrationTest</code> can deal.</p><p>Running the test is fairly simple: Just specify the global <code>phpunit.xml</code> for PHPUnit configuration and make it execute a single test or a directory of tests, for example:</p><table class="diff-macro"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>bash</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>$ phpunit -c phpunit.xml eZ/Publish/SPI/Tests/FieldType</pre></td></tr></tbody></table><p>in order to run all <code>FieldType</code> tests.</p></div><h3 id="FieldTypeAPIandbestpractices-PublicAPI" class="diff-block-target"><span class="diff-html-changed" id="changed-diff-21">Public API</span></h3><p class="diff-block-context">On a second level, the interaction between an implementation of the Public API (aka the Business Layer) and the FieldType is tested. Again, there is a common base class as the infrastructural basis for such tests, which resides in <code>eZ\Publish\API\Repository\Tests\FieldType\BaseIntegrationTest</code>.</p><p class="diff-context-placeholder">...</p>
</div>
    
    

            
</div>


    




    
    

    
    
    







</div>
  
        <div id="theme-footer">
            <div class="sectionColumnWrapper"><div class="sectionMacro">
<div class="sectionMacroRow"><div class="columnMacro"></div>
<div class="columnMacro">
<div class="panel" style="background-color: #ecf0f1;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #ecf0f1;">
<p>Where Content Means Business</p>
</div></div></div>
<div class="columnMacro"></div></div></div></div>
        </div>
    
    </div>
</div>


        
            <div id="footer">

    <section class="footer-body">

                                                <p class="license license-opensource">
                  Powered by a free <b>Atlassian Confluence Open Source Project License</b> granted to Exponential. <a href="http://www.atlassian.com/c/conf/11461">Evaluate Confluence today</a>.<br>
                </p>
                        
    

    <ul id="poweredby">
        <li class="noprint">Powered by <a href="http://www.atlassian.com/software/confluence" class="hover-footer-link">Atlassian Confluence</a> <span id='footer-build-information'>5.4.4</span>, <a href="http://www.atlassian.com/software/confluence/overview/team-collaboration-software?utm_source=confluence-footer" class="hover-footer-link">Team Collaboration Software</a></li>
        <li class="print-only">Printed by Atlassian Confluence 5.4.4, Team Collaboration Software.</li>
        <li class="noprint"><a href="http://jira.atlassian.com/secure/BrowseProject.jspa?id=10470" class="hover-footer-link">Report a bug</a></li>
        <li class="noprint"><a href="http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch" class="hover-footer-link">Atlassian News</a></li>
    </ul>

    

            <script>
AJS.toInit(function(){
 if(AJS.params.spaceKey &&
    AJS.params.spaceKey === 'MAIN' ||
    AJS.params.spaceKey === 'EZMA' ||
    AJS.params.spaceKey === 'ODC' ||
    AJS.params.spaceKey === 'EZP50' ||
    AJS.params.spaceKey === 'EZP51' ||
    AJS.params.spaceKey === 'EZP52' ||
    AJS.params.spaceKey === 'EZPCLOUD' ||
    AJS.params.spaceKey === 'EZP' ||
    AJS.params.spaceKey === 'EZRECO'
){

(function()
{var isSecure=('https:'==document.location.protocol);var ff=document.createElement('script');ff.type='text/javascript';ff.async=true;ff.src=(isSecure?'https':'http')+'://'+(isSecure?'secure.':'lb.')+'liveviewer.ez.no/statjs/sst-120-1304513615/stat.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ff,s);}
)();

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-303624-13', 'ez.no');
  ga('send', 'pageview');
}}
);
</script>
    
    </section>

</div>

            
    </div>
</body>

<!-- Mirrored from doc.ez.no/pages/diffpagesbyversion.action?pageId=2719880&originalVersion=22&revisedVersion=38 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 18:34:59 GMT -->
</html>
