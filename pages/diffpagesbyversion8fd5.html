<!DOCTYPE html>
<html>

<!-- Mirrored from doc.ez.no/pages/diffpagesbyversion.action?pageId=30711527&selectedPageVersions=1&selectedPageVersions=2 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:01:20 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <title>Page Comparison - Implementing the Tweet\Type class (v.1 vs v.2) - TECHDOC - eZ Documentation</title>

        

                        
    
                        
    
                        
    

    <meta http-equiv="X-UA-Compatible" content="IE=EDGE,chrome=IE7">
<meta charset="UTF-8">
<meta id="confluence-context-path" name="confluence-context-path" content="">
<meta id="confluence-base-url" name="confluence-base-url" content="../index.html">

<meta id="atlassian-token" name="atlassian-token" content="9996d8127abd36d1b757536de859090f8b455d10">


<meta id="confluence-space-key" name="confluence-space-key" content="TECHDOC">
<script type="text/javascript">
        var contextPath = '';
</script>

    

    <meta name="robots" content="noindex,nofollow">
    <meta name="robots" content="noarchive">
    <meta name="confluence-request-time" content="1485852575165">
        
    
        
            <meta name="ajs-is-space-admin" content=""> <meta name="ajs-has-space-config" content="">
            <meta name="ajs-use-keyboard-shortcuts" content="true">
            <meta name="ajs-discovered-plugin-features" content="$discoveredList">
            <meta name="stp-license-product-name" content="Confluence"/> <meta name="stp-license-days-to-expiry" content="807"/> <meta name="stp-license-is-admin" content="false"/> <meta name="stp-license-should-keep-banner-hidden" content="true"/>
            <meta name="ajs-keyboardshortcut-hash" content="206314443b3cf79696d4ad89324a059c">
            <meta id="team-calendars-has-jira-link" content="true">
            <meta name="ajs-team-calendars-display-time-format" content="displayTimeFormat12">
            <meta id="team-calendars-user-timezone" content="UTC">
            <script type="text/x-template" id="team-calendars-messages" title="team-calendars-messages"><fieldset class="i18n hidden"><input type="hidden" name="calendar3.month.long.july" value="July"><input type="hidden" name="calendar3.day.short.wednesday" value="Wed"><input type="hidden" name="calendar3.day.short.thursday" value="Thu"><input type="hidden" name="calendar3.month.short.march" value="Mar"><input type="hidden" name="calendar3.month.long.april" value="April"><input type="hidden" name="calendar3.month.long.october" value="October"><input type="hidden" name="calendar3.month.long.august" value="August"><input type="hidden" name="calendar3.month.short.july" value="Jul"><input type="hidden" name="calendar3.month.short.may" value="May"><input type="hidden" name="calendar3.month.short.november" value="Nov"><input type="hidden" name="calendar3.day.long.friday" value="Friday"><input type="hidden" name="calendar3.day.long.sunday" value="Sunday"><input type="hidden" name="calendar3.day.long.saturday" value="Saturday"><input type="hidden" name="calendar3.month.short.april" value="Apr"><input type="hidden" name="calendar3.day.long.wednesday" value="Wednesday"><input type="hidden" name="calendar3.month.long.december" value="December"><input type="hidden" name="calendar3.month.short.october" value="Oct"><input type="hidden" name="calendar3.day.long.monday" value="Monday"><input type="hidden" name="calendar3.month.short.june" value="Jun"><input type="hidden" name="calendar3.day.short.monday" value="Mon"><input type="hidden" name="calendar3.day.short.tuesday" value="Tue"><input type="hidden" name="calendar3.day.short.saturday" value="Sat"><input type="hidden" name="calendar3.month.long.march" value="March"><input type="hidden" name="calendar3.month.long.june" value="June"><input type="hidden" name="calendar3.month.short.february" value="Feb"><input type="hidden" name="calendar3.month.short.august" value="Aug"><input type="hidden" name="calendar3.month.short.december" value="Dec"><input type="hidden" name="calendar3.day.short.sunday" value="Sun"><input type="hidden" name="calendar3.month.long.february" value="February"><input type="hidden" name="calendar3.day.long.tuesday" value="Tuesday"><input type="hidden" name="calendar3.month.long.may" value="May"><input type="hidden" name="calendar3.month.long.september" value="September"><input type="hidden" name="calendar3.month.long.november" value="November"><input type="hidden" name="calendar3.month.short.january" value="Jan"><input type="hidden" name="calendar3.month.short.september" value="Sep"><input type="hidden" name="calendar3.day.long.thursday" value="Thursday"><input type="hidden" name="calendar3.month.long.january" value="January"><input type="hidden" name="calendar3.day.short.friday" value="Fri"></fieldset></script>
            <meta name="ajs-is-confluence-admin" content="false">
            <meta name="ajs-connection-timeout" content="10000">
            
    
    
            <meta name="ajs-page-id" content="30711527">
            <meta name="ajs-latest-page-id" content="30711527">
            <meta name="ajs-content-type" content="page">
            <meta name="ajs-page-title" content="Implementing the Tweet\Type class">
            <meta name="ajs-parent-page-title" content="Field Type Tutorial">
            <meta name="ajs-parent-page-id" content="30711519">
            <meta name="ajs-space-key" content="TECHDOC">
            <meta name="ajs-space-name" content="TECHDOC">
            <meta name="ajs-from-page-title" content="">
            <meta name="ajs-can-remove-page" content="false">
            <meta name="ajs-context-path" content="">
            <meta name="ajs-base-url" content="https://doc.ez.no">
            <meta name="ajs-version-number" content="5.8.5">
            <meta name="ajs-build-number" content="5983">
            <meta name="ajs-remote-user" content="">
            <meta name="ajs-remote-user-key" content="">
            <meta name="ajs-current-user-fullname" content="">
            <meta name="ajs-current-user-avatar-url" content="">
            <meta name="ajs-static-resource-url-prefix" content="/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_">
            <meta name="ajs-global-settings-attachment-max-size" content="10485760">
            <meta name="ajs-user-locale" content="en_GB">
            <meta name="ajs-enabled-dark-features" content="confluence-inline-comments-resolved,notification.plugin.api.enabled.com.atlassian.confluence.plugins.sharepage.api.ShareContentEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.mentions.api.ConfluenceMentionEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.security.ForgotPasswordEvent,pdf-preview,notification.plugin.api.enabled.com.atlassian.confluence.plugins.tasklist.event.SendTaskEmailEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.page.async.PageMovedEvent,previews.sharing,previews.versions,notification.plugin.api.enabled.com.atlassian.confluence.plugins.files.notifications.event.FileContentUpdateEvent,file-annotations,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.attachment.AttachmentBatchUploadCompletedEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.comment.CommentCreateEvent,notification.plugin.api.enabled.com.atlassian.confluence.efi.emails.events.OnboardingLessUsersEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.files.notifications.event.FileContentRemoveEvent,atlassian.aui.raphael.disabled,previews.conversion-service,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.comment.CommentUpdateEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.follow.FollowEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.page.async.PageEditedEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.blogpost.BlogPostCreateEvent,previews.trigger-all-file-types,notification.plugin.api.enabled.com.atlassian.confluence.plugins.inlinecomments.events.InlineCommentResolveEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.like.LikeCreatedEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.inlinecomments.events.InlineCommentCreateEvent,previews.sharing.pushstate,confluence-inline-comments-rich-editor,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.blogpost.BlogPostUpdateEvent,file-annotations.likes,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.page.async.PageCreatedEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.files.notifications.event.FileContentMentionUpdateEvent,notification.plugin.api.enabled.com.atlassian.confluence.efi.emails.events.OnboardingNoSpaceCreatedEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.hipchat.api.events.HipChatUserMapped,notification.plugin.api.enabled.com.atlassian.confluence.plugins.sharepage.api.ShareAttachmentEvent,confluence-inline-comments,confluence-inline-comments-dangling-comment,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.blogpost.BlogPostMovedEvent">
            <meta name="ajs-atl-token" content="9996d8127abd36d1b757536de859090f8b455d10">
            <meta name="ajs-confluence-flavour" content="VANILLA">
            <meta name="ajs-user-date-pattern" content="dd MMM yyyy">
            <meta name="ajs-date.format" content="MMM dd, yyyy">
    
    <link rel="shortcut icon" href="https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/favicon.ico">

<link rel="search" type="application/opensearchdescription+xml" href="https://doc.ez.no/opensearch/osd.action" title="eZ Documentation"/>

<script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-nps-plugin:atlassian-nps-plugin-resources.is-server-instance-data-provider"]="true";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-license-banner:confluence-license-banner-resources.license-details"]="{\"daysBeforeLicenseExpiry\":0,\"daysBeforeMaintenanceExpiry\":0,\"showLicenseExpiryBanner\":false,\"showMaintenanceExpiryBanner\":false,\"renewUrl\":null,\"salesEmail\":null}";
WRM._unparsedData["com.atlassian.plugins.atlassian-nps-plugin:nps-acknowledgement-resources.analytics-enabled-data-provider"]="\"false\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-nps-plugin:nps-acknowledgement-resources.sen-data-provider"]="\"SEN-2255945\"";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-feature-discovery-plugin:confluence-feature-discovery-plugin-resources.test-mode"]="false";
</script>
<link type="text/css" rel="stylesheet" href="https://doc.ez.no/s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="https://doc.ez.no/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f10c36425b731f08af1bde9c7e745307/_/download/contextbatch/css/pagediffs/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f10c36425b731f08af1bde9c7e745307/_/download/contextbatch/css/pagediffs/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="https://doc.ez.no/s/e07f58c44d24a6e17f8354bdec890e2f-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8d89db3a01c02cb5eb7fc39a28427136/_/download/contextbatch/css/atl.confluence.plugins.pagetree-desktop,main,atl.general,page/batch.css?flavour=VANILLA" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8d89db3a01c02cb5eb7fc39a28427136/_/download/contextbatch/css/atl.confluence.plugins.pagetree-desktop,main,atl.general,page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/7893b9affdc3bf828ad93d0610d3d5f3-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8d89db3a01c02cb5eb7fc39a28427136/_/download/contextbatch/css/atl.confluence.plugins.pagetree-desktop,main,atl.general,page/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="https://doc.ez.no/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/3a21f7b21af4c67045d1e0255f2ac570/_/download/contextbatch/css/theme.doc/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/colors.css?spaceKey=TECHDOC" media="all">
<link type="text/css" rel="stylesheet" href="https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/custom.css?spaceKey=TECHDOC" media="all">
<script type="text/javascript" src="https://doc.ez.no/s/1f7b22082ef39a4bb134622dae929bdc-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/js/batch.js?atlassian.aui.raphael.disabled=true&amp;locale=en-GB&amp;build-number=5983" ></script>
<script type="text/javascript" src="https://doc.ez.no/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f10c36425b731f08af1bde9c7e745307/_/download/contextbatch/js/pagediffs/batch.js" ></script>
<script type="text/javascript" src="https://doc.ez.no/s/1cb5afbbf3aea39263d8912ec2a029e3-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8d89db3a01c02cb5eb7fc39a28427136/_/download/contextbatch/js/atl.confluence.plugins.pagetree-desktop,main,atl.general,page/batch.js?locale=en-GB&amp;flavour=VANILLA&amp;anonymous-access-enabled=true&amp;is-server-instance=true&amp;hostenabled=true" ></script>


        
            <meta name="stp-license-product-name" content="Confluence"/> <meta name="stp-license-days-to-expiry" content="807"/> <meta name="stp-license-is-admin" content="false"/> <meta name="stp-license-should-keep-banner-hidden" content="true"/>
    

        
    
    

    
                <link rel="canonical" href="https://doc.ez.no/pages/viewpage.action?pageId=30711527">
        <link rel="shortlink" href="https://doc.ez.no/x/557UAQ">
    <meta name="wikilink" content="[TECHDOC:Implementing the Tweet\Type class]">
    <meta name="page-version" content="2">

</head>

<body             onload="placeFocus()"
     id="com-atlassian-confluence" class="theme-documentation  aui-theme-default aui-layout">

        
            <div id='stp-licenseStatus-banner'></div>
    <div id="full-height-container">
    <div id="header-precursor">
        
                    </div>






<header id="header" role="banner">
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation"><div class="aui-header-inner"><div class="aui-header-before"><a class=" aui-dropdown2-trigger app-switcher-trigger" aria-owns="app-switcher" aria-controls="app-switcher" aria-haspopup="true" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a><div id="app-switcher" class="aui-dropdown2 aui-style-default"><div class="app-switcher-loading">Loading&hellip;</div></div><script>
            (function (NL) {
                var initialise = function () {
                    // For some milestones of AUI, the atlassian soy namespace was renamed to aui. Handle that here by ensuring that window.atlassian is defined.
                    window.atlassian = window.atlassian || window.aui;
                    new NL.AppSwitcher({
                        dropdownContents: '#app-switcher'
                    });
                };
                if (NL.AppSwitcher) {
                    initialise();
                } else {
                    NL.onInit = initialise;
                }
            }(window.NL = (window.NL || {})));
            window.NL.isUserAdmin = false</script></div><div class="aui-header-primary"><h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://doc.ez.no/"><img src="https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/images/logo/confluence-logo.png" alt="eZ Documentation" /></a></h1><ul class="aui-nav">
                            <li>
            
        
        
<a  id="space-directory-link" href="https://doc.ez.no/spacedirectory/view.action"  class=" aui-nav-imagelink"   title="Spaces">
            <span>Spaces</span>
    </a>
        </li>
                            <li id="browseMenu" role="menu">
            
    
        <a id="browse-menu-link" class="aui-nav-link aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-owns="browse-menu-link-content" title="Browse">
        <span class="browse">Browse</span>
    </a>
    <nav id="browse-menu-link-content" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                    <div class="aui-dropdown2-section">
                                <ul  id="browse-menu-link-leading" class="aui-list-truncate section-leading first">
                                            <li>
    
            
<a  id="space-pages-link" href="https://doc.ez.no/pages/listpages.action?key=TECHDOC" class="    "      title="Browse pages in the TECHDOC space" >
        Pages
</a>
</li>
                                            <li>
    
            
<a  id="space-blogposts-link" href="https://doc.ez.no/pages/viewrecentblogposts.action?key=TECHDOC" class="    "      title="Browse blogs in the TECHDOC space" >
        Blog
</a>
</li>
                                            <li>
    
            
<a  id="space-labels-link" href="https://doc.ez.no/labels/listlabels-heatmap.action?key=TECHDOC" class="    "      title="Browse labels in the TECHDOC space" >
        Labels
</a>
</li>
                                            <li>
    
            
<a  id="space-advanced-link" href="https://doc.ez.no/spaces/viewspacesummary.action?key=TECHDOC" class="    "      title="Browse additional space functions in the TECHDOC space" >
        Space Operations
</a>
</li>
                                    </ul>
            </div>
            </nav>
    
        </li>
        </ul>
</div><div class="aui-header-secondary"><ul class="aui-nav">
                        <li>
        <form id="quick-search" class="aui-quicksearch dont-default-focus header-quicksearch" action="https://doc.ez.no/dosearchsite.action" method="get"><fieldset><input type="hidden" name="where" value="TECHDOC"/><input type="hidden" name="spaceSearch" value="true"/><label for="quick-search-query" class="assistive">Quick Search</label><input id="quick-search-query" class="text app-search search quick-search-query" type="text" accessKey="q" autocomplete="off" name="queryString" title="Quick Search" placeholder="Search space" /><input id="quick-search-submit" class="quick-search-submit" type="submit" value="Search"/><div class="aui-dd-parent quick-nav-drop-down"></div></fieldset></form>
    </li>
        <li>
            
        <a id="help-menu-link" class="aui-nav-link aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-owns="help-menu-link-content" title="Help">
        <span class="aui-icon aui-icon-small aui-iconfont-help">Help</span>
    </a>
    <nav id="help-menu-link-content" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                    <div class="aui-dropdown2-section">
                                <ul  id="help-menu-link-leading" class="aui-list-truncate section-leading first">
                                            <li>
        
            
<a  id="confluence-help-link" href="https://docs.atlassian.com/confluence/docs-58/Getting+Help+And+Support" class="    "      title="Visit the Confluence documentation home"  target="_blank"
>
        Online Help
</a>
</li>
                                            <li>
    
                
<a  id="keyboard-shortcuts-link" href="#" class="    "      title="View available keyboard shortcuts" >
        Keyboard Shortcuts
</a>
</li>
                                            <li>
    
            
<a  id="feed-builder-link" href="https://doc.ez.no/dashboard/configurerssfeed.action" class="    "      title="Create your custom RSS feed." >
        Feed Builder
</a>
</li>
                                            <li>
    
            
<a  id="whats-new-menu-link" href="https://docs.atlassian.com/confluence/docs-58/whatsnew/iframe" class="    "      title="" >
        What’s new
</a>
</li>
                                            <li>
    
                
<a  id="gadget-directory-link" href="#" class="   user-item administration-link "      title="Browse gadgets provided by Confluence" >
        Available Gadgets
</a>
</li>
                                            <li>
    
            
<a  id="confluence-about-link" href="https://doc.ez.no/aboutconfluencepage.action" class="    "      title="Get more information about Confluence" >
        About Confluence
</a>
</li>
                                    </ul>
            </div>
            </nav>
    
    </li>
        <li>
                
    
    </li>
        <li>
            
    </li>
        <li>
                                            <li>
        
            
<a  id="login-link" href="https://doc.ez.no/login.action?os_destination=%2Fpages%2Fdiffpagesbyversion.action%3FpageId%3D30711527%26selectedPageVersions%3D1%26selectedPageVersions%3D2" class="   user-item login-link "      title="" >
        Log in
</a>
</li>
                        
    </li>
    </ul>
</div></div><!-- .aui-header-inner--></nav><!-- .aui-header -->
    <br class="clear">
</header>

    <div id="splitter">
    <div id="splitter-sidebar"  class="padding-div" >
        
        <p>&nbsp;</p>
<h4><a name="ImplementingtheTweet\Typeclass-&amp;nbsp;General"></a>&nbsp; General</h4>
<p><font color="#999">&bull;</font>&nbsp;&nbsp;<a href="http://ez.no/" class="external-link" rel="nofollow">eZ Systems Website</a><br/>
<font color="#999">&bull;</font>&nbsp;&nbsp;<a href="http://doc.ez.no/display/DEVELOPER" class="external-link" rel="nofollow">Technical documentation</a><br/>
<font color="#999">&bull;</font>&nbsp;&nbsp;<a href="http://doc.ez.no/display/USER" class="external-link" rel="nofollow">Editor documentation</a></p>

<p>This Documentation contains:<br/>
&nbsp;<br/>
<a href="https://doc.ez.no/display/TECHDOC"><strong>Technical documentation:</strong></a></p>
    

                    
    


<div class="plugin_pagetree">

        
        
    <ul class="plugin_pagetree_children_list plugin_pagetree_children_list_noleftspace">
        <div class="plugin_pagetree_children">
        </div>
    </ul>

    <fieldset class="hidden">
        <input type="hidden" name="treeId" value="">
        <input type="hidden" name="treeRequestId" value="/plugins/pagetree/naturalchildren.action?decorator=none&amp;excerpt=false&amp;sort=position&amp;reverse=false&amp;disableLinks=false&amp;expandCurrent=false">
        <input type="hidden" name="treePageId" value="30711527">

        <input type="hidden" name="noRoot" value="false">
        <input type="hidden" name="rootPageId" value="30711113">

        <input type="hidden" name="rootPage" value="">
        <input type="hidden" name="startDepth" value="0">
        <input type="hidden" name="spaceKey" value="TECHDOC" >

        <input type="hidden" name="i18n-pagetree.loading" value="Loading...">
        <input type="hidden" name="i18n-pagetree.error.permission" value="Unable to load page tree. It seems that you do not have permission to view the root page.">
        <input type="hidden" name="i18n-pagetree.eeror.general" value="There was a problem retrieving the page tree. Please check the server log file for more information.">
        <input type="hidden" name="loginUrl" value="/login.action?os_destination=%2Fpages%2Fdiffpagesbyversion.action%3FpageId%3D30711527%26selectedPageVersions%3D1%26selectedPageVersions%3D2">
        <input type="hidden" name="mobile" value="false">

                <fieldset class="hidden">
                                                <input type="hidden" name="ancestorId" value="30711519">
                                    <input type="hidden" name="ancestorId" value="30711490">
                                    <input type="hidden" name="ancestorId" value="30711837">
                                    <input type="hidden" name="ancestorId" value="30711113">
                                    </fieldset>
    </fieldset>
</div>



            </div>
    <div id="splitter-content">

                    <script type="text/javascript" src="https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5.8.5/_/download/resources/com.atlassian.confluence.plugins.doctheme:resources/doc-theme.js"></script>
    
                        
        <div id="theme-header">
            <div class="sectionColumnWrapper"><div class="sectionMacro">
<div class="sectionMacroRow"><div class="columnMacro"></div>
<div class="columnMacro">
<div class="panel" style="background-color: #EDBB43;border-color: #F58220;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #EDBB43;">
<p><br class="atl-forced-newline" /> <br class="atl-forced-newline" />
<strong>⚠ WARNING ! This documentation is deprecated !</strong><br class="atl-forced-newline" /> <br class="atl-forced-newline" /> </p>
<h1><a name="ImplementingtheTweet\Typeclass-Pleasegoto[thecurrentTechnicalDocumentation|DEVELOPER:]\\\\"></a>Please go to <a href="https://doc.ez.no/display/DEVELOPER">the current Technical Documentation</a><br class="atl-forced-newline" /> <br class="atl-forced-newline" /></h1>
<p><span class="image-wrap" style=""><img src="https://doc.ez.no/download/attachments/30711113/smashingkeybrd.gif?version=1&amp;modificationDate=1464177849000&amp;api=v2" style="border: 0px solid black" /></span></p>
</div></div></div><div class="columnMacro"></div></div></div></div>
        </div>
    
            
<div id="main"  class="aui-page-panel" >
    <div id="main-header">
        
        
    <div id="navigation" class="content-navigation view-information">
                    <ul class="ajs-menu-bar">
                                                                    <li class="ajs-button normal">

        
        
                                            
    
    
    <a  id="viewPageLink" href="https://doc.ez.no/pages/viewpage.action?pageId=30711527" rel="nofollow" class="aui-button aui-button-subtle view"   title="">
                <span>
                            <span class="aui-icon aui-icon-small aui-iconfont-back-page"></span>
                        View Page
        </span>    </a>
</li>
                                
                    
        <li class="normal ajs-menu-item">
        <a id="action-menu-link" class="action aui-dropdown2-trigger-arrowless aui-button aui-button-subtle ajs-menu-title aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-owns="action-menu" data-container="#navigation">
            <span>
                                    <span class="aui-icon aui-icon-small aui-iconfont-more"></span>
                                
            </span>
        </a>         <div id="action-menu" class="aui-dropdown2 aui-style-default">
                            <ul  id="action-menu-primary"                     class="section-primary first aui-dropdown2-section">
                                            <li>

    
        
                                            
    
    
    <a  id="view-attachments-link" href="https://doc.ez.no/pages/viewpageattachments.action?pageId=30711527" rel="nofollow" class="action-view-attachments"  accessKey="t"  title="View Attachments">
                <span>
                        A<u>t</u>tachments (0)
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="action-view-history-link" href="https://doc.ez.no/pages/viewpreviousversions.action?pageId=30711527" rel="nofollow" class="action-view-history"   title="">
                <span>
                        Page History
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="action-page-permissions-link" href="https://doc.ez.no/pages/viewinfo.action?pageId=30711527" rel="nofollow" class="action-page-permissions"   title="Edit restrictions">
                <span>
                        Restrictions
        </span>    </a>
</li>
                                </ul>
                            <ul  id="action-menu-secondary"                     class="section-secondary aui-dropdown2-section">
                                            <li>

    
        
                                            
    
    
    <a  id="view-page-info-link" href="https://doc.ez.no/pages/viewinfo.action?pageId=30711527" rel="nofollow" class="action-view-info"   title="">
                <span>
                        Page Information
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="link-to-page-link" href="https://doc.ez.no/pages/viewinfo.action?pageId=30711527" rel="nofollow" class=""   title="Link to this Page">
                <span>
                        Link to this Page…
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="view-in-hierarchy-link" href="https://doc.ez.no/pages/listpages-dirview.action?key=TECHDOC&amp;openId=30711527#selectedPageInHierarchy" rel="nofollow" class=""   title="">
                <span>
                        View in Hierarchy
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="action-view-source-link" href="https://doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=30711527" rel="nofollow" class="action-view-source popup-link"   title="">
                <span>
                        View Source
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="action-export-pdf-link" href="https://doc.ez.no/spaces/flyingpdf/pdfpageexport.action?pageId=30711527" rel="nofollow" class=""   title="">
                <span>
                        Export to PDF
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="action-export-word-link" href="https://doc.ez.no/exportword?pageId=30711527" rel="nofollow" class="action-export-word"   title="">
                <span>
                        Export to Word
        </span>    </a>
</li>
                                </ul>
                    </div>
    </li>
            </ul>
    </div>

        
                <div id="title-heading" class="pagetitle with-breadcrumbs">
        
                            <div class="space-logo " data-key="TECHDOC" data-name="TECHDOC" data-entity-type="confluence.space">
            <a><img class="logo space custom" src="https://doc.ez.no/download/attachments/30711109/TECHDOC?version=1&amp;modificationDate=1449834628000&amp;api=v2" alt=""></a>
        </div>            
                            <div id="breadcrumb-section">
                    
    
    
    <ol id="breadcrumbs">
                                        
                        
        <li class="first" >
                        
                            <span class=""><a href="https://doc.ez.no/display/TECHDOC">TECHDOC</a></span>
                                                                                            <li id="ellipsis" title="Show all breadcrumbs"><span><strong>&#8230;</strong></span></li>
                                                
                        
        <li class="hidden-crumb" >
                        
                            <span class=""><a href="https://doc.ez.no/display/TECHDOC/eZ+Technical+Manual">eZ Technical Manual</a></span>
                                                                                    
                        
        <li class="hidden-crumb" >
                        
                            <span class=""><a href="https://doc.ez.no/display/TECHDOC/Cookbooks">Cookbooks</a></span>
                                                                                    
                        
        <li class="hidden-crumb" >
                        
                            <span class=""><a href="https://doc.ez.no/display/TECHDOC/Advanced+Tutorials">Advanced Tutorials</a></span>
                                                                                    
                        
        <li class="hidden-crumb" >
                        
                            <span class=""><a href="https://doc.ez.no/display/TECHDOC/Field+Type+Tutorial">Field Type Tutorial</a></span>
                                                                    
                        
        <li>
                        
                            <span class=""><a href="https://doc.ez.no/pages/viewpage.action?pageId=30711527">Implementing the Tweet\Type class</a></span>
                                                    </ol>


                </div>
            
            <h1 id="title-text" class="with-breadcrumbs">
                            Page History
                        </h1>
        </div>
    </div>

    

    
    
    
    
    

    

    
                
    
        




        




    

    

    







    
    
        
    
    
                    
    

    


<div id="content" class="page view-information">
    


<div id="action-messages">
                        </div>



        <script type="text/x-template" title="searchResultsGrid">
    <table class="aui">
        <thead>
            <tr class="header">
                <th class="search-result-title">Page Title</th>
                <th class="search-result-space">Space</th>
                <th class="search-result-date">Updated</th>
            </tr>
        </thead>
    </table>
</script>
<script type="text/x-template" title="searchResultsGridCount">
    <p class="search-result-count">{0}</p>
</script>
<script type="text/x-template" title="searchResultsGridRow">
    <tr class="search-result">
        <td class="search-result-title"><a href="{1}" class="content-type-{2}"><span>{0}</span></a></td>
        <td class="search-result-space"><a class="space" href="/display/{4}/" title="{3}">{3}</a></td>
        <td class="search-result-date"><span class="date" title="{6}">{5}</span></td>
    </tr>
</script>
        
    
    
                            
    
                        
                    <div class="diff-menu">
                <h2 class="diff-title">Versions Compared</h2>

                <div class="page-navigation section">
                                <div class="old page-version article">
                <h3 class="version-title">
                    <a class="page version-navigation view-historical-version-trigger" href="https://doc.ez.no/pages/viewpage.action?pageId=31425791">
                        <span class="assistive">Old Version</span>
                        <span class="version"> 1 </span>
                    </a>
                </h3>
                <p class="metadata author"><span class="assistive">changes.mady.by.user </span>    <a href="https://doc.ez.no/display/~dominika.kurek@ez.no"
                       class="url fn"
                            >Dominika Kurek</a></p>
                <p class="metadata modified"><span class="assistive">Saved on </span><time datetime="2015-11-06 10:25:50.0">Nov 06, 2015</time></p>
            </div>
        
                    <span class="assistive">compared with</span>

                                <div class="new page-version article">
                <h3 class="version-title">
                    <a class="page version-navigation" href="https://doc.ez.no/pages/viewpage.action?pageId=30711527">
                        <span class="assistive">New Version</span>
                        <span class="version"> Current </span>
                    </a>
                </h3>
                <p class="metadata author"><span class="assistive">changes.mady.by.user </span>    <a href="https://doc.ez.no/display/~dominika.kurek@ez.no"
                       class="url fn"
                            >Dominika Kurek</a></p>
                <p class="metadata modified"><span class="assistive">Saved on </span><time datetime="2016-02-01 13:00:32.0">Feb 01, 2016</time></p>
            </div>
        
                    <div class="diff-navigation nav">
                        <ul>
                                                                           <li><a class="all version-navigation" href="https://doc.ez.no/pages/viewpreviousversions.action?pageId=30711527">
                                <span>View Page History</span>
                           </a></li>
                        </ul>
                    </div>
                </div>

                        <div class="legend">
            <h2 class="legend-title">Key</h2>
            <ul>
                <li><span class="diff-html-added">This line was added.</span></li>
                <li><span class="diff-html-removed">This line was removed.</span></li>
                <li><span class="diff-html-changed">Formatting was changed.</span></li>
            </ul>
        </div>
    
                                    </div>
                                                                
    
<div id="page-diffs" class="wiki-content">
            <p class="diff-block-target diff-block-context">As said in the introduction, the Type class of a <span class="diff-html-removed" id="removed-diff-0">FieldType </span><span class="diff-html-added" id="added-diff-0">Field Type </span>must implement <code>eZ\Publish\SPI\FieldType\FieldType</code> (later referred to as "<span class="diff-html-removed" id="removed-diff-1">FieldType </span><span class="diff-html-added" id="added-diff-1">Field Type </span>interface").</p><p class="diff-block-target diff-block-context">All native <span class="diff-html-removed" id="removed-diff-2">FieldTypes </span><span class="diff-html-added" id="added-diff-2">Field Types </span>also extend the <code>eZ\Publish\Core\FieldType\FieldType</code> abstract class <span class="diff-html-removed" id="removed-diff-3">, </span>that implements this interface <span class="diff-html-removed" id="removed-diff-4">, </span>and provides implementation facilities through a set of abstract methods of its own. In this case, Type classes implement a mix of methods from the <span class="diff-html-removed" id="removed-diff-5">FieldType </span><span class="diff-html-added" id="added-diff-3">Field Type </span>interface and from the <span class="diff-html-removed" id="removed-diff-6">abstract FieldType </span><span class="diff-html-added" id="added-diff-4">abstract Field Type</span>.</p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-0">Let’s go over those methods and their implementation.</span></p><h4 id="ImplementingtheTweet\Typeclass-Identificationmethod:getFieldTypeIdentifier()" class="diff-block-context">Identification method: <code>getFieldTypeIdentifier()</code></h4><p class="diff-block-target"><span class="diff-html-changed" id="changed-diff-1">It must return the string that uniquely identifies this </span><span class="diff-html-removed" id="removed-diff-7">FieldType </span><span class="diff-html-added" id="added-diff-5">Field Type </span><span class="diff-html-changed" id="changed-diff-2">(DataTypeString in </span><span class="diff-html-removed" id="removed-diff-8">Exponential 4</span><span class="diff-html-added" id="added-diff-6">legacy</span><span class="diff-html-changed" id="changed-diff-3">). We will use "</span><code><span class="diff-html-changed">eztweet</span></code><span class="diff-html-changed">":</span></p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr><tr><th>title</th><td>eZ/FieldType/Tweet/Type</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>public function getFieldTypeIdentifier()
{
   return 'eztweet';
}</pre></td></tr></tbody></table><h4 id="ImplementingtheTweet\Typeclass-Valuehandlingmethods:createValueFromInput()andcheckValueStructure()" class="diff-block-context">Value handling methods: <code>createValueFromInput()</code> and <code>checkValueStructure()</code></h4><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-4">Both methods are used by the abstract </span><span class="diff-html-removed" id="removed-diff-9">FieldType </span><span class="diff-html-added" id="added-diff-7">Field Type </span><span class="diff-html-changed" id="changed-diff-5">implementation of </span><code>acceptValue()</code>. This <span class="diff-html-removed" id="removed-diff-10">FieldType interface method </span><span class="diff-html-added" id="added-diff-8">Field Type interface method </span><span class="diff-html-changed" id="changed-diff-6">checks and transforms various input values into the type's own Value class: </span><code><span class="diff-html-changed">eZ\FieldType\Tweet\Value</span></code><span class="diff-html-changed">. This method must:</span></p><ul class="diff-block-target diff-block-context"><li><span class="diff-html-changed" id="changed-diff-7">either return the Value object it was able to create out of the input value,</span></li><li><span class="diff-html-changed" id="changed-diff-8">or return this value untouched. The API will detect this </span><span class="diff-html-removed" id="removed-diff-11">, </span><span class="diff-html-changed" id="changed-diff-9">and inform that the input value was not accepted.</span></li></ul><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-10">The only acceptable value for our type is the URL of a tweet (we could of course imagine more possibilities). This should do:</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-11"> </span></p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>protected function createValueFromInput( $inputValue )
{
   if ( is_string( $inputValue ) )
   {
       $inputValue = new Value( array( 'url' =&gt; $inputValue ) );
   }
 
   return $inputValue;
}
</pre></td></tr></tbody></table><p class="diff-block-target diff-block-context"><br /><span class="diff-html-changed"> </span><span class="diff-html-changed" id="changed-diff-12">Use this method to provide convenient ways to set an attribute’s value using the API. This can be anything from primitives to complex business objects.</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-13">Next, we will implement </span><code><span class="diff-html-changed"> checkValueStructure()</span></code><span class="diff-html-changed">. It is called by the abstract </span><span class="diff-html-removed" id="removed-diff-12">FieldType </span><span class="diff-html-added" id="added-diff-9">Field Type </span><span class="diff-html-changed" id="changed-diff-14">to ensure that the Value fed to the Type is acceptable. In our case, we want to be sure that </span><code><span class="diff-html-changed">Tweet</span></code><span class="diff-html-changed"> </span><code><span class="diff-html-changed"> \Value::$url</span></code><span class="diff-html-changed"> is a string:</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-15"> </span></p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>protected function checkValueStructure( BaseValue $value )
{
   if ( !is_string( $value-&gt;url ) )
   {
       throw new eZ\Publish\Core\Base\Exceptions\InvalidArgumentType(
           '$value-&gt;url',
           'string',
           $value-&gt;url
       );
   }
}
</pre></td></tr></tbody></table><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-16">Yes, we execute the same check </span><span class="diff-html-removed" id="removed-diff-13">than </span><span class="diff-html-added" id="added-diff-10">as </span><span class="diff-html-changed" id="changed-diff-17">in </span><code><span class="diff-html-changed">createValueFromInput()</span></code><span class="diff-html-changed">. But both methods aren't responsible for the same thing. The first will, </span><em><span class="diff-html-changed">if given something else than a Value of its type</span></em><span class="diff-html-changed">, try to convert it to one. </span><code><span class="diff-html-changed">checkValueStructure()</span></code><span class="diff-html-changed"> will always be used, even if the </span><span class="diff-html-removed" id="removed-diff-14">FieldType </span><span class="diff-html-added" id="added-diff-11">Field Type </span><span class="diff-html-changed" id="changed-diff-18">is directly fed a </span><code><span class="diff-html-changed">Value</span></code><span class="diff-html-changed"> object, and not a string.</span></p><h4 id="ImplementingtheTweet\Typeclass-Valueinitialization:getEmptyValue()" class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-19">Value initialization: </span><code><span class="diff-html-changed">getEmptyValue()</span></code></h4><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-20">This method provides what is considered as an empty value of this type, depending on our business requirements. No extra initialization is required in our case.</span></p><p class="diff-block-context"> </p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>public function getEmptyValue()
{
   return new Value;
}</pre></td></tr></tbody></table><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-21">If you run the unit tests at this point, you should get about five failures, all of them on the </span><code><span class="diff-html-changed">fromHash()</span></code><span class="diff-html-changed"> or </span><code><span class="diff-html-changed"> toHash()</span></code><span class="diff-html-changed"> methods.</span></p><h4 id="ImplementingtheTweet\Typeclass-Validationmethods:validateValidatorConfiguration()andvalidate()" class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-22">Validation methods: </span><code><span class="diff-html-changed">validateValidatorConfiguration()</span></code><span class="diff-html-changed"> and </span><code><span class="diff-html-changed">validate()</span></code></h4><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-23">The Type class is also responsible for validating input data (to a </span><code><span class="diff-html-changed">Field</span></code><span class="diff-html-changed">), as well as configuration input data (to a </span><code><span class="diff-html-changed">FieldDefinition</span></code><span class="diff-html-changed">). In this tutorial, we will run two validation operations on input data:</span></p><ul class="diff-block-target diff-block-context"><li><p><span class="diff-html-changed" id="changed-diff-24">validate submitted urls, ensuring they actually reference a twitter status;</span></p></li><li><p><span class="diff-html-changed" id="changed-diff-25">limit input to a known list of authors, as an optional validation step.</span></p></li></ul><p class="diff-block-target diff-block-context"><code><span class="diff-html-changed"> </span><span class="diff-html-changed" id="changed-diff-26">validateValidatorConfiguration()</span></code><span class="diff-html-changed"> will be called when an instance of the </span><span class="diff-html-removed" id="removed-diff-15">FieldType </span><span class="diff-html-added" id="added-diff-12">Field Type </span><span class="diff-html-changed" id="changed-diff-27">is added to a </span><span class="diff-html-removed" id="removed-diff-16">ContentType</span><span class="diff-html-added" id="added-diff-13">Content Type</span><span class="diff-html-changed" id="changed-diff-28">, to ensure that the validator configuration is valid. For a TextLine (length validation), it means checking that both min length and max length are positive integers, and that min is lower than max.</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-29">When an instance of the type is added to a </span><span class="diff-html-removed" id="removed-diff-17">content type</span><span class="diff-html-added" id="added-diff-14">Content Type</span><span class="diff-html-changed" id="changed-diff-30">, </span><code><span class="diff-html-changed" id="changed-diff-31">validateValidatorConfiguration()</span></code><span class="diff-html-removed" id="removed-diff-18"> receives </span><span class="diff-html-added" id="added-diff-15"> receives </span><span class="diff-html-changed" id="changed-diff-32">the configuration for the validators used by the Type as an array. </span><span class="diff-html-changed" id="changed-diff-33">It must return an array of error messages if errors are found in the configuration, and an empty array if no errors were found.</span></p><p class="diff-block-target diff-block-context"><span style="color: rgb(0,0,0);"><span class="diff-html-removed" id="removed-diff-19"> </span></span><span class="diff-html-changed" id="changed-diff-34">For TextLine, the provided array looks like this:</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-35"> </span></p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>array(
   'StringLengthValidator' =&gt; array(
       'minStringLength' =&gt; 0,
       'maxStringLength' =&gt; 100
   )
);
</pre></td></tr></tbody></table><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-36">The structure of this array is totally free, and up to each type implementation. We will in this tutorial mimic what is done in native </span><span class="diff-html-removed" id="removed-diff-20">FieldTypes</span><span class="diff-html-added" id="added-diff-16">Field Types</span><span class="diff-html-changed" id="changed-diff-37">:</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-38">Each level one key is the name of a validator, as acknowledged by the Type. That key contains a set of parameter name / parameter value rows. We must check that:</span></p><ul class="diff-block-target diff-block-context"><li><p><span class="diff-html-changed" id="changed-diff-39">all the validators in this array are known to the type</span></p></li><li><p><span class="diff-html-changed" id="changed-diff-40">arguments for those validators are valid and have sane values</span></p></li></ul><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-41">We do not need to include mandatory validators if they don’t have options. Here is an example of what our Type expects as validation configuration:</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-42"> </span></p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>array(
   ‘TweetAuthorValidator’ =&gt; array(
       ‘AuthorList’ =&gt; array( ‘johndoe’, ‘janedoe’ )
   )
);
</pre></td></tr></tbody></table><p class="diff-block-target diff-block-context"><br /><span class="diff-html-changed"> </span><span class="diff-html-changed" id="changed-diff-43">The configuration says that tweets must be either by johndoe or by janedoe. If we had not provided TweetAuthorValidator at all, it would have been ignored.</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-44">We will iterate over the items in </span><code><span class="diff-html-changed">$validatorConfiguration</span></code><span class="diff-html-removed" id="removed-diff-21">, </span><span class="diff-html-changed" id="changed-diff-45">and:</span></p><ul class="diff-block-target diff-block-context"><li><p><span class="diff-html-changed" id="changed-diff-46">add errors for those we don’t know about;</span></p></li><li><p><span class="diff-html-changed" id="changed-diff-47">check that provided arguments are known and valid:</span></p></li><ul><li><p><span class="diff-html-changed" id="changed-diff-48">TweetAuthorValidator accepts a non-empty array of valid </span><span class="diff-html-removed" id="removed-diff-22">twitter </span><span class="diff-html-added" id="added-diff-17">Twitter </span><span class="diff-html-changed" id="changed-diff-49">usernames</span></p></li></ul></ul><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-50"> </span></p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>public function validateValidatorConfiguration( $validatorConfiguration )
{
   $validationErrors = array();

   foreach ( $validatorConfiguration as $validatorIdentifier =&gt; $constraints )
   {
       // Report unknown validators
       if ( !$validatorIdentifier != 'TweetAuthorValidator' )
       {
           $validationErrors[] = new ValidationError( "Validator '$validatorIdentifier' is unknown" );
           continue;
       }
 
       // Validate arguments from TweetAuthorValidator
       if ( !isset( $constraints['AuthorList'] ) || !is_array( $constraints['AuthorList'] ) )
       {
           $validationErrors[] = new ValidationError( "Missing or invalid AuthorList argument" );
           continue;
       }
 
       foreach ( $constraints['AuthorList'] as $authorName )
       {
           if ( !preg_match( '/^[a-z0-9_]{1,15}$/i', $authorName ) )
           {
               $validationErrors[] = new ValidationError( "Invalid twitter username" );
           }
       }
   }

 
   return $validationErrors;
}</pre></td></tr></tbody></table><p class="diff-block-target diff-block-context"><code><span class="diff-html-changed"> </span><span class="diff-html-changed" id="changed-diff-51">validate()</span></code><span class="diff-html-changed"> is the method that runs the actual validation on data, when a content item is created with a </span><span class="diff-html-removed" id="removed-diff-23">field </span><span class="diff-html-added" id="added-diff-18">Field </span><span class="diff-html-changed" id="changed-diff-52">of this type:</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-53"> </span></p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>   public function validate( FieldDefinition $fieldDefinition, SPIValue $fieldValue )
   {
       $errors = array();

       if ( $this-&gt;isEmptyValue( $fieldValue ) )
       {
           return $errors;
       }
 
       // Tweet Url validation
       if ( !preg_match( '#^https?://twitter.com/([^/]+)/status/[0-9]+$#', $fieldValue-&gt;url, $m ) )
           $errors[] = new ValidationError( "Invalid twitter status url %url%", null, array( $fieldValue-&gt;url ) );

       $validatorConfiguration = $fieldDefinition-&gt;getValidatorConfiguration();
       if ( isset( $validatorConfiguration['TweetAuthorValidator'] ) )
       {
           if ( !in_array( $m[1], $validatorConfiguration['TweetAuthorValidator']['AuthorList'] ) )
           {
               $errors[] = new ValidationError(
                   "Twitter user %user% is not in the approved author list",
                   null,
                   array( $m[1] )
               );
           }
       }
 
       return $errors;
   }
</pre></td></tr></tbody></table><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-54">First, we validate the url with a regular expression. If it doesn’t match, we add an instance of </span><code><span class="diff-html-changed"> ValidationError </span></code><span class="diff-html-changed"> to the return array. Note that the tested value isn’t directly embedded in the message but passed as an argument. This ensures that the variable is properly encoded in order to prevent attacks, and allows for singular/plural phrases using the </span><span class="diff-html-removed" id="removed-diff-24">2nd </span><span class="diff-html-added" id="added-diff-19">second </span><span class="diff-html-changed" id="changed-diff-55">parameter.</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-56">Then, if our </span><span class="diff-html-removed" id="removed-diff-25">FieldType </span><span class="diff-html-added" id="added-diff-20">Field Type </span><span class="diff-html-changed" id="changed-diff-57">instance’s configuration contains a </span><code><span class="diff-html-changed"> TweetAuthorValidator </span></code><span class="diff-html-changed"> key, we check that the username in the status url matches one of the valid authors.</span></p><h4 id="ImplementingtheTweet\Typeclass-Metadatahandlingmethods:getName()andgetSortInfo()." class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-58">Metadata handling methods: </span><code><span class="diff-html-changed">getName()</span></code><span class="diff-html-changed"> and </span><code><span class="diff-html-changed">getSortInfo()</span></code><span class="diff-html-changed">.</span></h4><p class="diff-block-target diff-block-context"><span class="diff-html-removed" id="removed-diff-26">FieldTypes </span><span class="diff-html-added" id="added-diff-21">Field Types </span><span class="diff-html-changed" id="changed-diff-59">require two methods related to Field metadata:</span></p><ul class="diff-block-target diff-block-context"><li><p><code><span class="diff-html-changed"> </span><span class="diff-html-changed" id="changed-diff-60">getName() </span></code><span class="diff-html-changed"> is used to generate a name out of a </span><span class="diff-html-removed" id="removed-diff-27">field </span><span class="diff-html-added" id="added-diff-22">Field </span><span class="diff-html-changed" id="changed-diff-61">value, either to name a </span><span class="diff-html-removed" id="removed-diff-28">content </span><span class="diff-html-added" id="added-diff-23">Content </span><span class="diff-html-changed" id="changed-diff-62">item (naming pattern in legacy) or to generate a part for an URL Alias.</span></p></li><li><p><code><span class="diff-html-changed"> </span><span class="diff-html-changed" id="changed-diff-63">getSortInfo() </span></code><span class="diff-html-changed"> is used by the persistence layer to obtain the value it can use to sort &amp; filter on a </span><span class="diff-html-removed" id="removed-diff-29">field </span><span class="diff-html-added" id="added-diff-24">Field </span><span class="diff-html-changed" id="changed-diff-64">of this type</span></p></li></ul><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-65">Obviously, a tweet’s full URL isn’t really suitable as a name. Let’s use a subset of it: </span><code><span class="diff-html-changed"> &lt;username&gt;-&lt;tweetId&gt; </span></code><span class="diff-html-changed"> should be reasonable enough, and suitable for both sorting and naming.</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-added" id="added-diff-25"> </span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-66">We can assume that this method will not be called if the </span><span class="diff-html-removed" id="removed-diff-30">field </span><span class="diff-html-added" id="added-diff-26">Field </span><span class="diff-html-changed" id="changed-diff-67">is empty, and will assume that the URL is a valid twitter URL:</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-68"> </span></p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>public function getName( SPIValue $value )
{
   return preg_replace(
       '#^https?://twitter\.com/([^/]+)/status/([0-9]+)$#',
       '$1-$2',
       (string)$value-&gt;url );
}

 
protected function getSortInfo( CoreValue $value )
{
   return $this-&gt;getName( $value );
}</pre></td></tr></tbody></table><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-69">In </span><code><span class="diff-html-changed"> getName()</span></code><span class="diff-html-removed" id="removed-diff-31">, </span><span class="diff-html-changed" id="changed-diff-70">we run a regular expression replace on the URL to extract the part we’re interested in.</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-71">This name is a perfect match for </span><code><span class="diff-html-changed"> getSortInfo()</span></code><span class="diff-html-removed" id="removed-diff-32">, </span><span class="diff-html-changed" id="changed-diff-72">as it allows us to sort on the tweet’s author and on the tweet’s ID.</span></p><h4 id="ImplementingtheTweet\Typeclass-FieldTypeserializationmethods:fromHash()andtoHash()" class="diff-block-target diff-block-context"><span class="diff-html-removed" id="removed-diff-33">FieldType </span><span class="diff-html-added" id="added-diff-27">Field Type </span><span class="diff-html-changed" id="changed-diff-73">serialization methods: </span><code><span class="diff-html-changed">fromHash()</span></code><span class="diff-html-changed"> and </span><code><span class="diff-html-changed">toHash()</span></code></h4><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-74">Both methods </span><span class="diff-html-removed" id="removed-diff-34">, </span><span class="diff-html-changed" id="changed-diff-75">defined in the </span><span class="diff-html-removed" id="removed-diff-35">FieldType </span><span class="diff-html-added" id="added-diff-28">Field Type </span><span class="diff-html-changed" id="changed-diff-76">interface, are core to the REST API. They are used to export values to serializable hashes.</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-77">In our case, it is quite easy:</span></p><ul class="diff-block-target diff-block-context"><li><p><code><span class="diff-html-changed"> </span><span class="diff-html-changed" id="changed-diff-78">toHash() </span></code><span class="diff-html-changed"> will build a hash with every property from </span><code><span class="diff-html-changed">Tweet\Value</span></code><span class="diff-html-changed">;</span></p></li><li><p><code><span class="diff-html-changed"> </span><span class="diff-html-changed" id="changed-diff-79">fromHash() </span></code><span class="diff-html-changed"> will instantiate a </span><code><span class="diff-html-changed">Tweet\Value</span></code><span class="diff-html-changed"> with the hash it receives. </span><span class="diff-html-changed" id="changed-diff-80"> </span></p></li></ul><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-81"> </span></p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>public function fromHash( $hash )
{
   if ( $hash === null )
   {
       return $this-&gt;getEmptyValue();
   }
   return new Value( $hash );
}
 
public function toHash( SPIValue $value )
{
   if ( $this-&gt;isEmptyValue( $value ) )
   {
       return null;
   }
   return array(
       'url' =&gt; $value-&gt;url
   );
}
</pre></td></tr></tbody></table><h4 id="ImplementingtheTweet\Typeclass-Persistencemethods:fromPersistenceValueandtoPersistenceValue" class="diff-block-context">Persistence methods: <code>fromPersistenceValue</code> and <code>toPersistenceValue</code></h4><p class="diff-block-target diff-block-context">Storage of <span class="diff-html-removed" id="removed-diff-36">fieldType </span><span class="diff-html-added" id="added-diff-29">Field Type </span>data is done through the persistence layer (SPI).</p><p class="diff-block-target diff-block-context"><span class="diff-html-removed" id="removed-diff-37">FieldTypes </span><span class="diff-html-added" id="added-diff-30">Field Types </span>use their own Value objects to expose their contents using their own domain language. However, to store those objects, the Type needs to map this custom object to a structure understood by the persistence layer: <code>PersistenceValue</code>. This simple value object has three properties:</p><ul style="list-style-type: square;" class="diff-block-target"><li><code>data</code><span class="diff-html-removed" id="removed-diff-38"> standard </span><span class="diff-html-added" id="added-diff-31">– standard </span>data, stored using the storage engine's native features</li><li><code>externalData</code><span class="diff-html-removed" id="removed-diff-39"> external </span><span class="diff-html-added" id="added-diff-32">– external </span>data, stored using a custom storage handler</li><li><code>sortKey</code><span class="diff-html-removed" id="removed-diff-40"> sort </span><span class="diff-html-added" id="added-diff-33">– sort </span>value used for sorting</li></ul><p class="diff-block-target diff-block-context">The role of those mapping methods is to convert a <code>Value</code> of the <span class="diff-html-removed" id="removed-diff-41">FieldType </span><span class="diff-html-added" id="added-diff-34">Field Type </span>into a <code>PersistenceValue</code><span class="diff-html-removed" id="removed-diff-42">, </span>and the other way around.</p><table class="diff-macro diff-block-target"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/images/icons/macrobrowser/dropdown/info.png);"> </span>Info</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>title</th><td><span class="diff-html-removed" id="removed-diff-43">"</span>About external storage<span class="diff-html-removed" id="removed-diff-44">"</span></td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><p>Whatever is stored in {{<span class="diff-html-changed" id="changed-diff-82">externalData}} requires an external storage handler to be written. Read more about external storage on </span><a href="https://doc.ez.no/pages/viewpage.action?pageId=30711144"><span class="diff-html-changed">Field Type API and best practices</span></a><span class="diff-html-changed">.</span></p><p><span class="diff-html-changed" id="changed-diff-83">External storage is beyond the scope of this tutorial, but many examples can be found in existing </span><span class="diff-html-removed" id="removed-diff-45">FieldTypes</span><span class="diff-html-added" id="added-diff-35">Field Types</span><span class="diff-html-changed" id="changed-diff-84">.</span></p></td></tr></tbody></table><p class="diff-block-context">We will follow a simple implementation here: the <code>Tweet\Value</code> object will be serialized as an array to the <code>code</code> property using <code>fromHash()</code> and <code>toHash()</code>:</p><table class="diff-macro diff-block-context"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr><tr><th>title</th><td>Tweet\Type</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>/**
 * @param \EzSystems\TweetFieldTypeBundle\eZ\Publish\FieldType\Tweet\Value $value
 * @return \eZ\Publish\SPI\Persistence\Content\FieldValue
 */
public function toPersistenceValue( SPIValue $value )
{
    if ( $value === null )
    {
        return new PersistenceValue(
            array(
                "data" =&gt; null,
                "externalData" =&gt; null,
                "sortKey" =&gt; null,
            )
        );
    }
    return new PersistenceValue(
        array(
            "data" =&gt; $this-&gt;toHash( $value ),
            "sortKey" =&gt; $this-&gt;getSortInfo( $value ),
        )
    );
}
/**
 * @param \eZ\Publish\SPI\Persistence\Content\FieldValue $fieldValue
 * @return \EzSystems\TweetFieldTypeBundle\eZ\Publish\FieldType\Tweet\Value
 */
public function fromPersistenceValue( PersistenceValue $fieldValue )
{
    if ( $fieldValue-&gt;data === null )
    {
        return $this-&gt;getEmptyValue();
    }
    return new Value( $fieldValue-&gt;data );
}</pre></td></tr></tbody></table><p class="diff-block-context"> </p><h5 id="ImplementingtheTweet\Typeclass-FetchingdatafromtheTwitterAPI" class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-85">Fetching data from the </span></h5><p class="diff-context-placeholder">...</p><h5 id="ImplementingtheTweet\Typeclass-FetchingdatafromtheTwitterAPI" class="diff-block-target diff-block-context"><span class="diff-html-added" id="added-diff-36">Twitter </span><span class="diff-html-changed" id="changed-diff-86">API</span></h5><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-87">As explained in the tutorial's introduction, we will enrich our tweet's URL with the embed version, fetched using the </span></p><p class="diff-context-placeholder">...</p><p class="diff-block-target diff-block-context"><span class="diff-html-added" id="added-diff-37">Twitter </span><span class="diff-html-changed" id="changed-diff-88">API. To do so, we will, when </span><code><span class="diff-html-changed">toPersistenceValue()</span></code><span class="diff-html-changed"> is called, fill in the value's contents property from this method, before creating the </span><code><span class="diff-html-changed">PersistenceValue</span></code><span class="diff-html-changed"> object.</span></p><p class="diff-block-target diff-block-context"><span class="diff-html-changed" id="changed-diff-90">First, we need a twitter client in </span><code><span class="diff-html-changed">Tweet\Type</span></code><span class="diff-html-changed">. For convenience, we provide one in this tutorial's bundle:</span></p><div class="diff-block-target diff-block-context"><ul style="list-style-type: square;"><li>The <code>Twitter\TwitterClient</code> class:</li><li><span class="diff-html-changed" id="changed-diff-92">The </span><code><span class="diff-html-changed">Twitter\TwitterClientInterface</span></code><span class="diff-html-changed"> interface</span></li><li>An <code>ezsystems.tweetbundle.twitter.client</code> service that uses the class above.</li></ul><p>The interface has one method: <code>getEmbed( $statusUrl )</code><span class="diff-html-removed" id="removed-diff-48"> , </span>that, given a tweet's URL, returns the embed code as a string. The implementation is very simple, for the sake of simplicity, but gets the job done. Ideally, it should at the very least handle errors, but it is not necessary here.</p><h6 id="ImplementingtheTweet\Typeclass-InjectingtheTwitterclientintoTweet\Type"><span class="diff-html-changed" id="changed-diff-93">Injecting the </span></h6><span class="diff-html-removed"> </span><span class="diff-html-removed" id="removed-diff-49">twitter </span><h6 id="ImplementingtheTweet\Typeclass-InjectingtheTwitterclientintoTweet\Type"><span class="diff-html-added" id="added-diff-38">Twitter </span><span class="diff-html-changed" id="changed-diff-94">client into </span><code><span class="diff-html-changed">Tweet\Type</span></code></h6><p>Our <span class="diff-html-removed" id="removed-diff-50">FieldType </span><span class="diff-html-added" id="added-diff-39">Field Type </span>doesn't have a constructor yet. We will create one, with an instance of <code>Twitter\TwitterClientInterface</code> as the argument, and store it in a new protected property:</p><table class="diff-macro"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr><tr><th>title</th><td>eZ/Publish/FieldType/Tweet/Type.php:</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre>use EzSystems\TweetFieldTypeBundle\Twitter\TwitterClientInterface;
 
class Type extends FieldType
{
    /** @var TwitterClientInterface */
    protected $twitterClient;

    public function __construct( TwitterClientInterface $twitterClient )
    {
        $this-&gt;twitterClient = $twitterClient;
    }
}</pre></td></tr></tbody></table><h6 id="ImplementingtheTweet\Typeclass-Completingthevalueusingthetwitterclient">Completing the value using the twitter client</h6><p>As described above, before creating the <code>PersistenceValue</code> object in <code>toPersistenceValue</code>, we will fetch the tweet's embed contents using the client, and assign it to <code>Tweet\Value::$data</code>:</p><table class="diff-macro"><thead><tr><th class="diff-macro-title"><span class="icon macro-placeholder-icon" style="background-image: url(https://doc.ez.no/s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/_/plugins/servlet/confluence/placeholder/macro-icon?name=code);"> </span>Code Block</th></tr></thead><tbody><tr><td class="diff-macro-properties"><table><tbody><tr><th>language</th><td>php</td></tr><tr><th>title</th><td>eZ/Publish/FieldType/Tweet/Type.php</td></tr></tbody></table></td></tr></tbody><tbody><tr><td class="diff-macro-body"><pre> public function toPersistenceValue( SPIValue $value )
{
    // if ( $value === null )
    // {...}


    if ( $value-&gt;contents === null )
    {
        $value-&gt;contents = $this-&gt;twitterClient-&gt;getEmbed( $value-&gt;url );
    }
    return new PersistenceValue(
    // array(...)
}

</pre></td></tr></tbody></table><p>And that's <span class="diff-html-removed" id="removed-diff-51">it </span><span class="diff-html-added" id="added-diff-40">it</span>! When the persistence layer stores content from our type, the value will be completed with what the twitter API returns.</p><p><span class="diff-html-added" id="added-diff-41"> </span></p></div>
</div>
    
    

            
</div>


    




    
    

    
    
    







</div>
  
        <div id="theme-footer">
            <p>© 1999-2016 <a href="http://ez.no/" class="external-link" rel="nofollow">eZ Systems AS</a> and others</p>
        </div>
    
    </div>
</div>


        
            
            

<div id="footer" role="contentinfo">
    <section class="footer-body">

                                                            <p class="license license-opensource">
                    Powered by a free <b>Atlassian Confluence Open Source Project License</b> granted to Exponential. <a href="http://www.atlassian.com/c/conf/11461">Evaluate Confluence today</a>.<br>
                </p>
                    
        

        <ul id="poweredby">
            <li class="noprint">Powered by <a href="http://www.atlassian.com/software/confluence" class="hover-footer-link">Atlassian Confluence</a> <span id='footer-build-information'>5.8.5</span>, <a href="http://www.atlassian.com/software/confluence/overview/team-collaboration-software?utm_source=confluence-footer" class="hover-footer-link">Team Collaboration Software</a></li>
            <li class="print-only">Printed by Atlassian Confluence 5.8.5, Team Collaboration Software.</li>
            <li class="noprint"><a href="https://jira.atlassian.com/browse/CONF" class="hover-footer-link">Report a bug</a></li>
            <li class="noprint"><a href="http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch" class="hover-footer-link">Atlassian News</a></li>
        </ul>

        

        <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>

                    <script>
AJS.toInit(function(){
 if(AJS.params.spaceKey &&
    AJS.params.spaceKey === 'MAIN' ||
    AJS.params.spaceKey === 'EZMA' ||
    AJS.params.spaceKey === 'ODC' ||
    AJS.params.spaceKey === 'EZP50' ||
    AJS.params.spaceKey === 'EZP51' ||
    AJS.params.spaceKey === 'EZP52' ||
    AJS.params.spaceKey === 'EZPCLOUD' ||
    AJS.params.spaceKey === 'EZP' ||
    AJS.params.spaceKey === 'TECHDOC' ||
    AJS.params.spaceKey === 'USERGUIDE' ||
    AJS.params.spaceKey === 'EZRECO'
){

(function()
{var isSecure=('https:'==document.location.protocol);var ff=document.createElement('script');ff.type='text/javascript';ff.async=true;ff.src=(isSecure?'https':'http')+'://'+(isSecure?'secure.':'lb.')+'liveviewer.ez.no/statjs/sst-120-1304513615/stat.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ff,s);}
)();

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-303624-13', 'ez.no');
  ga('send', 'pageview');
}}
);
</script>
        
    </section>
</div>

    </div>
</body>

<!-- Mirrored from doc.ez.no/pages/diffpagesbyversion.action?pageId=30711527&selectedPageVersions=1&selectedPageVersions=2 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:01:20 GMT -->
</html>
