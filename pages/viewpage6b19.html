<!DOCTYPE html>
<html>

<!-- Mirrored from doc.ez.no/pages/viewpage.action?pageId=10158260&navigatingVersions=true by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 15:19:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <title>Field Type API and best practices - Exponential Platform 5.x - eZ Documentation</title>

        

                        
    
                        
    
                        
    

    <meta http-equiv="X-UA-Compatible" content="IE=EDGE,chrome=IE7">
<meta charset="UTF-8">
<meta id="confluence-context-path" name="confluence-context-path" content="">
<meta id="confluence-base-url" name="confluence-base-url" content="../index.html">

<meta id="atlassian-token" name="atlassian-token" content="494111f00e28ced96046bfb6fbe8f75e18d44b71">

<meta id="confluence-space-key" name="confluence-space-key" content="EZP">
<script type="text/javascript">
        var contextPath = '';
</script>

    

<!-- include system css resources -->


    <link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch934e.css?media=print" media="print">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 8]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+8" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/6e55d36b98fe54865e616dc7ce47dca4/_/download/contextbatch/css/atl.confluence.plugins.pagetree-desktop%2cmain%2cvi/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/6e55d36b98fe54865e616dc7ce47dca4/_/download/contextbatch/css/atl.confluence.plugins.pagetree-desktop,main,viewcontent,atl.general/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/47016f6b93087cd2003bf867318254ee/_/download/contextbatch/css/theme.doc/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/2.6.10/_/download/batch/org.randombits.confluence.toc_toc-plugin-styles/org.randombits.confluence.toc_toc-plugin-styles.117.d" media="all">
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/2.0.22/_/download/batch/confluence.extra.information_information-plugin/confluence.extra.information_information-plugin-adg-s" media="all">
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/2.1.4/_/download/batch/com.atlassian.confluence.ext.newcode-macro-plug/com.atlassian.confluence.ext.newcode-macro-plugin_synt" media="all">
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/2.1.4/_/download/batch/com.atlassian.confluence.ext.newcode-macro-plug/com.atlassian.confluence.ext.newcode-macro-plugin_sh-t" media="all">
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-hig/com.atlassian.confluence.plugins.confluence-highlight-ac" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/5.3.3-m6/_/download/batch/confluence.extra.jira_web-resources-adg/confluence.extra.jira_web-resources-adg.css" media="all">
<link type="text/css" rel="stylesheet" href="../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/51/_/styles/colorsb538.css?spaceKey=EZP" media="all">
<link type="text/css" rel="stylesheet" href="../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/51/_/styles/customb538.css?spaceKey=EZP" media="all">

<!-- end system css resources -->

    <meta name="confluence-request-time" content="1413903630834">
        
    
        
            <meta name="ajs-is-confluence-admin" content="false">
            <meta name="ajs-connection-timeout" content="10000">
            <meta name="ajs-use-keyboard-shortcuts" content="true">
            <meta name="ajs-keyboardshortcut-hash" content="ec556f85a7b4fc86b37ab7a78ce3d8b0">
            <meta id="team-calendars-has-jira-link" content="true">
            <meta name="ajs-team-calendars-display-time-format" content="displayTimeFormat12">
            <meta id="team-calendars-user-timezone" content="UTC">
            <script type="text/x-template" id="team-calendars-messages" title="team-calendars-messages">
    <fieldset class="i18n hidden">
                    <input type="hidden" name="calendar3.month.short.april" value="Apr">
                    <input type="hidden" name="calendar3.month.short.november" value="Nov">
                    <input type="hidden" name="calendar3.month.long.november" value="November">
                    <input type="hidden" name="calendar3.day.short.friday" value="Fri">
                    <input type="hidden" name="calendar3.month.long.february" value="February">
                    <input type="hidden" name="calendar3.month.short.february" value="Feb">
                    <input type="hidden" name="calendar3.day.long.wednesday" value="Wednesday">
                    <input type="hidden" name="calendar3.month.long.december" value="December">
                    <input type="hidden" name="calendar3.day.short.sunday" value="Sun">
                    <input type="hidden" name="calendar3.month.long.april" value="April">
                    <input type="hidden" name="calendar3.month.long.july" value="July">
                    <input type="hidden" name="calendar3.month.long.september" value="September">
                    <input type="hidden" name="calendar3.month.short.august" value="Aug">
                    <input type="hidden" name="calendar3.month.short.june" value="Jun">
                    <input type="hidden" name="calendar3.month.short.may" value="May">
                    <input type="hidden" name="calendar3.day.short.tuesday" value="Tue">
                    <input type="hidden" name="calendar3.day.short.wednesday" value="Wed">
                    <input type="hidden" name="calendar3.day.long.thursday" value="Thursday">
                    <input type="hidden" name="calendar3.month.long.march" value="March">
                    <input type="hidden" name="calendar3.month.long.october" value="October">
                    <input type="hidden" name="calendar3.day.short.saturday" value="Sat">
                    <input type="hidden" name="calendar3.month.short.january" value="Jan">
                    <input type="hidden" name="calendar3.month.long.may" value="May">
                    <input type="hidden" name="calendar3.month.long.january" value="January">
                    <input type="hidden" name="calendar3.month.short.october" value="Oct">
                    <input type="hidden" name="calendar3.day.short.thursday" value="Thu">
                    <input type="hidden" name="calendar3.day.long.friday" value="Friday">
                    <input type="hidden" name="calendar3.day.long.sunday" value="Sunday">
                    <input type="hidden" name="calendar3.month.long.june" value="June">
                    <input type="hidden" name="calendar3.month.long.august" value="August">
                    <input type="hidden" name="calendar3.day.long.tuesday" value="Tuesday">
                    <input type="hidden" name="calendar3.day.long.saturday" value="Saturday">
                    <input type="hidden" name="calendar3.month.short.september" value="Sep">
                    <input type="hidden" name="calendar3.day.long.monday" value="Monday">
                    <input type="hidden" name="calendar3.month.short.july" value="Jul">
                    <input type="hidden" name="calendar3.month.short.march" value="Mar">
                    <input type="hidden" name="calendar3.day.short.monday" value="Mon">
                    <input type="hidden" name="calendar3.month.short.december" value="Dec">
            </fieldset>
</script>

            

    
            
    
    
            <meta name="ajs-page-id" content="10158260">
            <meta name="ajs-content-type" content="page">
            <meta name="ajs-page-title" content="Field Type API and best practices">
            <meta name="ajs-parent-page-id" content="">
            <meta name="ajs-space-key" content="EZP">
            <meta name="ajs-space-name" content="Exponential Platform 5.x">
            <meta name="ajs-from-page-title" content="">
            <meta name="ajs-can-remove-page" content="false">
            <meta name="ajs-editor.loader.comment.resources" content="&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=_/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/9f01679814e63f4c0513d02c90477002/_/download/contextbatch/css/comment-editor/batch.html media=&quot;all&quot;&gt;
">
            <meta name="ajs-context-path" content="">
            <meta name="ajs-base-url" content="https://doc.ez.no">
            <meta name="ajs-version-number" content="5.4.4">
            <meta name="ajs-build-number" content="4733">
            <meta name="ajs-remote-user" content="">
            <meta name="ajs-current-user-fullname" content="">
            <meta name="ajs-current-user-avatar-url" content="">
            <meta name="ajs-static-resource-url-prefix" content="/s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_">
            <meta name="ajs-global-settings-attachment-max-size" content="10485760">
            <meta name="ajs-user-locale" content="en_GB">
            <meta name="ajs-enabled-dark-features" content="sync.event">
            <meta name="ajs-atl-token" content="494111f00e28ced96046bfb6fbe8f75e18d44b71">
            <meta name="ajs-confluence-flavour" content="VANILLA">
            <meta name="ajs-editor.loader.resources" content="&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=_/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/eb8de6aa7acc3a4b2e8aee165b9628ad/_/download/contextbatch/css/editor%2cmacro-browser%2cfullpage-editor%2c-v/batch.11b.delaye media=&quot;all&quot;&gt;
&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=_/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/eb8de6aa7acc3a4b2e8aee165b9628ad/_/download/contextbatch/css/editor%2cmacro-browser%2cfullpage-edito/batch.11ca781.delaye?media=%28max-width%3A+1450px%29%22 media=&quot;(max-width: 1450px)&quot;&gt;
&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=_/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/eb8de6aa7acc3a4b2e8aee165b9628ad/_/download/contextbatch/css/editor%2cmacro-browser%2cfullpage-edito/batch.11d23d0.delaye?media=print%22 media=&quot;print&quot;&gt;
&lt;!--[if lt IE 9]&gt;
&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=_/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/eb8de6aa7acc3a4b2e8aee165b9628ad/_/download/contextbatch/css/editor%2cmacro-browser%2cfullpage-edito/batch.11ed0b5.delaye?conditionalComment=lt+IE+9%22 media=&quot;all&quot;&gt;
&lt;![endif]--&gt;
&lt;!--[if IE]&gt;
&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=_/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/eb8de6aa7acc3a4b2e8aee165b9628ad/_/download/contextbatch/css/editor%2cmacro-browser%2cfullpage-edito/batch.11fbe23.delaye?ieonly=true%22 media=&quot;all&quot;&gt;
&lt;![endif]--&gt;
&lt;script type=&quot;text/javascript&quot; src=_/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/eb8de6aa7acc3a4b2e8aee165b9628ad/_/download/contextbatch/js/editor%2cmacro-browser%2cfullpage-editor%2c-vi/batch.120.delaye &gt;&lt;/script&gt;
">
            <meta name="ajs-date.format" content="MMM dd, yyyy">
    
    <link rel="shortcut icon" href="../favicon.html">
    <link rel="icon" type="image/x-icon" href="../favicon.html">

<link rel="search" type="application/opensearchdescription+xml" href="../opensearch/osd.action" title="eZ Documentation"/>

    <!-- include system javascript resources -->
    <script type="text/javascript" src="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/js/batch.js" ></script>
<!--[if lte IE 8]>
<script type="text/javascript" src="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/js/batch.js?conditionalComment=lte+IE+8" ></script>
<![endif]-->
<script type="text/javascript" src="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/6e55d36b98fe54865e616dc7ce47dca4/_/download/contextbatch/js/atl.confluence.plugins.pagetree-desktop%2cmain%2cvi/batch.js" ></script>
<script type="text/javascript" src="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/js/page/batch.js" ></script>
<script type="text/javascript" src="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/84fc2bb4cbbfc06481d75335376bb250/_/download/contextbatch/js/atl.comments/batch.js" ></script>
<script type="text/javascript" src="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/2.1.4/_/download/batch/com.atlassian.confluence.ext.newcode-macro-plug/com.atlassian.confluence.ext-2.newcode-macro-plugin_synt" ></script>
<script type="text/javascript" src="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/2.1.4/_/download/batch/com.atlassian.confluence.ext.newcode-macro-plug/com.atlassian.confluence.ext-3.newcode-macro-plugin_synt" ></script>
<script type="text/javascript" src="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-hig/com.atlassian.confluence.plugins-2.confluence-highlight-ac" ></script>
<script type="text/javascript" src="../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.mywork.mywork-confluence-host-plu/com.atlassian.mywork.mywork-confluence-host-plugin_mw-he" ></script>

    

        
    <!-- end system javascript resources -->

        
        

    
                <link rel="canonical" href="../display/EZP/Field%2bType%2bAPI%2band%2bbest%2bpractices.html">
        <link rel="shortlink" href="../x/tACb.html">
    <meta name="wikilink" content="[null:Field Type API and best practices]">
    <meta name="page-version" content="27">

</head>

<body             onload="placeFocus()"
     id="com-atlassian-confluence" class="theme-documentation  aui-theme-default aui-layout">

        
    <div id="full-height-container">
    <div id="header-precursor">
        
                    </div>






<header id="header" role="banner">
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation"><div class="aui-header-inner"><div class="aui-header-before"><a class="aui-dropdown2-trigger app-switcher-trigger" aria-owns="app-switcher" aria-haspopup="true" tabindex="0"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a><div id="app-switcher" class="aui-dropdown2 aui-style-default"><div class="app-switcher-loading">Loading&hellip;</div></div><script>
            (function (NL) {
                var initialise = function () {
                    // For some milestones of AUI, the atlassian soy namespace was renamed to aui. Handle that here by ensuring that window.atlassian is defined.
                    window.atlassian = window.atlassian || window.aui;
                    new NL.AppSwitcher({
                        dropdownContents: '#app-switcher'
                    });
                };
                if (NL.AppSwitcher) {
                    initialise();
                } else {
                    NL.onInit = initialise;
                }
            }(window.NL = (window.NL || {})));
            window.NL.isUserAdmin = false</script></div><div class="aui-header-primary"><h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="../index.html"><img src="../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/_/images/logo/atl.site.logo" alt="eZ Documentation" /></a></h1><ul class="aui-nav">
                            <li>
            
        
        
<a  id="space-directory-link" href="../spacedirectory/view.html"  class=" aui-nav-imagelink"   title="Spaces">
            <span>Spaces</span>
    </a>
        </li>
                            <li id="browseMenu" role="menu">
            
    
        <a id="browse-menu-link" class="aui-nav-link aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-owns="browse-menu-link-content" title="Browse">
        <span class="browse">Browse</span>
    </a>
    <nav id="browse-menu-link-content" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                    <div class="aui-dropdown2-section">
                <ul  id="browse-menu-link-leading" class="aui-list-truncate section-leading first">
                                            <li>
    
            
<a  id="space-pages-link" href="listpages-dirview4915.html?key=EZP" class="    "      title="Browse pages in the Exponential Platform 5.x space" >
        Pages
</a>
</li>
                                            <li>
    
            
<a  id="space-blogposts-link" href="viewrecentblogposts4915.html?key=EZP" class="    "      title="Browse blogs in the Exponential Platform 5.x space" >
        Blog
</a>
</li>
                                            <li>
    
            
<a  id="space-labels-link" href="../labels/listlabels-heatmap4915.html?key=EZP" class="    "      title="Browse labels in the Exponential Platform 5.x space" >
        Labels
</a>
</li>
                                            <li>
    
            
<a  id="space-advanced-link" href="../spaces/viewspacesummary4915.html?key=EZP" class="    "      title="Browse additional space functions in the Exponential Platform 5.x space" >
        Space Operations
</a>
</li>
                                    </ul>
            </div>
            </nav>
    
        </li>
        </ul>
</div><div class="aui-header-secondary"><ul class="aui-nav">
                <li>
        
    
            
<a  id="doctheme-anchor" href="#"  class=" aui-nav-imagelink"   title="">
            <span></span>
    </a>
    </li>
        <li>
<form id="quick-search" class="aui-quicksearch dont-default-focus header-quicksearch" action="https://doc.ez.no/dosearchsite.action" method="get">
    <fieldset>
                    <input type='hidden' name='where' value='EZP'/>
                            <input type="hidden" name="spaceSearch" value="true"/>
                <label for="quick-search-query" class="assistive">Quick Search</label>
        <input id="quick-search-query" class="text app-search search quick-search-query" type="text"
               accessKey="q" autocomplete="off" name="queryString" title="Quick Search"  placeholder="Search space" />
        <input id="quick-search-submit" class="quick-search-submit" type="submit" value="Search"/>

        <div class="aui-dd-parent quick-nav-drop-down"></div>
    </fieldset>
    <div class="hidden parameters">
                    <!-- putMetadata failed to add value for key "quick-nav-enabled" so rendering metadata inline - see server debug log for details -->
        <meta name="ajs-quick-nav-enabled" content="true">
                </div>
</form>
</li>
    <li>    
        <a id="help-menu-link" class="aui-nav-link aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-owns="help-menu-link-content" title="Help">
        <span class="aui-icon aui-icon-small aui-iconfont-help">Help</span>
    </a>
    <nav id="help-menu-link-content" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                    <div class="aui-dropdown2-section">
                <ul  id="help-menu-link-leading" class="aui-list-truncate section-leading first">
                                            <li>
    
            
<a  id="confluence-help-link" href="http://docs.atlassian.com/confluence/docs-54/Getting+Help+And+Support" class="    "      title="Visit the Confluence documentation home"  target="_blank"
>
        Online Help
</a>
</li>
                                            <li>
    
                
<a  id="keyboard-shortcuts-link" href="#" class="    "      title="View available keyboard shortcuts" >
        Keyboard Shortcuts
</a>
</li>
                                            <li>
    
            
<a  id="feed-builder-link" href="../dashboard/configurerssfeed.html" class="    "      title="Create your custom RSS feed." >
        Feed Builder
</a>
</li>
                                            <li>
    
            
<a  id="whats-new-menu-link" href="http://docs.atlassian.com/confluence/docs-54/whatsnew/iframe" class="    "      title="" >
        What’s new
</a>
</li>
                                            <li>
    
                
<a  id="gadget-directory-link" href="#" class="   user-item administration-link "      title="Browse gadgets provided by Confluence" >
        Available Gadgets
</a>
</li>
                                            <li>
    
            
<a  id="confluence-about-link" href="../aboutconfluencepage.html" class="    "      title="Get more information about Confluence" >
        About Confluence
</a>
</li>
                                    </ul>
            </div>
            </nav>
    </li>
    <li>    
    </li>
                <li>                                    <li>
    
            
<a  id="login-link" href="../loginbeb7.html?os_destination=%2Fpages%2Fviewpage.action%3FpageId%3D10158260%26navigatingVersions%3Dtrue" class="   user-item login-link "      title="" >
        Log in
</a>
</li>
                        </li>
</ul>
</div></div><!-- .aui-header-inner--></nav><!-- .aui-header -->
    <br class="clear">
</header>

    <div id="splitter">
    <div id="splitter-sidebar"  class="padding-div" >
        
        <p>&nbsp;<br/>
<strong>Navigation</strong><br/>
&bull; <a href="https://confluence.ez.no/display/MAIN" class="external-link" rel="nofollow">eZ Documentation Center</a><br/>
&nbsp;</p>
    

                    
    


<div class="plugin_pagetree">

        
        
    <ul class="plugin_pagetree_children_list plugin_pagetree_children_list_noleftspace">
        <div class="plugin_pagetree_children">
        </div>
    </ul>

    <fieldset class="hidden">
        <input type="hidden" name="treeId" value="">
        <input type="hidden" name="treeRequestId" value="/plugins/pagetree/naturalchildren.action?decorator=none&amp;excerpt=false&amp;sort=position&amp;reverse=false&amp;disableLinks=false&amp;expandCurrent=false">
        <input type="hidden" name="treePageId" value="10158260">

        <input type="hidden" name="noRoot" value="false">
        <input type="hidden" name="rootPageId" value="1114149">

        <input type="hidden" name="rootPage" value="">
        <input type="hidden" name="startDepth" value="0">
        <input type="hidden" name="spaceKey" value="EZP" >

        <input type="hidden" name="i18n-pagetree.loading" value="Loading...">
        <input type="hidden" name="i18n-pagetree.error.permission" value="Unable to load page tree. It seems that you do not have permission to view the root page.">
        <input type="hidden" name="i18n-pagetree.eeror.general" value="There was a problem retrieving the page tree. Please check the server log file for more information.">
        <input type="hidden" name="loginUrl" value="/login.action?os_destination=%2Fpages%2Fviewpage.action%3FpageId%3D10158260%26navigatingVersions%3Dtrue">
        <input type="hidden" name="mobile" value="false">

                <fieldset class="hidden">
                            <input type="hidden" name="ancestorId" value="1114149">
                    </fieldset>
    </fieldset>
</div>



            </div>
    <div id="splitter-content">

                    <script type="text/javascript" src="../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/5.4.4/_/download/resources/com.atlassian.confluence.plugins.doctheme_resources/doc-theme.js"></script>
    
                        
        <div id="theme-header">
            <div class="sectionColumnWrapper"><div class="sectionMacro">
<div class="sectionMacroRow"><div class="columnMacro"></div>
<div class="columnMacro">
<div class="panel" style="background-color: #ecf0f1;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #ecf0f1;">
<p>This documentation is for <strong>Exponential Platform 5.x</strong> "Platform stack". For documentation on "legacy" <a href="../Exponential/index.html" class="external-link" rel="nofollow">go here</a>, for explanation on difference see <a href="viewpage0139.html?pageId=11403666" class="external-link" rel="nofollow">5.x Architecture overview</a></p>
</div></div></div>
<div class="columnMacro"></div></div></div></div>
        </div>
    
            
<div id="main"  class="aui-page-panel" >
    <div id="main-header">
        
        
    <div id="navigation" class="content-navigation view">
                    <ul class="ajs-menu-bar">
                                    
                    
        <li class="normal ajs-menu-item">
        <a id="action-menu-link" class="action ajs-menu-title aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-owns="action-menu" data-container="#navigation"><span><span>Tools</span></span></a>         <div id="action-menu" class="aui-dropdown2 aui-style-default">
                            <ul  id="action-menu-primary"                     class="section-primary first aui-dropdown2-section">
                                            <li>

    
        
                            
    
    
    <a  id="action-view-history-link" href="viewpreviousversions6121.html?pageId=10158260" rel="nofollow"  class="action-view-history"   title="">
                <span>Page History</span>    </a>
</li>
                                </ul>
                            <ul  id="action-menu-secondary"                     class="section-secondary aui-dropdown2-section">
                                            <li>

    
        
                            
    
    
    <a  id="view-page-info-link" href="viewinfo6121.html?pageId=10158260" rel="nofollow"  class="action-view-info"   title="">
                <span>Page Information</span>    </a>
</li>
                                        <li>

    
        
                            
    
    
    <a  id="view-in-hierarchy-link" href="../login51fb.html?key=$page.space.key&amp;openId=10158260#selectedPageInHierarchy" rel="nofollow"  class=""   title="">
                <span>View in Hierarchy</span>    </a>
</li>
                                        <li>

    
        
                            
    
    
    <a  id="action-view-source-link" href="../plugins/viewsource/viewpagesrc6121.html?pageId=10158260" rel="nofollow"  class="action-view-source popup-link"   title="">
                <span>View Source</span>    </a>
</li>
                                        <li>

    
        
                            
    
    
    <a  id="action-export-pdf-link" href="../download/temp/pdfexport-20141021-211014-1519-2159/EZP-FieldTypeAPIandbestpractices-211014-1519-2160f1f7.pdf?pageId=10158260" rel="nofollow"  class=""   title="">
                <span>Export to PDF</span>    </a>
</li>
                                </ul>
                    </div>
    </li>
            </ul>
    </div>

        
                <div id="title-heading" class="pagetitle with-breadcrumbs">
        
                            <div class="space-logo " data-key="EZP" data-name="Exponential Platform 5.x" data-entity-type="confluence.space">
            <a><img class="logo space custom" src="../download/attachments/1736738/EZP9600?version=4&amp;modificationDate=1405688262000&amp;api=v2" alt=""></a>
        </div>            
                            <div id="breadcrumb-section">
                    
    
    
    <ol id="breadcrumbs">
                    
                
        <li class="first" >
                

                    <span class=""><a href="../display/EZP/eZ%2bPublish%2bPlatform%2bDocumentation.html">Exponential Platform 5.x</a></span>
                                                <li id="ellipsis" title="Show all breadcrumbs"><span><strong>&#8230;</strong></span></li>
                                    
                
        <li class="hidden-crumb" >
                

                    <span class=""><a href="../display/EZP/eZ%2bPublish%2bPlatform%2bDocumentation.html">Exponential Platform Documentation</a></span>
                                        
                
        <li class="hidden-crumb" >
                

                    <span class=""><a href="viewpage6ff2.html?pageId=6291674">Development &amp; Administration Guides</a></span>
                                        
                
        <li class="hidden-crumb" >
                

                    <span class=""><a href="../display/EZP/Developing%2bwith%2beZ%2bPublish%2b5.html">Developing with Exponential 5</a></span>
                            
                
        <li>
                

                    <span class=""><a href="../display/EZP/Extending%2beZ%2bPublish%2b5.html">Extending Exponential 5</a></span>
                </ol>


                </div>
            
            <h1 id="title-text" class="with-breadcrumbs">
                                        <a href="viewpage6121.html?pageId=10158260">Field Type API and best practices</a>
                            </h1>
        </div>
    </div>

    

    
    
    
    
    

        




        




    

    

    







    
    
        
    
    
                    
    

    


<div id="content" class="page view">
    

<div id="action-messages">
                        </div>



        <script type="text/x-template" title="searchResultsGrid">
    <table class="aui">
        <thead>
            <tr class="header">
                <th class="search-result-title">Page Title</th>
                <th class="search-result-space">Space</th>
                <th class="search-result-date">Updated</th>
            </tr>
        </thead>
    </table>
</script>
<script type="text/x-template" title="searchResultsGridCount">
    <p class="search-result-count">{0}</p>
</script>
<script type="text/x-template" title="searchResultsGridRow">
    <tr class="search-result">
        <td class="search-result-title"><a href="{1}" class="content-type-{2}"><span>{0}</span></a></td>
        <td class="search-result-space"><a class="space" href="/display/{4}/" title="{3}">{3}</a></td>
        <td class="search-result-date"><span class="date" title="{6}">{5}</span></td>
    </tr>
</script>
        
    
    
        <fieldset class="hidden parameters">
            <input type="hidden" title="parentPageId" value="">
        </fieldset>

                            
    

                    

                    
        
        <a href="#page-metadata-end" class="assistive">Skip to end of metadata</a>
<div id="page-metadata-start" class="assistive"></div>

    <div class="page-metadata">
        <ul>
                            <li class="page-metadata-item noprint">

    
            
                            
    
    
    <a  id="content-metadata-page-restrictions" href="#" rel="nofollow"  class="hidden"   title="Restrictions apply">
                    <img alt="" src="../download/resources/com.atlassian.confluence.plugins.confluence-page-banner_page-banner-resources/images/red_padlock.png" height="16" width="16" title="">
                <span></span>    </a>
</li>
                        <li class="page-metadata-modification-info">
                
        
    
        
    
        
        
            Created by <span class='author'>     <span class="unknown-user">Unknown User (kore.nordmann)</span></span>, last modified by <span class='editor'>     <a href="../loginda49.html"
                       class="url fn"
                            >Petar Spanja</a></span> on <a class='last-modified' title='Feb 07, 2013 14:04' href='diffpagesbyversion71c4.html?pageId=10158260&amp;selectedPageVersions=26&amp;selectedPageVersions=27'>Feb 07, 2013</a>
                </li>
        </ul>
    </div>


<a href="#page-metadata-start" class="assistive">Go to start of metadata</a>
<div id="page-metadata-end" class="assistive"></div>

                            <div id="page-history-warning" class="aui-message warning">
        <p>
            <span class="aui-icon icon-warning"></span>
            <strong>You are viewing an old version of this page. View the <strong><a href="../display/EZP/Field%2bType%2bAPI%2band%2bbest%2bpractices.html">current version</a>.</strong></strong>
        </p>
        <p class="page-history-view">
            <a href="diffpagesbyversione2fc.html?pageId=2719880&amp;originalVersion=27&amp;revisedVersion=38">Compare with Current</a>
                        <a href="viewpreviousversions8b4d.html?pageId=2719880">View Page History</a>
        </p>
        <p class="version-navigation-block">
                            <a class="version-navigation aui-button" href="viewpageb67d.html?pageId=8323663&amp;navigatingVersions=true">&laquo; Previous</a>
            
            <span class="current-version-margin">
                                    <strong> Version 27</strong>
                            </span>

                            <a class="version-navigation aui-button" href="viewpage7f03.html?pageId=10158261&amp;navigatingVersions=true">Next &raquo;</a>
            
        </p>
    </div>
            
        <fieldset class="hidden parameters">
                        <input type="hidden" title="browsePageTreeMode" value="view">
        </fieldset>

        <div class="wiki-content">
                           
        <p>The page Exponential Documentation could not be found.</p><p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1413903630915 {padding: 0px;}
div.rbtoc1413903630915 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1413903630915 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1413903630915'>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>1</span> <a href='#FieldTypeAPIandbestpractices-FieldTypeAPI&amp;bestpractices'>Field Type API &amp; best practices</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>1.1</span> <a href='#FieldTypeAPIandbestpractices-PublicAPIinteraction'>Public API interaction</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>1.1.1</span> <a href='#FieldTypeAPIandbestpractices-FieldDefinitionhandling'>FieldDefinition handling</a></li>
<li><span class='TOCOutline'>1.1.2</span> <a href='#FieldTypeAPIandbestpractices-Valuehandling'>Value handling</a></li>
<li><span class='TOCOutline'>1.1.3</span> <a href='#FieldTypeAPIandbestpractices-Eventhandling'>Event handling</a></li>
<li><span class='TOCOutline'>1.1.4</span> <a href='#FieldTypeAPIandbestpractices-Storageconversion'>Storage conversion</a></li>
</ul>
</li>
<li><span class='TOCOutline'>1.2</span> <a href='#FieldTypeAPIandbestpractices-Searching'>Searching</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>1.2.1</span> <a href='#FieldTypeAPIandbestpractices-SearchFieldValues'>Search Field Values</a></li>
<li><span class='TOCOutline'>1.2.2</span> <a href='#FieldTypeAPIandbestpractices-SearchFieldTypes'>Search Field Types</a></li>
<li><span class='TOCOutline'>1.2.3</span> <a href='#FieldTypeAPIandbestpractices-ConfiguringSolr'>Configuring Solr</a></li>
<li><span class='TOCOutline'>1.2.4</span> <a href='#FieldTypeAPIandbestpractices-RegisteraFieldType'>Register a FieldType</a></li>
</ul>
</li>
<li><span class='TOCOutline'>1.3</span> <a href='#FieldTypeAPIandbestpractices-Storingexternaldata'>Storing external data</a></li>
<li><span class='TOCOutline'>1.4</span> <a href='#FieldTypeAPIandbestpractices-LegacyStorageconversion'>Legacy Storage conversion</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>1.4.1</span> <a href='#FieldTypeAPIandbestpractices-Registeringaconverter'>Registering a converter</a></li>
</ul>
</li>
<li><span class='TOCOutline'>1.5</span> <a href='#FieldTypeAPIandbestpractices-Bestpractices'>Best practices</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>1.5.1</span> <a href='#FieldTypeAPIandbestpractices-GatewaybasedStorage'>Gateway based Storage</a></li>
<li><span class='TOCOutline'>1.5.2</span> <a href='#FieldTypeAPIandbestpractices-Settingsschema'>Settings schema</a></li>
<li><span class='TOCOutline'>1.5.3</span> <a href='#FieldTypeAPIandbestpractices-Validatorschema'>Validator schema</a></li>
</ul>
</li>
<li><span class='TOCOutline'>1.6</span> <a href='#FieldTypeAPIandbestpractices-Testing'>Testing</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>1.6.1</span> <a href='#FieldTypeAPIandbestpractices-PersistenceSPI'>Persistence SPI</a></li>
<li><span class='TOCOutline'>1.6.2</span> <a href='#FieldTypeAPIandbestpractices-PublicAPI'>Public API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div></p><h1 id="FieldTypeAPIandbestpractices-FieldTypeAPI&amp;bestpractices">Field Type API &amp; best practices</h1><p>The Exponential CMS can support arbitrary data to be stored in the fields of a content object. In order to support custom data, besides the standard data types, a developer needs to create a custom <strong>FieldType</strong>.</p><p>The implementation of a custom FieldType is done based on the FieldType SPI and its interfaces. These can be found under <code>eZ\Publish\SPI\FieldType</code>.</p><p>In order to provide custom functionality for a FieldType, the SPI interacts with multiple layers of the Exponential architecture, as shown in the following diagram:</p><p> <img class="confluence-embedded-image" src="../download/attachments/2719880/field_type_overview781c.png?version=1&amp;modificationDate=1343120665000&amp;api=v2" data-image-src="/download/attachments/2719880/field_type_overview.png?version=1&amp;modificationDate=1343120665000&amp;api=v2"></p><p>On the top layer, the FieldType needs to provide conversion from and to a simple PHP hash value to support the REST API. The generated hash value may only consist of scalar values and hashes. It must not contain objects or arrays with numerical indexes that aren't sequential and/or don't start with zero.</p><p>Below that, the FieldType must support the Public API implementation (aka Business Layer), regarding:</p><ul><li>Settings definition for FieldDefinitions</li><li>Value creation and validation</li><li>Communication with the Persistence SPI</li></ul><p>On the bottom level, a FieldType can additionally hook into the Persistence SPI, in order to store data from a FieldValue in an external service. Note that all non-standard Exponential database tables (e.g. <code>ezurl</code>) are also considered &quot;external storage&quot; from now on.</p><p>The following sequence diagram visualizes the process of creating a new <code>Content</code> across all layers, especially focused on the interaction with a <code>FieldType</code>.</p><p><img class="confluence-embedded-image" src="../download/attachments/2719880/create_content_sequence1975.png?version=2&amp;modificationDate=1345030668000&amp;api=v2" data-image-src="/download/attachments/2719880/create_content_sequence.png?version=2&amp;modificationDate=1345030668000&amp;api=v2"><br /> </p><p>In the next lines/pages, this document explains how to implement a custom FieldType based on the SPI and what is expected from it. As a code example, please refer to the Url FieldType, which has been implemented as a reference.</p><h2 id="FieldTypeAPIandbestpractices-PublicAPIinteraction">Public API interaction</h2><p>The interaction with the Public API is done through the interface <code>eZ\Publish\SPI\FieldType\FieldType</code>. A custom FieldType must provide an implementation of this interface. In addition, it is considered best practice to provide a value object class for storing the custom field value provided by the FieldType.</p><h3 id="FieldTypeAPIandbestpractices-FieldDefinitionhandling">FieldDefinition handling</h3><p>In order to make use of a custom FieldType, the user must apply it in a <code>eZ\Publish\API\Repository\Values\ContentType\FieldDefinition</code> of a custom ContentType. The user may in addition provide settings for the FieldType and a validator configuration.  Since the Public API cannot know anything about these, their handling is delegated to the FieldType itself through the following methods:</p><p><code>getFieldTypeIdentifier()</code></p><p style="margin-left: 30.0px;">Returns a unique identifier for the custom FieldType, which is used to assign the type to a FieldDefinition. By convention for the returned type identifier string should be prefixed by a unique shortcut for the vendor (e.g. <code>ez</code> for eZ Systems).</p><p><code>getSettingsSchema()</code></p><p style="margin-left: 30.0px;">Using this method, the Public API retrieves a schema for the field type settings. A typical setting would e.g. be a default value. The settings structure defined by this schema is stored in the <code>FieldDefinition</code>. Since it is not possible to define a generic format for such a schema, the FieldType is free to return any serializable data structure from this method.</p><p><code>getValidatorConfigurationSchema()</code></p><p style="margin-left: 30.0px;">In addition to normal settings, the FieldType should provide a schema settings for for it's validation process. The schema describes, what kind of validation can be performed by the FieldType and which settings the user can specify to these validation methods. For example, the <code>ezstring</code> type can validate minimum and maximum length of the string. It therefore provides a schema to indicate to the user that he might specify the corresponding restrictions, when creating a <code>FieldDefinition</code> with this type. Again, the schema does not underly any regulations, except for that it must be serializable.</p><p><code>validateFieldSettings()</code></p><p style="margin-left: 30.0px;">Before the Public API stores settings for the <code>FieldType</code> in a <code>FieldDefinition</code>, the type is asked to validate the settings (which were provided by the user). As a result, the <code>FieldType</code> must return if the given settings comply to the schema defined by <code>getSettingsSchema()</code>. <code>validateValidatorConfiguration()</code> Analog to <code>validateFieldSettings()</code>, this method verifies that the given validator configuration complies to the schema provided by <code>getValidatorConfigurationSchema()</code>.</p><p>It is important to note that while the schema definitions of the <code>FieldType</code> maybe both be of arbitrary, serializable format, it is highly recommended to use a simple hash structure. It is highly recommended to follow the `Best practices`_ in order to create future proof schemas.</p>    <div class="aui-message hint shadowed information-macro">
                            <span class="aui-icon icon-hint">Icon</span>
                <div class="message-content">
                            <p><strong>Note:</strong> Since it is not possible to enforce a schema format, the code using a specific <code>FieldType</code> must basically know all <code>FieldType</code>s it deals with.</p><p>This will also apply to all user interfaces and the REST API, which therefore must provide extension points to register handling code for custom <code>FieldType</code>. These extensions are not defined, yet.</p>
                    </div>
    </div>
<h3 id="FieldTypeAPIandbestpractices-Valuehandling">Value handling</h3><p>A field type needs to deal with the custom value format provided by it. In order for the public API to work properly, it delegates working with such custom field values to the corresponding FieldType. The <code>SPI\FieldType\FieldType</code> interface therefore provides the following methods:</p><p><code>acceptValue()</code></p><p style="margin-left: 30.0px;">This method is responsible for accepting and converting user input for the field. It checks the input structure it accepts and might build and return a different structure holding the data. An example would be, that the user just provides an HTTP link as a string, which is converted to the value object of the Url FieldType. Unlike the <code>FieldType\Value</code> constructor, it is perfectly acceptable to make this method aware of multiple input types (object or primitive, for instance).</p><p style="margin-left: 30.0px;">Note: The method must assert structural consistency of the value, but must not validate plausibility of the value.</p><p><code>getEmptyValue()</code></p><p style="margin-left: 30.0px;">Through settings, the <code>FieldType</code> can specify, that the user may define a default value for the <code>Field</code> of the type. If no such default is provided by the user, the <code>FieldType</code> itself is asked for an &quot;empty value&quot; as the final fallback. The value chain for a specific field is therefore like this, when a <code>Field</code> of the <code>FieldType</code> is filled out:</p><ol><li style="list-style-type: none;"><ol><li>Is a value provided by the filling user?</li><li>Is a default provided by the <code>FieldDefinition</code>?</li><li>Take the empty value provided by the <code>FieldType</code></li></ol></li></ol><p><code>validate()</code></p><p style="margin-left: 30.0px;">In contrast to <code>acceptValue()</code> this method validates the plausibility of the given value, based on the <code>FieldType</code> settings and validator configuration, stored in the corresponding <code>FieldDefinition</code>.</p><div class="section"><h3 id="FieldTypeAPIandbestpractices-Eventhandling">Event handling</h3><p><code>FieldType</code>s can react to various events that occur on content objects that contain a field of their type. The <code>FieldType</code> is informed about an event by the method <code>handleEvent()</code>, which receives an event object of one of the following classes:</p><p><code>PreCreateEvent</code></p><p style="margin-left: 30.0px;">Issued right before a <code>Field</code> of <code>FieldType</code> is created.</p><p><code>PostCreateEvent</code></p><p style="margin-left: 30.0px;">Issued right after a <code>Field</code> of <code>FieldType</code> has been created.</p><p><code>PrePublishEvent</code></p><p style="margin-left: 30.0px;">Issued right before the <code>Content</code> is published.</p><p><code>PostPublishEvent</code></p><p style="margin-left: 30.0px;">Issued right after the <code>Content</code> has been published.</p><p>Each of the events carries context data with it, which can be used to perform the desired event reactions.</p><div class="note"><p> </p>    <div class="aui-message hint shadowed information-macro">
                            <span class="aui-icon icon-hint">Icon</span>
                <div class="message-content">
                            <strong>Note:</strong> It may occur that additional events are added to the SPI in future. You should therefore make sure that you check for the desired events using the instanceof operator.
                    </div>
    </div>
<p> </p></div></div><div class="section"><h3 id="FieldTypeAPIandbestpractices-Storageconversion">Storage conversion</h3><p>As said above, the value format of a <code>FieldType</code> is free form. However, in order to make Exponential store the value in it's database, it must comply to certain rules at storage time. To not restrict the value itself, a <code>FieldValue</code> must be converted to the storage specific format used by the Persistence SPI: <code>eZ\Publish\SPI\Persistence\Content\FieldValue</code>. After restoring a Field of <code>FieldType</code>, the conversion must be undone. The following methods of the <code>FieldType</code> are responsible for that:</p><p><code>toPersistenceValue()</code></p><p style="margin-left: 30.0px;">This method receives the value of a <code>Field</code> of <code>FieldType</code> and must return an SPI <code>FieldValue</code>, which can be stored.</p><p><code>fromPersistenceValue()</code></p><p style="margin-left: 30.0px;">As the counterpart, this method receives an SPI <code>FieldValue</code> and must reconstruct the original value of the <code>Field</code> from it.</p><p>The SPI FieldValue struct has several properties, which might be used by the FieldType as follows:</p><p><code>$data</code></p><p style="margin-left: 30.0px;">The data to be stored in the Exponential database. This may either be a scalar value, a hash map or a simple, serializable object.</p><p><code>$externalData</code></p><p style="margin-left: 30.0px;">The arbitrary data stored in this field will not be touched by any of the Exponential components directly, but will be hold available for `Storing external data`_.</p><p><code>$sortKey</code></p><p style="margin-left: 30.0px;">An value which can be used to sort <code>Content</code> by the field.</p><div class="note"><p class="last" style="margin-left: 30.0px;"><em>Note: TBD: Where will you register the Indexable implementations?</em></p></div></div><div class="section"><h2 id="FieldTypeAPIandbestpractices-Searching">Searching</h2><p>Fields, or a custom field type, might contain or maintain data which is relevant for user searches. To make the search engine aware of the data in your field type you need to implement an additional interface and register the implementation.</p><p>If your field type does not maintain any data, which should be available to search engines, feel free to just ignore this section.</p><p>The<code> eZ\Publish\SPI\FieldType\Indexable</code> defines two methods, which are required to be implemented, if the field type provides data relevant to search engines. The interface defines two methods for this:</p><p><code>getIndexData( Field $field )</code></p><p style="margin-left: 30.0px;">This method is supposed to return the actual index data for the provided <code>eZ\Publish\SPI\Persistence\Content\Field</code>. The index data consists of an array of <code>eZ\Publish\SPI\Persistence\Content\Search\Field</code> instances. They are described below in further detail.</p><p><code>getIndexDefinition()</code></p><p style="margin-left: 30.0px;">To be able to query data properly an indexable field type also is required to return search specification. You must return a hash map of <code>eZ\Publish\SPI\Persistence\Content\Search\FieldType</code> instances from this method, which could look like:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script type="syntaxhighlighter" class="theme: Eclipse; brush: php; gutter: false"><![CDATA[array(
    &#39;url&#39;  =&gt; new Search\FieldType\StringField(),
    &#39;text&#39; =&gt; new Search\FieldType\StringField(),
)]]></script>
</div></div><p style="margin-left: 30.0px;"> This example from the <code>Url</code> field type shows that the field type will always return two indexable values, both strings. They have the names <code>url</code> and <code>text</code> respectively.</p><div class="section"><h3 id="FieldTypeAPIandbestpractices-SearchFieldValues">Search Field Values</h3><p>The search field values, returned by the <code>getIndexData</code> method are simple value objects consisting of the following properties:</p><p><code>$name</code></p><p style="margin-left: 30.0px;">The name of the field</p><p><code>$value</code></p><p style="margin-left: 30.0px;">The value of the field</p><p><code>$type</code></p><p style="margin-left: 30.0px;">An <code>eZ\Publish\SPI\Persistence\Content\Search\FieldType</code> instance, describing the type information of the field.</p></div><div class="section"><h3 id="FieldTypeAPIandbestpractices-SearchFieldTypes">Search Field Types</h3><p>There are bunch of available search field types, which are automagically handled by our Search backend configuration. When using those there is no requirement to adapt , for example, the Solr configuration in any way. You can always use custom field types, though, but these might require re-configuration of the search backend. For Solr this would mean adapting the schema.xml.</p><p>The default available search field types are:</p><p><code>StringField.php</code></p><p style="margin-left: 30.0px;">Standard string values. Will also be queries by full text searches.</p><p><code>TextField.php</code></p><p style="margin-left: 30.0px;">Standard text values. Will be queried by full text searches. Configured text normalizations in the search backend apply.</p><p><code>BooleanField.php</code></p><p style="margin-left: 30.0px;">Boolean values.</p><p><code>DateField.php</code></p><p style="margin-left: 30.0px;">Date field. Can be used for date range queries.</p><p><code>FloatField.php</code></p><p style="margin-left: 30.0px;">Field for floating point numbers.</p><p><code>IntegerField.php</code></p><p style="margin-left: 30.0px;">Field for integer numbers.</p><p><code>PriceField.php</code></p><p style="margin-left: 30.0px;">Field for price values. Currency conversion might be applied by the search backends. Might require careful configuration.</p><p><code>IdentifierField.php</code></p><p style="margin-left: 30.0px;">Field used for IDs. Basically acts like the string field, but will not be queried by fulltext searches</p><p><code>CustomField.php</code></p><p style="margin-left: 30.0px;">Custom field, for custom search data types. Will probably require additional configuration in the search backend.</p></div><div class="section"><h3 id="FieldTypeAPIandbestpractices-ConfiguringSolr">Configuring Solr</h3><p>As mentioned before, if you are using the standard type definitions <strong>there is no need to configure the search backend in any way</strong>. Everything will work fine. The field definitions are handled using <code>dynamicField</code> definitions in Solr, for example.</p><p>If you want to configure the handling of your field, you can always add a special field definition the Solr <code>schema.xml</code>. The field type names, which are used by the Solr search backend look like this for fields: <code><span class="pre">&lt;content_type_identifier&gt;/&lt;field_identifier&gt;/&lt;search_field_name&gt;_&lt;type&gt;</span></code>. You can, of course define custom <code>dynamicField</code> definitions to match, for example, on your custom <code>_&lt;type&gt;</code> definition.</p><p>You could also define a custom field definition dedicatedly for certain fields, like for the name field in an article:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script type="syntaxhighlighter" class="theme: Eclipse; brush: html/xml; gutter: false"><![CDATA[&lt;field name=&quot;article/name/value_s&quot; type=&quot;string&quot; indexed=&quot;true&quot; stored=&quot;true&quot; required=&quot;false&quot;/&gt;]]></script>
</div></div><p>If you want to learn more about the Solr implementation and detailed information about configuring it, check out the <a class="unresolved" href="#">Solr Search Service Implementation Notes</a>.</p></div><div class="section"><h3 id="FieldTypeAPIandbestpractices-RegisteraFieldType">Register a FieldType</h3><p>To register a FieldType, see <a href="../display/EZP/Register%2bFieldType.html">Register FieldType</a>.</p><p>To be integrated in unit and integration tests, FieldTypes need to be registered through the service.ini in eZ/Publish/Core/settings.</p></div></div><div class="section"><h2 id="FieldTypeAPIandbestpractices-Storingexternaldata">Storing external data</h2><p>A <code>FieldType</code> may store arbitrary data in external data sources and is in fact encouraged to do so. External storages can be e.g. a web service, a file in the file system, another database or even the Exponential database itself (in form of a non-standard table). In order to perform this task, the <code>FieldType</code> will interact with the Persistence SPI, which can be found in <code>eZ\Publish\SPI\Persistence</code>, through the <code>eZ\Publish\SPI\FieldType\FieldStorage</code> interface.</p><p>Whenever the internal storage of a Content that includes a Field of the <code>FieldType</code> is accessed, one of the following methods is called to also access the external data:</p><p><code>hasFieldData()</code></p><p style="margin-left: 30.0px;">Returns if the <code>FieldType</code> stores extrnal data at all.</p><p><code>storeFieldData()</code></p><p style="margin-left: 30.0px;">Called right before a <code>Field</code> of <code>FieldType</code> is stored. The method should perform the storing of <code>$externalData</code>. The method must return <code>true</code>, if the call manipulated <strong>internal data</strong> of the given <code>Field</code>, so that it is updated in the internal database.</p><p><code>getFieldData()</code></p><p style="margin-left: 30.0px;">Is called after a <code>Field</code> has been restored from the database in order to restore <code>$externalData</code>.</p><p><code>deleteFieldData()</code></p><p style="margin-left: 30.0px;">Must delete external data for the given <code>Field</code>, if exists.</p><p><code>getIndexData()</code></p><p style="margin-left: 30.0px;">See search service</p><p>Each of the above methods receive a $context array, which contains information on the underlying storage and the environment. This context can be used to store data in the Exponential data storage, but outside of the normal structures (e.g. a custom table in an SQL database). Note that the FieldType must take care on it's own for being compliant to different data sources and that 3rd parties can extend the data source support easily. For more information about this, take a look at the <a class="reference internal" rel="nofollow">Best practices</a> section.</p></div><div class="section"><h2 id="FieldTypeAPIandbestpractices-LegacyStorageconversion">Legacy Storage conversion</h2><p>The <code>FieldType</code> system is designed for future storage back ends of Exponential. However, the old database schema (<em>Legacy Storage</em>) must still be supported. Since this database cannot store arbitrary value information as provided by a <code>FieldType</code>, another conversion step must take place if the Legacy Storage is used.</p><p>The conversion takes place through the interface <code>eZ\Publish\Core\Persistence\Legacy\Content\FieldValue\Converter</code>, which you must provide an implementation of with your <code>FieldType</code>. The following methods are contained in the interface:</p><p><code>toStorageValue()</code></p><p style="margin-left: 30.0px;">Converts a Persistence <code>Value</code> into a legacy storage specific value.</p><p><code>fromStorageValue()</code></p><p style="margin-left: 30.0px;">Converts the other way around.</p><p><code>toStorageFieldDefinition()</code></p><p style="margin-left: 30.0px;">Converts a Persistence <code>FieldDefinition</code> to a storage specific one.</p><p><code>fromStorageFieldDefinition</code></p><p style="margin-left: 30.0px;">Converts the other way around.</p><p><code>getIndexColumn()</code></p><p style="margin-left: 30.0px;">Returns the storage column which is used for indexing.</p><div class="section"><h3 id="FieldTypeAPIandbestpractices-Registeringaconverter">Registering a converter</h3><p>The registration of a <code>Converter</code> currently works through the <code>$config</code> parameter of <code>eZ\Publish\Core\Persistence\Legacy\Handler</code>. See the class documentation for further details.</p><div class="note"><p> </p>    <div class="aui-message hint shadowed information-macro">
                            <span class="aui-icon icon-hint">Icon</span>
                <div class="message-content">
                            For global service container integration, see <a href="../display/EZP/Register%2bFieldType.html">Register FieldType</a>.
                    </div>
    </div>
<p> </p></div></div></div><div class="section"><h2 id="FieldTypeAPIandbestpractices-Bestpractices">Best practices</h2><p>In this chapter, best practices for implementing a custom <cite>FieldType</cite> are collected. We highly encourage following these practices to be future proof.</p><div class="section"><h3 id="FieldTypeAPIandbestpractices-GatewaybasedStorage">Gateway based Storage</h3><p>In order to allow the usage of a <code>FieldType</code> that uses external data with different data storages, it is recommended to implement a gateway infrastructure and a registry for the gateways. In order to ease this action, the Core implementation of <code>FieldType</code> s provides corresponding interfaces and base classes. These can also be used for custom field types.</p><p>The interface <code>eZ\Publish\Core\FieldType\StorageGateway</code> is implemented by gateways, in order to be handled correctly by the registry. It has only a single method:</p><p><code>setConnection()</code></p><p style="margin-left: 30.0px;">The registry mechanism uses this method to set the SPI storage connection (e.g. the database connection to the Legacy Storage database) into the gateway, which might be used to store external data. The connection is retrieved from the <code>$context</code> array  automatically by the registry.</p><p>Note that the Gateway implementation itself must take care about validating that it received a usable connection. If it did not, it should throw a <code>RuntimeException</code>.</p><p>The registry mechanism is realized as a base class for <code>FieldStorage</code> implementations: <code>eZ\Publish\Core\FieldType\GatewayBasedStorage</code>. For managing <code>StorageGateway</code> s, the following methods are already implemented in the base class:</p><p><code>addGateway()</code></p><p style="margin-left: 30.0px;">Allows the registration of additional <code>StorageGateway</code>s from the outside. Furthermore, a hash map of <code>StorageGateway</code>s can be given to the constructor for basic initialization. This array should orginate from the Dependency Injection mechanism.</p><p><code>getGateway()</code></p><p style="margin-left: 30.0px;">This protected method is used by the implementation to retrieve the correct <code>StorageGateway</code> for the current context.</p><p>As a reference for the usage of these infrastructure, the Keyword, Url and User types can be examined.</p></div><div class="section"><h3 id="FieldTypeAPIandbestpractices-Settingsschema">Settings schema</h3><p>It is recommended to use a simple hash map format for the settings schema retured by <span class="pre">eZ\Publish\SPI\FieldType\FieldType::getSettingsSchema()</span>, which follows these rules:</p><ul class="simple"><li>The key of the hash map identifies a setting (e.g. <code>default</code>)</li><li>Its value is a hash map (2nd level) describing the setting using<br /><ul><li><code>type</code> to identify the setting type (e.g. <code>int</code> or <code>string</code>)</li><li><code>default</code> containing the default setting value</li></ul></li></ul><p>An example schema could look like this:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script type="syntaxhighlighter" class="theme: Eclipse; brush: php; gutter: false"><![CDATA[array(
    &#39;backupData&#39; =&gt; array(
        &#39;type&#39; =&gt; &#39;bool&#39;,
        &#39;default&#39; =&gt; false
    ),
    &#39;defaultValue&#39; =&gt; array(
        &#39;type&#39; =&gt; &#39;string&#39;,
        &#39;default&#39; =&gt; &#39;Sindelfingen&#39;
    )
);]]></script>
</div></div><p> </p></div><div class="section"><h3 id="FieldTypeAPIandbestpractices-Validatorschema">Validator schema</h3><p>The schema for validator configuration should have a similar format than the settings schema has, except it has an additional level, to group settings for a certain validation mechanism:</p><ul class="simple"><li>The key on the 1st level is a string, identifying a validator</li><li>Assigned to that is a hash map (2nd level) of settings</li><li>This hash map has a string key for each setting of the validator</li><li>It is assigned to a 3rd level hashmap, the setting description</li><li>This hash map should have the same format as for normal settings</li></ul><p>For example, for the <code>ezstring</code> type, the validator schema could be:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script type="syntaxhighlighter" class="theme: Eclipse; brush: php; gutter: false"><![CDATA[array(
    &#39;stringLength&#39; =&gt; array(
        &#39;minStringLength&#39; =&gt; array(
            &#39;type&#39;    =&gt; &#39;int&#39;,
            &#39;default&#39; =&gt; 0,
        ),
        &#39;maxStringLength&#39; =&gt; array(
            &#39;type&#39;    =&gt; &#39;int&#39;
            &#39;default&#39; =&gt; null,
        )
    ),
);]]></script>
</div></div><p> </p></div></div><h2 id="FieldTypeAPIandbestpractices-Testing">Testing</h2><p><code>FieldType</code> s should be integration tested on 1 different levels:</p><ol class="arabic simple"><li>Their integration with the Persistence SPI</li><li>Their integration with the Public API</li></ol><p>For both test environments, infrastructure is already in place, so that you can easily implement the required tests for your custom <code>FieldType</code></p><div class="section"><h3 id="FieldTypeAPIandbestpractices-PersistenceSPI">Persistence SPI</h3><p>This type of integration test ensures, that a FieldType stores its data properly on basis of different Persistence SPI implementations.</p><div class="note"><p> </p>    <div class="aui-message hint shadowed information-macro">
                            <span class="aui-icon icon-hint">Icon</span>
                <div class="message-content">
                            <strong>Note:</strong> By now, only the Legacy Storage implementation exists.
                    </div>
    </div>
<p> </p></div><p>The integration tests with the Persistence SPI can be found in <code>eZ\Publish\SPI\Tests\FieldType</code>. In order to implement a test for your custom <code>FieldType</code>, you need to extend the common base class <code>eZ\Publish\SPI\Tests\FieldType\BaseIntegrationTest</code> and implement it's abstract methods. As a reference the <code>KeywordIntegrationTest</code>, <code>UrlIntegrationTest</code> and <code>UserIntegrationTest</code> can deal.</p><p>Running the test is fairly simple: Just specify the global <code>phpunit.xml</code> for PHPUnit configuration and make it execute a single test or a directory of tests, for example:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script type="syntaxhighlighter" class="theme: Eclipse; brush: bash; gutter: false"><![CDATA[$ phpunit -c phpunit.xml eZ/Publish/SPI/Tests/FieldType]]></script>
</div></div><p>in order to run all <code>FieldType</code> tests.</p></div><h3 id="FieldTypeAPIandbestpractices-PublicAPI">Public API</h3><p>On a second level, the interaction between an implementation of the Public API (aka the Business Layer) and the FieldType is tested. Again, there is a common base class as the infrastructural basis for such tests, which resides in <code>eZ\Publish\API\Repository\Tests\FieldType\BaseIntegrationTest</code>.</p><div class="note"><p> </p>    <div class="aui-message hint shadowed information-macro">
                            <span class="aui-icon icon-hint">Icon</span>
                <div class="message-content">
                            <p>Note that the In-Memory stubs for the Public API integration test suite, do not perform actual FieldType calls, but mainly emulate the behavior of a FieldType for simplicity reasons.</p><p>If your FieldType needs to convert data between <code>storeFieldData()</code> and <code>getFieldData()</code>, you need to implement a <code>eZ\Publish\API\Repository\Tests\Stubs\PseudoExternalStorage</code> in addition, which performs this task. Running the tests against the Business Layer implementation of the Public API is not affected by this.</p>
                    </div>
    </div>
<p> </p></div><dl /><dl /><p> </p>

                
        
    
        </div>

        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="https://doc.ez.no/pages/viewpage.action?pageId=10158260"
    dc:identifier="https://doc.ez.no/pages/viewpage.action?pageId=10158260"
    dc:title="Field Type API and best practices"
    trackback:ping="https://doc.ez.no/rpc/trackback/10158260"/>
</rdf:RDF>
-->

            
    



<div id="labels-section" class="pageSection group">
    <div class="labels-section-content content-column" entityid="10158260" entitytype="page">
	<div class="labels-content">
		
    <ul class="label-list label-list-right ">
            <li class="no-labels-message">
            No labels
        </li>
            </ul>

    </div>
</div></div>

            
            




            
    








                    
    
<div id="comments-section" class="pageSection group">
    
    
    
    
            <div class="bottom-comment-panels comment-panels">
                                    
    


    
            </div>
    
    </div>


            
</div>


    




    
    

    
    
    








</div>
  
        <div id="theme-footer">
            <div class="sectionColumnWrapper"><div class="sectionMacro">
<div class="sectionMacroRow"><div class="columnMacro"></div>
<div class="columnMacro">
<div class="panel" style="background-color: #ecf0f1;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #ecf0f1;">
<p>Where Content Means Business</p>
</div></div></div>
<div class="columnMacro"></div></div></div></div>
        </div>
    
    </div>
</div>


        
            <div id="footer">

    <section class="footer-body">

                                                <p class="license license-opensource">
                  Powered by a free <b>Atlassian Confluence Open Source Project License</b> granted to Exponential. <a href="http://www.atlassian.com/c/conf/11461">Evaluate Confluence today</a>.<br>
                </p>
                        
    

    <ul id="poweredby">
        <li class="noprint">Powered by <a href="http://www.atlassian.com/software/confluence" class="hover-footer-link">Atlassian Confluence</a> <span id='footer-build-information'>5.4.4</span>, <a href="http://www.atlassian.com/software/confluence/overview/team-collaboration-software?utm_source=confluence-footer" class="hover-footer-link">Team Collaboration Software</a></li>
        <li class="print-only">Printed by Atlassian Confluence 5.4.4, Team Collaboration Software.</li>
        <li class="noprint"><a href="http://jira.atlassian.com/secure/BrowseProject.jspa?id=10470" class="hover-footer-link">Report a bug</a></li>
        <li class="noprint"><a href="http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch" class="hover-footer-link">Atlassian News</a></li>
    </ul>

    

            <script>
AJS.toInit(function(){
 if(AJS.params.spaceKey &&
    AJS.params.spaceKey === 'MAIN' ||
    AJS.params.spaceKey === 'EZMA' ||
    AJS.params.spaceKey === 'ODC' ||
    AJS.params.spaceKey === 'EZP50' ||
    AJS.params.spaceKey === 'EZP51' ||
    AJS.params.spaceKey === 'EZP52' ||
    AJS.params.spaceKey === 'EZPCLOUD' ||
    AJS.params.spaceKey === 'EZP' ||
    AJS.params.spaceKey === 'EZRECO'
){

(function()
{var isSecure=('https:'==document.location.protocol);var ff=document.createElement('script');ff.type='text/javascript';ff.async=true;ff.src=(isSecure?'https':'http')+'://'+(isSecure?'secure.':'lb.')+'liveviewer.ez.no/statjs/sst-120-1304513615/stat.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ff,s);}
)();

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-303624-13', 'ez.no');
  ga('send', 'pageview');
}}
);
</script>
    
    </section>

</div>

            
    </div>
</body>

<!-- Mirrored from doc.ez.no/pages/viewpage.action?pageId=10158260&navigatingVersions=true by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 15:19:49 GMT -->
</html>
