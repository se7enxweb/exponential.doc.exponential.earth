Message-ID: <1547931846.3388.1485852906357.JavaMail.confluence@ip-10-127-227-164>
Subject: Exported From Confluence
MIME-Version: 1.0
Content-Type: multipart/related; 
	boundary="----=_Part_3387_790987492.1485852906341"

------=_Part_3387_790987492.1485852906341
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
Content-Location: file:///C:/exported.html

<html xmlns:o=3D'urn:schemas-microsoft-com:office:office'
      xmlns:w=3D'urn:schemas-microsoft-com:office:word'
      xmlns:v=3D'urn:schemas-microsoft-com:vml'
      xmlns=3D'urn:w3-org-ns:HTML'>
<head>
    <meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Dutf-8=
">
    <title>The Page Field Type</title>
    <!--[if gte mso 9]>
    <xml>
        <o:OfficeDocumentSettings>
            <o:TargetScreenSize>1024x640</o:TargetScreenSize>
            <o:PixelsPerInch>72</o:PixelsPerInch>
            <o:AllowPNG/>
        </o:OfficeDocumentSettings>
        <w:WordDocument>
            <w:View>Print</w:View>
            <w:Zoom>90</w:Zoom>
            <w:DoNotOptimizeForBrowser/>
        </w:WordDocument>
    </xml>
    <![endif]-->
    <style>
                <!--
        @page Section1 {
            size: 8.5in 11.0in;
            margin: 1.0in;
            mso-header-margin: .5in;
            mso-footer-margin: .5in;
            mso-paper-source: 0;
        }

        td {
            page-break-inside: avoid;
        }

        tr {
            page-break-after: avoid;
        }

        div.Section1 {
            page: Section1;
        }

        /* Confluence print stylesheet. Common to all themes for print medi=
a */
/* Full of !important until we improve batching for print CSS */

@media print {
    #main {
        padding-bottom: 1em !important; /* The default padding of 6em is to=
o much for printouts */
    }

    body {
        font-family: Arial, Helvetica, FreeSans, sans-serif;
        font-size: 10pt;
        line-height: 1.2;
    }

    body, #full-height-container, #main, #page, #content, .has-personal-sid=
ebar #content {
        background: #fff !important;
        color: #000 !important;
        border: 0 !important;
        width: 100% !important;
        height: auto !important;
        min-height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        display: block !important;
    }

    a, a:link, a:visited, a:focus, a:hover, a:active {
        color: #000;
    }

    #content h1,
    #content h2,
    #content h3,
    #content h4,
    #content h5,
    #content h6 {
        font-family: Arial, Helvetica, FreeSans, sans-serif;
        page-break-after: avoid;
    }

    pre {
        font-family: Monaco, "Courier New", monospace;
    }

    #header,
    .aui-header-inner,
    #navigation,
    #sidebar,
    .sidebar,
    #personal-info-sidebar,
    .ia-fixed-sidebar,
    .page-actions,
    .navmenu,
    .ajs-menu-bar,
    .noprint,
    .inline-control-link,
    .inline-control-link a,
    a.show-labels-editor,
    .global-comment-actions,
    .comment-actions,
    .quick-comment-container,
    #addcomment {
        display: none !important;
    }

    .comment .date::before {
        content: none !important; /* remove middot for print view */
    }

    h1.pagetitle img {
        height: auto;
        width: auto;
    }

    .print-only {
        display: block;
    }

    #footer {
        position: relative !important; /* CONF-17506 Place the footer at en=
d of the content */
        margin: 0;
        padding: 0;
        background: none;
        clear: both;
    }

    #poweredby {
        border-top: none;
        background: none;
    }

    #poweredby li.print-only {
        display: list-item;
        font-style: italic;
    }

    #poweredby li.noprint {
        display: none;
    }

    /* no width controls in print */
    .wiki-content .table-wrap,
    .wiki-content p,
    .panel .codeContent,
    .panel .codeContent pre,
    .image-wrap {
        overflow: visible !important;
    }

    /* TODO - should this work? */
    #children-section,
    #comments-section .comment,
    #comments-section .comment .comment-body,
    #comments-section .comment .comment-content,
    #comments-section .comment p {
        page-break-inside: avoid;
    }

    #page-children a {
        text-decoration: none;
    }

    /**
     hide twixies

     the specificity here is a hack because print styles
     are getting loaded before the base styles. */
    #comments-section.pageSection .section-header,
    #comments-section.pageSection .section-title,
    #children-section.pageSection .section-header,
    #children-section.pageSection .section-title,
    .children-show-hide {
        padding-left: 0;
        margin-left: 0;
    }

    .children-show-hide.icon {
        display: none;
    }

    /* personal sidebar */
    .has-personal-sidebar #content {
        margin-right: 0px;
    }

    .has-personal-sidebar #content .pageSection {
        margin-right: 0px;
    }
}
-->
    </style>
</head>
<body>
    <h1>The Page Field Type</h1>
    <div class=3D"Section1">
        <div class=3D"confluence-information-macro confluence-information-m=
acro-warning">
<p class=3D"title">Deprecated</p>
<span class=3D"aui-icon aui-icon-small aui-iconfont-error confluence-inform=
ation-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p>The Page Field Type has as of first stable releases of eZ Platform 15.12=
 and eZ Studio 15.12 been deprecated. A replacement called <a href=3D"https=
://doc.ez.no/display/TECHDOC/The+LandingPage+FieldType" rel=3D"nofollow">La=
ndingPage</a> is provided with eZ Studio and tools for migration are planne=
d to be provided together with 16.02/16.04 release. At that point Page Fiel=
d Type will not be bundled anymore.</p>
</div>
</div>
<p>&nbsp;</p>
<p><style type=3D"text/css">/*<![CDATA[*/
div.rbtoc1485852905997 {padding: 0px;}
div.rbtoc1485852905997 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1485852905997 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style></p>
<div class=3D"toc-macro rbtoc1485852905997">=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#ThePageFieldType-Description">Description</a></li>=20
<li><a href=3D"#ThePageFieldType-Configuration">Configuration</a>=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#ThePageFieldType-Definingazonelayout">Defining a zone layou=
t</a></li>=20
<li><a href=3D"#ThePageFieldType-Availableblocks">Available blocks</a></li>=
=20
<li><a href=3D"#ThePageFieldType-Blocktemplateselection">Block template sel=
ection</a>=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#ThePageFieldType-Availablematchers">Available matchers</a><=
/li>=20
</ul> </li>=20
</ul> </li>=20
<li><a href=3D"#ThePageFieldType-DisplayingthePagecontent">Displaying the P=
age content</a>=20
<ul class=3D"toc-indentation">=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#ThePageFieldType-Variablespassedtothelayouttemplate">Variab=
les passed to the layout template</a></li>=20
</ul>=20
<li><a href=3D"#ThePageFieldType-Renderingblocks">Rendering blocks</a>=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#ThePageFieldType-Usingez_page:viewBlock">Using&nbsp;ez_page=
:viewBlock</a>=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#ThePageFieldType-Availablearguments">Available arguments</a=
></li>=20
<li><a href=3D"#ThePageFieldType-Variablesexposedtotheblocktemplate">Variab=
les exposed to the block template</a></li>=20
</ul> </li>=20
<li><a href=3D"#ThePageFieldType-UsingpageView:viewBlockById">Using pageVie=
w:viewBlockById</a>=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#ThePageFieldType-Availablearguments.1">Available arguments<=
/a></li>=20
</ul> </li>=20
<li><a href=3D"#ThePageFieldType-RenderingBlockitems">Rendering Block items=
</a></li>=20
</ul> </li>=20
<li><a href=3D"#ThePageFieldType-ThePageServiceobject">The PageService obje=
ct</a>=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#ThePageFieldType-Mainmethods">Main methods</a></li>=20
</ul> </li>=20
<li><a href=3D"#ThePageFieldType-ExampleExample">Example</a></li>=20
</ul> </li>=20
</ul>=20
</div>
<p></p>
<h2 id=3D"ThePageFieldType-Description">Description</h2>
<p>With the Page Field Type, in legacy part of "ezflow" extension, editors =
can define a&nbsp;<strong>layout</strong>&nbsp;with&nbsp;<strong>multiple z=
ones</strong>&nbsp;within a single front- or landing-page.</p>
<p>Within each zone, editors create&nbsp;<strong>blocks</strong>&nbsp;that =
contain particular content categories. Specific content can be added to the=
se blocks, they are called&nbsp;<strong>block items</strong>.</p>
<p>This is particularly useful for managing homepages/landing pages.</p>
<div class=3D"confluence-information-macro confluence-information-macro-not=
e">
<span class=3D"aui-icon aui-icon-small aui-iconfont-warning confluence-info=
rmation-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p>The Page Field Type has limited write support with the Public API as of =
<span class=3D"jira-issue resolved"> <a href=3D"https://jira.ez.no/browse/E=
ZP-25413?src=3Dconfmacro" class=3D"jira-issue-key"><img class=3D"icon" src=
=3D"https://jira.ez.no/images/icons/issuetypes/improvement.png">EZP-25413</=
a> - <span class=3D"summary">Page FieldType Public API should save custom a=
ttributes and rotation</span>=20
<!-- The new status lozengens support for JIRA 6.2 or later. Otherwise we u=
se the icon.--> <span class=3D"aui-lozenge aui-lozenge-subtle aui-lozenge-s=
uccess jira-macro-single-issue-export-pdf">Closed</span> </span> with 16.04=
 <em>(v1.3.0)</em> release, before this it where read-only. In all versions=
 it is still possible to edit content with it through the admin interface <=
em>(which runs through the legacy stack)</em>.&nbsp;</p>
</div>
</div>
<div class=3D"table-wrap">
<table class=3D"confluenceTable">
<tbody>
<tr>
<th class=3D"confluenceTh">Name</th>
<th class=3D"confluenceTh">Internal name</th>
<th colspan=3D"1" class=3D"confluenceTh">Expected input</th>
<th colspan=3D"1" class=3D"confluenceTh">Output</th>
</tr>
<tr>
<td class=3D"confluenceTd"><code>Page</code></td>
<td class=3D"confluenceTd"><code>ezpage</code></td>
<td colspan=3D"1" class=3D"confluenceTd"><code>N/A</code></td>
<td colspan=3D"1" class=3D"confluenceTd"><code>eZ\Publish\Core\FieldType\Pa=
ge\Parts\Page </code></td>
</tr>
</tbody>
</table>
</div>
<h2 id=3D"ThePageFieldType-Configuration">Configuration</h2>
<div class=3D"confluence-information-macro confluence-information-macro-war=
ning">
<p class=3D"title">Warning</p>
<span class=3D"aui-icon aui-icon-small aui-iconfont-error confluence-inform=
ation-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p>You still need to define your available layouts and blocks in the legacy=
 part to get them available in the admin interface. Please refer to <a href=
=3D"http://doc.ez.no/Extensions/Exponential-extensions/eZ-Flow/eZ-Flow-2.5/C=
onfiguration/Configuring-the-eZ-Flow-block-system" class=3D"external-link" =
rel=3D"nofollow">Exponential legacy documentation</a> to learn how to do so.=
</p>
</div>
</div>
<h3 id=3D"ThePageFieldType-Definingazonelayout">Defining a zone layout</h3>
<p><span>A layout is a combination of zones that are placed on a page. The =
placement of the zones is defined in a template that is specified as part o=
f the layout configuration. You can define as many layouts as you need.</sp=
an></p>
<p>You can define a new layout and enable it in your main YAML configuratio=
n:</p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeHeader panelHeader pdl" style=3D"border-bottom-width: 1px=
;">
<b>ezplatform.yml</b>
</div>
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: php; gutter: false; theme: Eclipse" style=3D"font-size=
:12px;">exponential:
    system:
        my_siteaccess:
            ezpage:
                layouts:
                    myLayoutIdentifier:
                        name: "My =C3=BCber cool layout"
                        template: "AcmeDemoBundle:page/zonelayouts:my_templ=
ate.html.twig"
=09=09=09=09enabledLayouts: [myLayoutIdentifier]</pre>=20
</div>
</div>
<p>Then, when rendering a Page Field Type using&nbsp;<code>myLayoutIdentifi=
er</code>,&nbsp;<code>Resources/views/page/zonelayouts/my_template.html.twi=
g</code>&nbsp;from AcmeDemoBundle will be used (see&nbsp;<a href=3D"http://=
symfony.com/doc/master/book/controller.html#rendering-templates" class=3D"e=
xternal-link" rel=3D"nofollow">how to use template identifiers in Symfony d=
ocumentation</a>).</p>
<div class=3D"confluence-information-macro confluence-information-macro-tip=
">
<p class=3D"title">Tip</p>
<span class=3D"aui-icon aui-icon-small aui-iconfont-approve confluence-info=
rmation-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p>You can specify a legacy template in your layout definition.</p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: php; gutter: false; theme: Eclipse" style=3D"font-size=
:12px;">exponential:
    system:
        my_siteaccess:
            ezpage:
                layouts:
                    myLegacyLayout:
                        name: My legacy layout
                        template: "design:zone/my_legacy_template.tpl"
=09=09=09=09enabledLayouts: [myLayoutIdentifier]</pre>=20
</div>
</div>
<p><span>However, doing so will defer block display to the legacy templates=
 as well.</span></p>
</div>
</div>
<h3 id=3D"ThePageFieldType-Availableblocks">Available blocks</h3>
<p>The blocks need to be defined and enabled in the YAML configuration as w=
ell:</p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeHeader panelHeader pdl" style=3D"border-bottom-width: 1px=
;">
<b>ezplatform.yml</b>
</div>
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: php; gutter: false; theme: Eclipse" style=3D"font-size=
:12px;">exponential:
    system:
        my_siteaccess:
            ezpage:
                blocks:
                    myBlockIdentifier:
                        name: "My =C3=BCber cool block"
                    myBlockIdentifier2:
                        name: "My =C3=BCber cool block 2"
=09=09=09=09enabledBlocks: [myBlockIdentifier, myBlockIdentifier2]</pre>=20
</div>
</div>
<h3 id=3D"ThePageFieldType-Blocktemplateselection">Block template selection=
</h3>
<div class=3D"confluence-information-macro confluence-information-macro-not=
e">
<span class=3D"aui-icon aui-icon-small aui-iconfont-warning confluence-info=
rmation-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p>Template selection rules are applied only when you render a block with t=
he <code>PageController</code> (using <code><a href=3D"http://ez_pageviewBl=
ock" class=3D"external-link" rel=3D"nofollow">ez_page:viewBlock</a></code> =
from templates), <a href=3D"#ThePageFieldType-Renderingblocks">see below</a=
>.</p>
</div>
</div>
<p><span>Like you are able to&nbsp;</span><a href=3D"/display/TECHDOC/View+=
provider+configuration">define template selection rules when displaying Loc=
ation and Content objects</a><span>, you can also define rules for blocks, =
with dedicated matchers.</span></p>
<p>Configuration is a hash built in the following way:</p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeHeader panelHeader pdl" style=3D"border-bottom-width: 1px=
;">
<b>ezplatform.yml</b>
</div>
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: php; gutter: false; theme: Eclipse" style=3D"font-size=
:12px;">exponential:
    system:
        my_siteaccess:
            block_view:
                # A simple unique key for your matching ruleset
                my_rule_set:
                    # The template identifier to load, following the Symfon=
y bundle notation for templates
                    template: AcmeTestBundle:block:campaign.html.twig
                    # Hash of matchers to use, with their corresponding val=
ues to match against
                    match:
                        # Key is the matcher "identifier" (class name or se=
rvice identifier)
                        # Value will be passed to the matcher's setMatching=
Config() method.
                        Type: Campaign
                another_rule:
                    template: AcmeTestBundle:block:custom_block.html.twig
                    match:
                        Type: CustomBlock</pre>=20
</div>
</div>
<div class=3D"confluence-information-macro confluence-information-macro-tip=
">
<p class=3D"title">Tip</p>
<span class=3D"aui-icon aui-icon-small aui-iconfont-approve confluence-info=
rmation-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p>You can define your template selection rules in a different configuratio=
n file. <a href=3D"/display/TECHDOC/Import+settings+from+a+bundle">Read the=
 cookbook recipe to learn more about it</a>&nbsp;.</p>
</div>
</div>
<div class=3D"confluence-information-macro confluence-information-macro-inf=
ormation">
<span class=3D"aui-icon aui-icon-small aui-iconfont-info confluence-informa=
tion-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p>Matchers for <code>block_view</code> follow the same behavior than <a hr=
ef=3D"/display/TECHDOC/View+provider+configuration#Viewproviderconfiguratio=
n-Matchers">matchers for regular location_view / content_view</a>, except t=
hat their relative namespace will be <code>eZ\Publish\Core\MVC\Symfony\View=
\BlockViewProvider\Configured\Matcher</code> .</p>
<p>Hence you can combine matchers with AND and OR capabilities (<a href=3D"=
https://confluence.ez.no/display/EZP/View+provider+configuration#Viewprovid=
erconfiguration-Matchers" class=3D"external-link" rel=3D"nofollow">see main=
 matchers' documentation page</a>).</p>
</div>
</div>
<h4 id=3D"ThePageFieldType-Availablematchers">Available matchers</h4>
<div class=3D"table-wrap">
<table class=3D"confluenceTable">
<tbody>
<tr>
<th class=3D"confluenceTh">Identifier</th>
<th class=3D"confluenceTh">Description</th>
</tr>
<tr>
<td class=3D"confluenceTd"><code>Type</code></td>
<td class=3D"confluenceTd"><p><span>Matches the unique <strong>block identi=
fier</strong> defined in the legacy&nbsp;</span><code>block.ini</code><span=
>&nbsp;file (<a href=3D"http://doc.ez.no/Extensions/Exponential-extensions/e=
Z-Flow/eZ-Flow-2.5/Configuration/Configuring-the-eZ-Flow-block-system/Defin=
ing-the-eZ-Flow-blocks/Defining-block-types" class=3D"external-link" rel=3D=
"nofollow">see legacy documentation</a>).</span></p><p><span>For example wi=
th the following configuration in legacy block.ini, it will match against <=
code>Manual3Items</code>:</span></p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: php; gutter: false; theme: Eclipse" style=3D"font-size=
:12px;">[Manual3Items]
Name=3D3 Column&nbsp;News</pre>=20
</div>
</div><p><span><br></span></p></td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>View</code></td>
<td colspan=3D"1" class=3D"confluenceTd"><p><span>Matches the <strong>view=
=E2=80=99s unique identifier</strong> defined in the block definition in th=
e legacy&nbsp;</span><code>block.ini</code><span>&nbsp;(see legacy document=
ation).</span></p><p><span>For example with the following configuration in =
legacy <code>block.ini</code>, it will match against <code>3_items1</code>:=
</span></p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: php; gutter: false; theme: Eclipse" style=3D"font-size=
:12px;">[Manual3Items]
Name=3D3 Column News
ViewList[]=3D3_items1</pre>=20
</div>
</div>
<div class=3D"confluence-information-macro confluence-information-macro-inf=
ormation">
<span class=3D"aui-icon aui-icon-small aui-iconfont-info confluence-informa=
tion-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p>When no view is defined, the default value is <strong>default</strong>.<=
/p>
</div>
</div><p><span><br></span></p></td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>Id\Block</code></td>
<td colspan=3D"1" class=3D"confluenceTd">Matches against the block ID, as s=
tored in <code>ezm_block</code> table</td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>Id\Zone</code></td>
<td colspan=3D"1" class=3D"confluenceTd">Matches against the zone ID a bloc=
k belongs to, as stored in <code>ezm_block</code> table</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<h2 id=3D"ThePageFieldType-DisplayingthePagecontent">Displaying the Page co=
ntent</h2>
<div class=3D"confluence-information-macro confluence-information-macro-inf=
ormation">
<span class=3D"aui-icon aui-icon-small aui-iconfont-info confluence-informa=
tion-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p>This section focuses on how to display blocks from zone/layout templates=
.</p>
<p>Render of these templates are triggered when using <code>ez_render_field=
()</code> helper, like for any other field type.</p>
<p><a href=3D"/display/TECHDOC/Content+view#Contentview-Contentview-Usingth=
eFieldType'stemplateblock">See field rendering documentation</a> for more i=
nformation.</p>
</div>
</div>
<p><span style=3D"color: rgb(0,0,0);font-size: 1.4em;font-weight: bold;line=
-height: normal;">Layout template</span></p>
<p>Goal of a&nbsp;<strong>layout</strong>&nbsp;template is to display&nbsp;=
<strong>zones</strong>&nbsp;for the given layout, depending on your layout =
configuration.</p>
<h4 id=3D"ThePageFieldType-Variablespassedtothelayouttemplate">Variables pa=
ssed to the layout template</h4>
<div class=3D"table-wrap">
<table class=3D"confluenceTable">
<tbody>
<tr>
<th class=3D"confluenceTh">Variable name</th>
<th class=3D"confluenceTh">Description</th>
<th class=3D"confluenceTh">Type</th>
</tr>
<tr>
<td class=3D"confluenceTd"><code>zones</code></td>
<td class=3D"confluenceTd">Zone objects for this Page field</td>
<td class=3D"confluenceTd">Array of <code>eZ\Publish\Core\FieldType\Page\Pa=
rts\Zone</code> objects</td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>zone_layout</code></td>
<td colspan=3D"1" class=3D"confluenceTd">The layout identifier (e.g. "2Zone=
sLayout1")</td>
<td colspan=3D"1" class=3D"confluenceTd"><code>string</code></td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>pageService</code></td>
<td colspan=3D"1" class=3D"confluenceTd"><p>The PageService object (read mo=
re below).&nbsp;</p></td>
<td colspan=3D"1" class=3D"confluenceTd"><code>eZ\Bundle\EzPublishCoreBundl=
e\FieldType\Page</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id=3D"ThePageFieldType-Renderingblocks">Rendering blocks</h3>
<p>Each zone contain blocks that hold your content as block items.&nbsp;<sp=
an>To render blocks from a layout template, you need to do a sub-request.</=
span></p>
<div class=3D"confluence-information-macro confluence-information-macro-tip=
">
<p class=3D"title">Tip</p>
<span class=3D"aui-icon aui-icon-small aui-iconfont-approve confluence-info=
rmation-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p>You can use a custom controller to display a block.</p>
<p>However, if you do so, you might need to get access to the <a href=3D"#T=
hePageFieldType-ThePageServiceobj">PageService</a>. You can get it via the =
service container with identifier <code>exponential.fieldType.ezpage.pageServ=
ice</code>.</p>
</div>
</div>
<h4 id=3D"ThePageFieldType-Usingez_page:viewBlock">Using&nbsp;<code>ez_page=
:viewBlock</code></h4>
<p><span>This controller is responsible of choosing the right template for =
your block,&nbsp;<a href=3D"#ThePageFieldType-Blocktemplates">depending on =
the rules you defined</a>.</span></p>
<p><span>You can use this controller from templates with the following synt=
ax:</span></p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: php; gutter: false; theme: Eclipse" style=3D"font-size=
:12px;">{{ render( controller( "ez_page:viewBlock", {'block': myBlock} ) ) =
}}</pre>=20
</div>
</div>
<h5 id=3D"ThePageFieldType-Availablearguments"><span style=3D"color: rgb(51=
,51,51);">Available arguments</span></h5>
<div class=3D"table-wrap">
<table class=3D"confluenceTable">
<tbody>
<tr>
<th class=3D"confluenceTh">Name</th>
<th class=3D"confluenceTh">Description</th>
<th class=3D"confluenceTh">Type</th>
<th class=3D"confluenceTh">Default value</th>
</tr>
<tr>
<td class=3D"confluenceTd"><code>block</code></td>
<td class=3D"confluenceTd">The block object you want to render</td>
<td class=3D"confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Block=
</code></td>
<td class=3D"confluenceTd">N/A</td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>params</code></td>
<td colspan=3D"1" class=3D"confluenceTd"><p>Hash of variables you want to i=
nject to sub-template, key being the exposed variable name.</p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: php; gutter: false; theme: Eclipse" style=3D"font-size=
:12px;">{{ render(
      controller(=20
          "ez_page:viewBlock",=20
          {
              'block': myBlock,
              'params': { 'some_variable': 'some_value' }
          }
      )
) }}</pre>=20
</div>
</div></td>
<td colspan=3D"1" class=3D"confluenceTd">hash</td>
<td colspan=3D"1" class=3D"confluenceTd">empty</td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>cacheSettings</code></td>
<td colspan=3D"1" class=3D"confluenceTd"><p>Hash of cache settings to use b=
y the sub-controller (useful if you use ESI or Hinclude strategies).</p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: php; gutter: false; theme: Eclipse" style=3D"font-size=
:12px;">{{ render_esi(
      controller(=20
          "ez_page:viewBlock",=20
          {
              'block': myBlock,
              'params': { 'some_variable': 'some_value' },
              'cacheSettings': { 'smax-age': 600 }
          }
      )
) }}</pre>=20
</div>
</div></td>
<td colspan=3D"1" class=3D"confluenceTd">hash (accepted keys are <code>max-=
age</code> and <code>smax-age</code>)</td>
<td colspan=3D"1" class=3D"confluenceTd">empty</td>
</tr>
</tbody>
</table>
</div>
<p><span><br></span></p>
<h5 id=3D"ThePageFieldType-Variablesexposedtotheblocktemplate">Variables ex=
posed to the block template</h5>
<div class=3D"table-wrap">
<table class=3D"confluenceTable">
<tbody>
<tr>
<th class=3D"confluenceTh">Variable name</th>
<th class=3D"confluenceTh">Type</th>
<th class=3D"confluenceTh">Description</th>
</tr>
<tr>
<td class=3D"confluenceTd"><code>block</code></td>
<td class=3D"confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Block=
</code></td>
<td class=3D"confluenceTd">The block to display</td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>valid_items</code></td>
<td colspan=3D"1" class=3D"confluenceTd">Array of <code>eZ\Publish\Core\Fie=
ldType\Page\Parts</code></td>
<td colspan=3D"1" class=3D"confluenceTd">Displayable block items</td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>valid_contentinfo_items</cod=
e></td>
<td colspan=3D"1" class=3D"confluenceTd">Array of <code>eZ\Publish\API\Repo=
sitory\Values\Content\ContentInfo</code></td>
<td colspan=3D"1" class=3D"confluenceTd">Displayable block items, as <code>=
ContentInfo</code> objects.</td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>pageService</code> (deprecat=
ed as of v5.2)</td>
<td colspan=3D"1" class=3D"confluenceTd"><code>eZ\Bundle\EzPublishCoreBundl=
e\FieldType\Page\PageService</code></td>
<td colspan=3D"1" class=3D"confluenceTd"><a href=3D"#ThePageFieldType-ThePa=
geServiceo">The PageService object</a> (deprecated)</td>
</tr>
</tbody>
</table>
</div>
<p>And of course, all the additional variables&nbsp;<a href=3D"#ThePageFiel=
dType-Availablear">you injected in the&nbsp;<code>params</code>&nbsp;argume=
nt&nbsp;</a>.</p>
<div class=3D"confluence-information-macro confluence-information-macro-inf=
ormation">
<span class=3D"aui-icon aui-icon-small aui-iconfont-info confluence-informa=
tion-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p><code>valid_items</code> and <code>valid_contentinfo_items</code> variab=
les are available as of <strong>v5.2 / 2013.11</strong>.</p>
<p>Usage of <code>pageService</code> is deprecated as of <strong>v5.2 / 201=
3.11.</strong></p>
</div>
</div>
<p>&nbsp;</p>
<h4 id=3D"ThePageFieldType-UsingpageView:viewBlockById">Using <code>pageVie=
w:<span class=3D"pl-s2"><span class=3D"pl-en">viewBlockById </span></span><=
/code></h4>
<p><code><span class=3D"pl-s2"><span class=3D"pl-en"><span class=3D"status-=
macro aui-lozenge aui-lozenge-current">&gt;=3D EZP 5.3.2</span><br></span><=
/span></code></p>
<p><span class=3D"pl-s2"><span class=3D"pl-en">You can render Blocks with E=
SI strategy in all contexts, ie including using Varnish with the controller=
 viewBlockById. </span></span></p>
<p>&nbsp;</p>
<div class=3D"confluence-information-macro confluence-information-macro-not=
e">
<span class=3D"aui-icon aui-icon-small aui-iconfont-warning confluence-info=
rmation-macro-icon"></span>
<div class=3D"confluence-information-macro-body">
<p><span class=3D"pl-s2"><span class=3D"pl-en"><span class=3D"pl-s2"><span =
class=3D"pl-en">This feature is available from eZ Platform 5.3.2.</span></s=
pan></span></span></p>
</div>
</div>
<h5 id=3D"ThePageFieldType-Availablearguments.1"><span style=3D"color: rgb(=
51,51,51);">Available arguments</span></h5>
<div class=3D"table-wrap">
<table class=3D"confluenceTable">
<tbody>
<tr>
<th class=3D"confluenceTh">Name</th>
<th class=3D"confluenceTh">Description</th>
<th class=3D"confluenceTh">Type</th>
<th class=3D"confluenceTh">Default value</th>
</tr>
<tr>
<td class=3D"confluenceTd"><code>id</code></td>
<td class=3D"confluenceTd">The block ID of the block you want to render<br>=
<span class=3D"pl-s2"><span class=3D"pl-en">A <code>\eZ\Publish\API\Reposit=
ory\Exceptions\NotFoundException</code> will be thrown, if block could not =
be found</span></span></td>
<td class=3D"confluenceTd"><code>string</code></td>
<td class=3D"confluenceTd">N/A</td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>params</code></td>
<td colspan=3D"1" class=3D"confluenceTd"><p>Hash of variables you want to i=
nject to sub-template, key being the exposed variable name.</p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: php; gutter: false; theme: Eclipse" style=3D"font-size=
:12px;">{{ render(
      controller(=20
          "ez_page:viewBlockById",=20
          {
              'id': 42,
              'params': { 'some_variable': 'some_value' }
          }
      )
) }}</pre>=20
</div>
</div></td>
<td colspan=3D"1" class=3D"confluenceTd">hash</td>
<td colspan=3D"1" class=3D"confluenceTd">empty</td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>cacheSettings</code></td>
<td colspan=3D"1" class=3D"confluenceTd"><p>Hash of cache settings to use b=
y the sub-controller (useful if you use ESI or Hinclude strategies).</p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: php; gutter: false; theme: Eclipse" style=3D"font-size=
:12px;">{{ render_esi(
      controller(=20
          "ez_page:viewBlockById",=20
          {
              'id': 42,
              'params': { 'some_variable': 'some_value' },
              'cacheSettings': { 'smax-age': 600 }
          }
      )
) }}</pre>=20
</div>
</div></td>
<td colspan=3D"1" class=3D"confluenceTd">hash (accepted keys are <code>max-=
age</code> and <code>smax-age</code>)</td>
<td colspan=3D"1" class=3D"confluenceTd">empty</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<h4 id=3D"ThePageFieldType-RenderingBlockitems">Rendering Block items</h4>
<p>As said above,&nbsp;<strong>a block holds your displayable content as bl=
ock items</strong>&nbsp;which consists of&nbsp;<code>eZ\Publish\Core\FieldT=
ype\Page\Parts\Item</code>&nbsp;objects. Among&nbsp;<a href=3D"https://gith=
ub.com/ezsystems/exponential-kernel/blob/master/eZ/Publish/Core/FieldType/Pag=
e/Parts/Item.php" class=3D"external-link" rel=3D"nofollow">the available pr=
operties</a>, you will find&nbsp;<code>contentId</code>&nbsp;and&nbsp;<code=
>locationId</code>&nbsp;which reference the content/location you want to di=
splay. All you have to do then is to&nbsp;<strong>render it view&nbsp;<code=
><a href=3D"http://ez_contentviewLocation" class=3D"external-link" rel=3D"n=
ofollow">ez_content:viewLocation</a></code>&nbsp;or&nbsp;<code><a href=3D"h=
ttp://ez_contentviewContent" class=3D"external-link" rel=3D"nofollow">ez_co=
ntent:viewContent</a></code></strong>&nbsp;(<a href=3D"#ThePageFieldType-Ex=
ampleExample">see full example below</a>).</p>
<h3 id=3D"ThePageFieldType-ThePageServiceobject">The PageService object</h3=
>
<p>The PageService object (<code>eZ\Bundle\EzPublishCoreBundle\FieldType\Pa=
ge\PageService</code>) is a helper giving the possibility to get current zo=
ne/block definitions and to retrieve block items.</p>
<h4 id=3D"ThePageFieldType-Mainmethods">Main methods</h4>
<div class=3D"table-wrap">
<table class=3D"confluenceTable">
<tbody>
<tr>
<th class=3D"confluenceTh">Method name</th>
<th class=3D"confluenceTh">Description</th>
<th class=3D"confluenceTh">Return type</th>
</tr>
<tr>
<td class=3D"confluenceTd"><code>getZoneDefinition()</code></td>
<td class=3D"confluenceTd">Returns zone definition (all defined zones for t=
he current siteaccess) as an array</td>
<td class=3D"confluenceTd"><code>array</code></td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>getZoneDefinitionByLayout()<=
/code></td>
<td colspan=3D"1" class=3D"confluenceTd">Returns a zone definition for a gi=
ven layout. It consists of a configuration array for the given layout.</td>
<td colspan=3D"1" class=3D"confluenceTd"><code>array</code></td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>getBlockDefinition()</code><=
/td>
<td colspan=3D"1" class=3D"confluenceTd">Returns block definition as an arr=
ay</td>
<td colspan=3D"1" class=3D"confluenceTd"><code>array</code></td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>getBlockDefinitionByIdentifi=
er()</code></td>
<td colspan=3D"1" class=3D"confluenceTd">Returns a block definition for a g=
iven block identifier.</td>
<td colspan=3D"1" class=3D"confluenceTd"><code>array</code></td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>getValidBlockItems()</code><=
/td>
<td colspan=3D"1" class=3D"confluenceTd">Returns valid items (that are to b=
e displayed), for a given block.</td>
<td colspan=3D"1" class=3D"confluenceTd"><code>eZ\Publish\Core\FieldType\Pa=
ge\Parts\Item[]</code></td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>getLastValidBlockItem()</cod=
e></td>
<td colspan=3D"1" class=3D"confluenceTd">Returns the last valid item, for a=
 given block.</td>
<td colspan=3D"1" class=3D"confluenceTd"><code>eZ\Publish\Core\FieldType\Pa=
ge\Parts\Item|null</code></td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>getWaitingBlockItems()</code=
></td>
<td colspan=3D"1" class=3D"confluenceTd">Returns queued items (the next to =
be displayed), for a given block.</td>
<td colspan=3D"1" class=3D"confluenceTd"><code>eZ\Publish\Core\FieldType\Pa=
ge\Parts\Item[]</code></td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>getArchivedBlockItems()</cod=
e></td>
<td colspan=3D"1" class=3D"confluenceTd">Returns archived items (that were =
previously displayed), for a given block.</td>
<td colspan=3D"1" class=3D"confluenceTd"><code>eZ\Publish\Core\FieldType\Pa=
ge\Parts\Item[]</code></td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd"><code>getValidBlockItemsAsContentI=
nfo()</code></td>
<td colspan=3D"1" class=3D"confluenceTd">Returns valid block items as conte=
nt objects</td>
<td colspan=3D"1" class=3D"confluenceTd"><code>eZ\Publish\API\Repository\Va=
lues\Content\ContentInfo[] </code></td>
</tr>
</tbody>
</table>
</div>
<h3 id=3D"ThePageFieldType-ExampleExample"><span class=3D"confluence-anchor=
-link" id=3D"ThePageFieldType-Example"></span>Example</h3>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeHeader panelHeader pdl" style=3D"border-bottom-width: 1px=
;">
<b>2zoneslayout1.html.twig</b>
</div>
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: html/xml; gutter: false; theme: Eclipse" style=3D"font=
-size:12px;">&lt;h2&gt;Twig Template for 2 zoneslayout1 zone&lt;/h2&gt;
&lt;div class=3D"zone-layout-{{ zone_layout|lower }} row"&gt;
    &lt;div class=3D"span8"&gt;
        &lt;section class=3D"content-view-block"&gt;
        {% if zones[0].blocks %}
            {# Rendering blocks with default PageController #}
            {% for block in zones[0].blocks %}
                {{ render( controller( "ez_page:viewBlock", {'block': block=
} ) ) }}
            {% endfor %}
            &lt;div class=3D"block-separator"&gt;&lt;/div&gt;
        {% endif %}
        &lt;/section&gt;
    &lt;/div&gt;
    &lt;div class=3D"span4"&gt;
        &lt;aside&gt;
            &lt;section class=3D"content-view-block content-view-aside"&gt;
            {% if zones[1].blocks %}
                {# Still rendering with default PageController, but passing=
 specific cache value (TTL of 100 seconds) and using ESI #}
                {% for block in zones[1].blocks %}
                    {{ render_esi( controller( "ez_page:viewBlock", {'block=
': block, 'cacheSettings': {'smax-age': 100}} ) ) }}
                {% endfor %}
                &lt;div class=3D"block-separator"&gt;&lt;/div&gt;
            {% endif %}
            &lt;/section&gt;
        &lt;/aside&gt;
    &lt;/div&gt;
&lt;/div&gt;</pre>=20
</div>
</div>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeHeader panelHeader pdl" style=3D"border-bottom-width: 1px=
;">
<b>campaign_block.html.twig</b>
</div>
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"brush: html/xml; gutter: false; theme: Eclipse" style=3D"font=
-size:12px;">&lt;h3&gt;Twig Template for Campaign Block type&lt;/h3&gt;
{% set validContentInfoItems =3D pageService.getValidBlockItemsAsContentInf=
o( block ) %}
{% set validItems =3D pageService.getValidBlockItems( block ) %}
&lt;!-- BLOCK: START --&gt;
&lt;div class=3D"block-type-campaign"&gt;
    &lt;div class=3D"campaign"&gt;
        &lt;a href=3D"#" class=3D"navig prev" style=3D"opacity:0;"&gt;&lt;s=
pan class=3D"hide"&gt;&amp;lt;&lt;/span&gt;&lt;/a&gt;
        &lt;a href=3D"#" class=3D"navig next"&gt;&lt;span class=3D"hide"&gt=
;&amp;gt;&lt;/span&gt;&lt;/a&gt;
        &lt;ul class=3D"indicator"&gt;
            {% for contentInfo in validContentInfoItems %}
                &lt;li&gt;&lt;span&gt;{{ contentInfo.name }} (#{{ contentIn=
fo.id }})&lt;/span&gt;&lt;/li&gt;
            {% endfor %}
        &lt;/ul&gt;
        &lt;ul class=3D"images"&gt;
        {# Rendering valid items with regular view controller, with "block_=
item_campaign" view type #}
        {# Also passing an "image_class" parameter which will be available =
in sub-template. #}
        {% for item in validItems %}
            {{ render(
                controller(
                    'ez_content:viewLocation',
                    {
                        'locationId': item.locationId,
                        'viewType': 'block_item_campaign',
                        'params': {'image_class': 'campaign'}
                    }
                )
            ) }}
        {% endfor %}
        &lt;/ul&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;!-- BLOCK: END --&gt;</pre>=20
</div>
</div>
    </div>
</body>
</html>
------=_Part_3387_790987492.1485852906341--
